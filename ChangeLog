Sat Sep 21 14:59:22 1996  Thomas Bushnell, n/BSG  <thomas@gnu.ai.mit.edu>

	* shlib-versions (*-*-gnu*): Increment libc to 0.2 for upcoming
	binary distribution.

	* sysdeps/mach/hurd/Makefile (rtld-installed-name): Provide
	definition to override dangerous one in Makeconfig.

	* hurd/Makefile (install-headers-nosubdir): Install <rpc/netdb.h>.
	($(includedir)/rpc/netdb.h): New rule.
	[ This is XXX until sunrpc can be built; <rpc/netdb.h> is
	essential. ]

Fri Sep 20 16:06:06 1996  Thomas Bushnell, n/BSG  <thomas@gnu.ai.mit.edu>

	* sysdeps/mach/hurd/i386/init-first.c (_dl_start): Add definition,
	to guarantee link errors if this is included in ld.so.

Thu Sep 19 23:36:19 1996  Thomas Bushnell, n/BSG  <thomas@gnu.ai.mit.edu>

	* hurd/hurdinit.c (__libc_argv): Provide common decl.
	(_hurd_setproc): Don't declare __libc_argv here.

Tue Sep 17 10:51:58 1996  Thomas Bushnell, n/BSG  <thomas@gnu.ai.mit.edu>

	* malloc/memalign.c (memalign): Only acquire __libc_malloc_lock
	for actual modifications to global state.  

Fri Sep 13 01:21:36 1996  Thomas Bushnell, n/BSG  <thomas@gnu.ai.mit.edu>

	* sysdeps/mach/Makefile (includes): Add -I$(common-objpfx)mach/.
	* sysdeps/mach/hurd/Makefile (includes): Add
	-I$(common-objpfx)hurd/.  Reported by Marcus Daniels.

	* sysdeps/generic/schedbits.h (struct sched_param): Renamed from
	struct sched_params.
	* sysdeps/stub/sched_setp.c (__sched_setparam): struct
	sched_params -> struct sched_param.
	* sysdeps/stub/sched_getp.c (__sched_getparam): Likewise.
	* sysdeps/stub/sched_sets.c (__sched_setscheduler): Likewise.

Thu Sep 12 23:58:25 1996  Thomas Bushnell, n/BSG  <thomas@gnu.ai.mit.edu>

	* sysdeps/mach/libc-lock.h (__libc_cleanup_region_start): Fix
	syntax error.
	
	* stdio-common/Makefile: Put lockfile in routines
	unconditionally. 
		
	* stdio-common/vfprintf.c (__flockfile, __funlockfile): Declare
	this always, not just if _LIBC_REENTRANT.
	(__funlockfile): Don't use weak_extern for this one;
	__libc_cleanup_region_end might be defined and the use of
	__funlockfile can't be protected the way the use of __flockfile
	can be. 
	
Thu Sep 19 21:50:55 1996  Ulrich Drepper  <drepper@cygnus.com>

	* sysdeps/posix/gettimeofday.c (__gettimeofday): Use localtime_r
	instead of localtime.
	Reported by Matthias Urlichs.

	* shlib-versions: Remove version number for libcrypt.
	* features.h: Define __USE_REENTRANT if _REENTRANT or _THREAD_SAFE.
	* libc-symbols.h: Define _REENTRANT while compiling libc.

	* sysdeps/unix/sysv/linux/i386/sysdep.S (__errno_location):
	Define even if !_LIBC_REENTRANT.
	* sysdeps/unix/sysv/linux/i386/sysdep.S (__errno_location):
	Likewise.

	* sysdeps/posix/cuserid.h: Remove prototype for geteuid().
	De-ANSI-fy.

	* MakeTAGS ($P/libc.pot): Generate correctly formed header.
	* po/header.pot: Correct title line.
	* po/nl.po: Update.

Thu Sep 19 18:59:55 1996  Ulrich Drepper  <drepper@cygnus.com>

	* Makeconfig (soversions.mk): Prefer shared lib version numbers
	is add ons over version in libc itself.

	* sysdeps/unix/sysv/linux/i386/sysdep.S: Include <sysdep.h>.
	* sysdeps/unix/sysv/linux/i386/sysdep.h: Prevent multiple
	inclusion.

	* libio/iofgets.c: Use __flockfile and __funlockfile instead of
 	_IO_flockfile and _IO_funlockfile resp.

	* locale/categories.def: Partly support for correct `era' handling
	in LC_TIME category.
	* locale/langinfo.h: Likewise.
	* locale/programs/ld-time.c: Likewise.
	* locale/localeinfo.h: Change comment a bit.

	* malloc/memalign.c: Don't use goto, not necessary anymore.

1996-09-18  Paul Eggert  <eggert@twinsun.com>

	* time/mktime.c (ydhms_tm_diff):  Work correctly even if year
	is negative, or if time_t is unsigned.
	* time/strftime.c (tm_diff): Work correctly even if tm_year
	is near INT_MIN.

Tue Sep 17 16:14:34 1996  Andreas Schwab  <schwab@issan.informatik.uni-dortmund.de>

	* sysdeps/m68k/fpu/__math.h (__inline_mathop): Changed to generate
 	all three versions of the math function.
	(__inline_mathopf, __inline_mathopl): Removed.
	(__inline_functions): New temporary definition containing all
 	non-trivial inline functions.

Wed Sep 18 00:25:41 1996  Ulrich Drepper  <drepper@cygnus.com>

	* time/strftime.c (strftime): The T_FMT_AMPM string may be empty.

Tue Sep 17 20:27:18 1996  Ulrich Drepper  <drepper@cygnus.com>

	* math/Makefile (extra-libs-others): Use $(extra-libs) instead
	of $(extra-libc).

Tue Sep 17 17:09:44 1996  Ulrich Drepper  <drepper@cygnus.com>

	* sysdeps/stub/fpu_control.h: Correct end of file comment.

Tue Sep 17 05:39:18 1996  Ulrich Drepper  <drepper@cygnus.com>

	* stdio-common/bug3.c, stdio-common/bug4.c, stdio-common/bug5.c,
	stdio-common/test-popen.c: Remove temporary files after test.
	* stdio-common/bug5.c: Use `system' instead of `execlp'.
	Patches by Andreas Jaeger.

	* stdio-common/bug5.c: Create string for `system' argument to
	make sure the input and output file names are really correct.

Sun Sep 15 12:46:44 1996  Andreas Schwab  <schwab@issan.informatik.uni-dortmund.de>

	* configure.in: If $os contains a hyphen add the part before the
	hyphen to $ostry.

Sun Sep 15 18:14:02 1996  Andreas Schwab  <schwab@issan.informatik.uni-dortmund.de>

	* sysdeps/m68k/fpu/__math.h (__ieee754_pow, __ieee754_powf,
	__ieee754_powl): Rename local variable i to __i.
	(__ieee754_atan2, __ieee754_atan2f, __ieee754_atan2l): New inline
	functions.
	* sysdeps/m68k/fpu/e_atan2.c, sysdeps/m68k/fpu/e_atan2f.c,
	sysdeps/m68k/fpu/e_atan2l.c: New files.

1996-09-15  Paul Eggert  <eggert@twinsun.com>

	* manual/time.texi: Change `range X to Y' to `range X through
	Y', to avoid ambiguity in English.

	(strftime): Numbers that do not have a range indicated are not padded.
	Describe E and O modifiers.
	%g, %G, %u: New formats.
	%C, %y, %Y: Describe behavior on negative years.
	%e: Fix typo (was labeled %d).
	%l, %V: Fix typo in range.
	%M, %S, %U, %w, %W: Give ranges.
	%p: Clarify how noon and midnight are handled for AM and PM.
	%s: Clarify leap second handling.
	%r: Now locale-defined.
	%C, %D, %e, %h, %n, %r, %t, %T: Say that they are POSIX.2 extensions.
	%z: Say that it is a GNU extension.
	%Z: Wording fix.

	* time/strftime.c: (strftime):
		%V: Fix mishandling of week numbers near year boundaries.
		%g, %G: New formats (suggested by Arthur David Olson).
		%U, %W: Use inline expression instead of `week' function.
		%C, %y: Handle negative years portably.
		%C, %Y: Use width 1, since values can be arbitrarily wide.
		%r: Use T_FMT_AMPM format if _NL_CURRENT is defined.
		%u: New Posix.2 format.
		%w: Width is 1, not 2.
	(iso_week_days): New function, for %V, %G, %g.
	(week): Remove; it didn't handle %V correctly.
	(__isleap): New macro.
	(mbsinit): Use arg, to pacify GCC -Wall.

1996-09-13  Paul Eggert  <eggert@twinsun.com>

	* time/strftime.c (strftime):
	If using the GNU C library, do not bother to check for
	multibyte encodings, since they're safe in formats.  Otherwise:
	  - Check for multibyte encodings when encountering any character that
	  is not in the basic execution character set of the C Standard.
	  - Use mbrlen (if available) instead of mblen, to avoid modifying
	  mblen's internal state.
	  - Do not assume that '%' cannot appear as the first character of a
	  multibyte character sequence, since this is possible when not in the
	  initial shift state.
	(HAVE_MBRLEN, MULTIBYTE_IS_FORMAT_SAFE): Define if _LIBC is defined.
	(DO_MULTIBYTE): New macro.
	(<ctype.h>): Do not include.
	(<wchar.h>): Include if HAVE_MBRLEN.
	(mbstate_t, mbrlen, mbsinit): Define if ! HAVE_MBRLEN.
	(mbstate_zero): New constant.

1996-09-12  Paul Eggert  <eggert@twinsun.com>

	* time/strftime.c (strftime):
	Use an empty zone if it can't be determined; POSIX.2 requires this.
	Use plain `int' for pad and modifier (which now contain char value).
	Use plain `int' for number_value, to print negative values correctly.
	Use plain `int' for digits; there was no need to make it unsigned.
	Initialize subfmt consistently.
	Remove incorrect code for %EC and %Ey; they aren't implemented yet.
	For %O, if there is no alternate digit, output Ascii instead of "".
	Output the `%' of an unknown format; this is most likely the right
	thing to do if a multibyte string has been misparsed.

Thu Sep 12 23:23:13 1996  Andreas Schwab  <schwab@issan.informatik.uni-dortmund.de>

	* stdio-common/scanf7.c (main): Remove extra conversion from
	printf format string.

Thu Sep 12 23:01:16 1996  Andreas Schwab  <schwab@issan.informatik.uni-dortmund.de>

	* stdlib/test-canon.c (tests): Rename structure member from errno
	to error, all uses changed.

Thu Sep 12 20:08:06 1996  Andreas Schwab  <schwab@issan.informatik.uni-dortmund.de>

	* sysdeps/m68k/fpu/__math.h (__ldexp, __ldexpf, __ldexpl):
	Removed.
	* sysdeps/m68k/fpu/s_ldexp.c, sysdeps/m68k/fpu/s_ldexpf.c,
	sysdeps/m68k/fpu/s_ldexpl.c: Removed, use generic implementation
	instead.
	* sysdeps/m68k/fpu/s_scalbn.c, sysdeps/m68k/fpu/s_scalbnf.c,
	sysdeps/m68k/fpu/s_scalbnl.c: Replaced with old contents of
	s_ldexp.c, s_ldexpf.c and s_ldexpl.c, resp., suitably adpted.

	* sysdeps/m68k/fpu/__math.h (__frexp, __frexpf, __frexpl):
	Return value must be in [0.5, 1), not [1, 2).  Reported by Chris
	Lawrence.
	(__ilogb, __ilogbf, __ilogbl): Check for argument being zero.
	(__scalbn, __scalbnf, __scalbnl): Use second argument directly.

Thu Sep 12 19:59:24 1996  Andreas Schwab  <schwab@issan.informatik.uni-dortmund.de>

	* sysdeps/libm-ieee754/e_acoshl.c: Fix typos.
	* sysdeps/libm-ieee754/s_cbrtl.c: Remove unused variable.

Thu Sep 12 19:59:24 1996  Andreas Schwab  <schwab@issan.informatik.uni-dortmund.de>

	* sysdeps/libm-ieee754/e_acoshl.c: Fix typos.
	* sysdeps/libm-ieee754/s_cbrtl.c: Remove unused variable.

Thu Sep 12 19:56:07 1996  Andreas Schwab  <schwab@issan.informatik.uni-dortmund.de>

	* inet/herrno.c (__h_errno_location): Fix return type.

Fri Sep 13 04:33:08 1996  Ulrich Drepper  <drepper@cygnus.com>

	* sched.h: New file.  Helper to access posix/sched.h.
	* posix/sched.h: Change `sched_params' to `sched_param' to follow
	POSIX.4.

Thu Sep 12 20:12:40 1996  Ulrich Drepper  <drepper@cygnus.com>

	* db/makedb.c (usage): Print bug report address separately to
	ease translators task.
	* catgets/gencat.c (usage): Likewise.
	* locale/locale.c (usage): Likewise.
	* locale/localedef.c (usage): Likewise.

1996-09-12  Paul Eggert  <eggert@twinsun.com>

	* time/strftime.c (my_localtime_r): Define if ! HAVE_LOCALTIME_R,
	and #define localtime_r to it.	If _LIBC, use __localtime_r instead.
	(my_gmtime_r): Similar, except it's not needed if ! HAVE_TM_GMTOFF.

Thu Sep 12 14:03:29 1996  Ulrich Drepper  <drepper@cygnus.com>

	* crypt/Makefile: Include Makeconfig and add crypt object dir to
 	rpath-link so that running the check finds the new library.
	* crypt/cert.c: provide correct prototypes to prevent warnings.
	Reported by Andreas Jaeger.

	* sysdeps/mach/hurd/Makefile (rpath-link): Don't use += because
	old and new value must be glued using `:'.
	Reported by Marcus Daniels.

Thu Sep 12 12:33:52 1996  Thomas Bushnell, n/BSG  <thomas@gnu.ai.mit.edu>

	* sysdeps/mach/hurd/dl-cache.c: Delete second copy of file
	accidentally added on.

	* sysdeps/stub/intr-msg.h: New file.

	* stdio-common/vfprintf.c: Include <libc-lock.h>.
	* stdio-common/vfscanf.c: Include <libc-lock.h>.

	* sysdeps/mach/libc-lock.h (__libc_cleanup_region_start): New
	macro.
	(__libc_cleanup_region_end): New macro.

Thu Sep 12 12:33:52 1996  Thomas Bushnell, n/BSG  <thomas@gnu.ai.mit.edu>

	* sysdeps/mach/hurd/dl-cache.c: Delete second copy of file
	accidentally added on.

	* sysdeps/stub/intr-msg.h: New file.

	* stdio-common/vfprintf.c: Include <libc-lock.h>.
	* stdio-common/vfscanf.c: Include <libc-lock.h>.

	* sysdeps/mach/libc-lock.h (__libc_cleanup_region_start): New
	macro.
	(__libc_cleanup_region_end): New macro.

Thu Sep 12 03:35:27 1996  Ulrich Drepper  <drepper@cygnus.com>

	* sysdeps/unix/sysv/linux/i386/Dist: Remove init-first.h.
	* sysdeps/unix/sysv/linux/m68k/Dist: Likewise.
	* sysdeps/unix/sysv/linux/Dist: Add init-first.h.

1996-09-11  Paul Eggert  <eggert@twinsun.com>

	* strftime.c (strftime):
	Handle E and O modifiers, required for POSIX.2 and XPG4.
	Don't use sprintf to format numbers; this way, we can handle time_t
	correctly regardless of whether it's signed.
	Don't dump core if format ends in %.
	In default %c format, use %e instead of %d, for POSIX.2 compatibility.
	For %z:
		Use tm_gmtoff if available.
		Output nothing if tm_isdst is negative.
		Output correct value even if arg is 1969-12-31 23:59:59 UTC.
		Don't assume that UTC offset is less than 24 hours;
		Posix requires support for 24 hours, and there's no point
		limiting it at all.
	(HAVE_TM_GMTOFF, TYPE_SIGNED, INT_STRLEN_BOUND): New macros.
	(CHAR_BIT): Define if <limits.h> doesn't.
	(tm_diff): New function.
	(fmt, <stdio.h>): Remove; no longer used.

Thu Sep 12 02:21:44 1996  Ulrich Drepper  <drepper@cygnus.com>

	* db/Makefile: Add extra-libs-others variable so that shared
	library is built in `others' pass.
	* elf/Makefile: Likewise.
	* math/Makefile: Likewise.
	* resolv/Makefile: Likewise.

	* Makefile (generated): Add version.info.h.

	* time/checktab.awk: New file.  From ADO 96k.
	* time/iso3166.tab: Likewise.
	* time/tzselect.ksh: Likewise.
	* time/zone.tab: Likewise.

	* stdio-common/vfprintf.c: Correct cleanup registration.  We
	cannot use a macro

1996-09-11  Paul Eggert  <eggert@twinsun.com>

	* time/time.h (tm_gmtoff, tm_zone): Prefix with `__' unless
	__USE_BSD; this is required for ANSI C compatibility.
	* manual/time.texi: Replace GMT by UTC, daylight savings by
 	daylight saving, timezone by time zone.
	Rewrite description of %V to match ISO 8601.
	Fix TZ Posix string example for US Eastern time.
	Explain tzname[1] when DST isn't used.
	Explain tzname when multiple abbreviations used (e.g. EST/EWT/EDT).
	Explain that timezone's sign is opposite from tm_gmtoff, and that
	timezone lacks DST adjustment whereas tm_gmtoff has it.
	Deprecate tzname and timezone.

Tue Sep 10 14:46:16 1996  Andreas Schwab  <schwab@issan.informatik.uni-dortmund.de>

	Implement Roland McGrath's idea of how to put an .interp into
	shared libraries.
	* interp.c: New file.
	* Makerules (interp-obj): New object, linked into every shared
	library.
	(common-generated): Add interp.so.
	(CFLAGS-interp.c): Pass name of interpreter.

Tue Sep 10 21:09:35 1996  Andreas Schwab  <schwab@issan.informatik.uni-dortmund.de>

	* db/Makefile: Fix typo.

Tue Sep 10 19:29:53 1996  Andreas Schwab  <schwab@issan.informatik.uni-dortmund.de>

	* nss/db-Makefile ($(VAR_DB)/passwd.db): Look for multiple
	occurences of the same uid, and only generate a mapping for the
	first one.

Tue Sep 10 03:14:59 1996  Andreas Schwab  <schwab@issan.informatik.uni-dortmund.de>

	* sysdeps/unix/sysv/linux/system.c: New file, to override
	sysdeps/unix/system.c.

Tue Sep 10 15:05:40 1996  Andreas Schwab  <schwab@issan.informatik.uni-dortmund.de>

	* Makefile (before-compile): Add version-info.h, needed to build
	version.d.

Tue Sep 10 14:14:33 1996  Andreas Schwab  <schwab@issan.informatik.uni-dortmund.de>

	* sysdeps/unix/sysv/linux/m68k/sysdep.S: Remove check for
	EWOULDBLOCK, never true on Linux.
	(__errno_location): New function.
	[_LIBC_REENTRANT]: Set errno using __errno_location function.
	* sysdeps/unix/sysv/linux/m68k/sysdep.h [PIC]: Add second
 	syscall_error handler for reentrant libc.

Tue Sep 10 13:27:49 1996  Andreas Schwab  <schwab@issan.informatik.uni-dortmund.de>

	* elf/Makefile (extra-objs): Add eval.so to get dependencies.

Wed Sep 11 04:40:57 1996  Ulrich Drepper  <drepper@cygnus.com>

	* time/tzset.c (__tzname_cur_max): Use type `size_t' to avoid
 	warning.
	* time/tzfile.c (compute_tzname_max): Likewise.

Wed Sep 11 02:57:31 1996  Ulrich Drepper  <drepper@cygnus.com>

	* configure.in: Quote $add_ons argument in loop to generated
	prefices.

Tue Sep 10 20:43:45 1996  Ulrich Drepper  <drepper@cygnus.com>

	* db/makedb.c: Include <locale.h>.  Reported by Fila Kolodny.

Tue Sep 10 14:42:39 1996  Thomas Bushnell, n/BSG  <thomas@gnu.ai.mit.edu>

	* elf/dl-cache.c: Rename to ...
	* sysdeps/generic/dl-cache.c:  ... here.
	* sysdeps/mach/hurd/dl-cache.c: New file.
	
	* mach/Makefile (distribute): Add `errsystems.awk'.
	* hurd/Makefile (distribute): Add `Notes' and `intr-msg.h'.
	* hurd/hurdintr.awk: Delete file.  (Not used in ages.)
	* hurd/intr-rpc.awk: Likewise.
	* hurd/invoke-trans.c: Likewise.
	* sysdeps/mach/hurd/i386/longjmp-ctx.c: Likewise.
	* sysdeps/mach/hurd/alpha/longjmp-ctx.c: Likewise.
	* sysdeps/mach/hurd/mips/longjmp-ctx.c: Likewise.
	* sysdeps/mach/hurd/i386/init-fault.c: Likewise.
	* sysdeps/mach/hurd/mips/init-fault.c: Likewise.
	* sysdeps/stub/init-fault.c: Likewise.
	* sysdeps/stub/longjmp-ctx.c: Likewise.
	
Tue Sep 10 13:49:08 1996  Ulrich Drepper  <drepper@cygnus.com>

	* inet/herrno.c: Initialize `h_errno' so that we can provide
	alias.

	* Makefile (version-info.h): Fix typo in shell script.

	* sysdeps/i386/i586/strlen.S: Optimize startup code a bit.
	* sysdeps/i386/i586/strchr.S: Likewise.

Mon Sep  9 20:31:27 1996  Ulrich Drepper  <drepper@cygnus.com>

	* version.c (banner): Report to bug-glibc@prep not @gnu.
	Reported by Andreas Jaeger.

	* libio/stdio.h [!__USE_REENTRANT]: Don't define getc as
 	_IO_getc_unlocked.
	[__USE_REENTRANT]: Don't define

Mon Sep  9 15:59:32 1996  Ulrich Drepper  <drepper@cygnus.com>

	* sysdeps/i386/strrchr.c: Fix bug where NUL byte is not recognized
	when it is the third byte in the string.  Reported by
	NIIBE Yutaka.
	* string/tester.c: Add tests for above bug to strlen, strchr, and
	strrchr tests.

Fri Sep  6 21:23:33 1996  Andreas Schwab  <schwab@issan.informatik.uni-dortmund.de>

	* sysdeps/m68k/fpu/e_acos.c: Deansideclized.  Include
	"math_private.h" to get prototype.
	* sysdeps/m68k/fpu/e_fmod.c: Likewise.
	* sysdeps/m68k/fpu/k_cos.c: Likewise.
	* sysdeps/m68k/fpu/k_sin.c: Likewise.
	* sysdeps/m68k/fpu/k_tan.c: Likewise.

	* sysdeps/m68k/fpu/k_sin.c: Remove uneeded indirection of
	__m81_u.
	* sysdeps/m68k/fpu/k_tan.c: Likewise.

Sun Sep  1 18:01:35 1996  Andreas Schwab  <schwab@issan.informatik.uni-dortmund.de>

	* sysdeps/m68k/fpu/__math.h: Check for __NO_M81_MATH_INLINES
	instead of __NO_MATH_INLINES.
	(__M81_MATH_INLINES): Renamed from __MATH_INLINES.
	* sysdeps/m68k/fpu/e_acos.c: Define __NO_M81_MATH_INLINES.
	* sysdeps/m68k/fpu/e_fmod.c: Likewise.
	* sysdeps/m68k/fpu/k_cos.c: Likewise.
	* sysdeps/m68k/fpu/k_sin.c: Likewise.
	* sysdeps/m68k/fpu/k_tan.c: Likewise.
	* sysdeps/m68k/fpu/s_atan.c: Likewise.
	* sysdeps/m68k/fpu/s_frexp.c: Likewise.
	* sysdeps/m68k/fpu/s_ilogb.c: Likewise.
	* sysdeps/m68k/fpu/s_isinf.c: Likewise.
	* sysdeps/m68k/fpu/s_ldexp.c: Likewise.
	* sysdeps/m68k/fpu/s_modf.c: Likewise.
	* sysdeps/m68k/fpu/k_cos.c: Use inline version of __cos.
	* sysdeps/m68k/fpu/k_sin.c: Likewise.
	* sysdeps/m68k/fpu/k_tan.c: Likewise.

Mon Sep  9 12:55:14 1996  Ulrich Drepper  <drepper@cygnus.com>

	* nss/nss_files/files-parse.c (INT_FIELD_MAYBE_NULL): Check for
	available character before converting number and return with
	error if none is available.

Fri Sep  6 22:09:08 1996  Andreas Schwab  <schwab@issan.informatik.uni-dortmund.de>

	* sysdeps/unix/sysv/linux/init-first.h: New file, generic
	implementation for architectures where parameters are passed on
	stack.
	* sysdeps/unix/sysv/linux/m68k/init-first.h: Removed.
	* sysdeps/unix/sysv/linux/i386/init-first.h: Removed.

Fri Sep  6 22:05:32 1996  Andreas Schwab  <schwab@issan.informatik.uni-dortmund.de>

	* configure.in: Remove unneeded sysnames frobbing.

Mon Sep  9 05:29:09 1996  Ulrich Drepper  <drepper@cygnus.com>

	* time/zic.c: Update from ADO 96l.
	* time/africa: Update from ADO 96k.
	* time/antarctica: Likewise.
	* time/asia: Likewise.
	* time/australia: Likewise.
	* time/europe: Likewise.
	* time/northamerica: Likewise.
	* time/southamerica: Likewise.

Mon Sep  9 05:03:47 1996  NIIBE Yutaka  <gniibe@mri.co.jp>

	* sysdeps/unix/sysv/linux/i386/init-first.h: Work around buggy
	gcc <= 2.7.2.1 which optimizes away address operations on weak
	objects.

	* nss/nss_files/files-parse.c (INT_FIELD_MAYBE_NULL): New macro.
	Like INT_FIELD but also accept non-existing field.
	* shadow/sgetspent_r.c (LINE_PARSER): Use INT_FIELD_MAYBE_NULL
	for last four fields.
	* shadow/putspent.c (putspent): Print `:' after numeric value.

Mon Sep  9 02:42:48 1996  Richard Henderson  <rth@tamu.edu>

	* libio/stdio.h (BUFSIZ): Define using _IO_BUFSIZ.

Sun Sep  8 16:43:56 1996  Ulrich Drepper  <drepper@cygnus.com>

	* Make-dist: Filter out $(add-ons) from $(subdirs).
	Don't distribute TAGS files.
	($(tardir).tar): Remove dist.tar when all is done.
	* manual/Makefile (distribute): Add libc.info*.
	* libio/Makefile (distribute): Add Banner.
	* inet/Makefile (headers): Add netinet/tcp.h.

	* resolv/Makefile (libresolv-routines): Add getnetnamadr.

	* crypt-README: Removed.
	* gnu-stabs.h: Removed.

	* sysdeps/alpha/copysign.S: Renamed to...
	* sysdeps/alpha/s_copysign.S: ...this.
	* sysdeps/alpha/fabs.S: Renamed to...
	* sysdeps/alpha/s_fabs.S: ...this.

	* sysdeps/m68k/isinfl.c: Renamed to...
	* sysdeps/m68k/s_isinfl.c: ...this.
	* sysdeps/m68k/isnanl.c: Renamed to...
	* sysdeps/m68k/s_isnanl.c: ...this.

	* sysdeps/sparc/sqrt.c: Renamed to...
	* sysdeps/sparc/e_sqrt.c: ...this.  Function name now is
	__ieee754_sqrt.

	* sysdeps/generic/get_str.c: Removed.

	* sysdeps/ieee754/cbrt.c: Removed.
	* sysdeps/ieee754/drem.c: Removed.
	* sysdeps/ieee754/logb.c: Removed.
	* sysdeps/ieee754/sqrt.c: Removed.

	* sysdeps/stub/cbrt.c: Removed.
	* sysdeps/stub/cos.c: Removed.
	* sysdeps/stub/drem.c: Removed.
	* sysdeps/stub/isinf.c: Removed.
	* sysdeps/stub/isinfl.c: Removed.
	* sysdeps/stub/isnanl.c: Removed.
	* sysdeps/stub/logb.c: Removed.
	* sysdeps/stub/sin.c: Removed.
	* sysdeps/stub/sqrt.c: Removed.

	* sysdeps/tahoe/log10.c: Removed.

	* sysdeps/vax/index.s: Removed.
	* sysdeps/vax/rindex.s: Removed.
	* sysdeps/vax/bcmp.s: Removed.
	* sysdeps/vax/log10.c: Removed.
	* sysdeps/vax/infnan.c: Removed.
	* sysdeps/vax/Dist: Add fl.h.

	* sysdeps/unix/sysv/linux/alpha/Dist: Add llseek.S.

	* inet/rcmd.c (rcmd): Make messages more uniform.

Sun Sep  8 14:15:42 1996  Ulrich Drepper  <drepper@cygnus.com>

	* po/de.po: Update.
	* po/es.po: Update.
	* po/ko.po: Update.
	* po/pl.po: New file.
	* po/nl.po: New file.

Sat Sep  7 18:41:17 1996  Richard Henderson  <rth@tamu.edu>

	* Makeconfig (+link): Filter out start, pre & postinit from the
	generic depenancies as well.
	* Rules: Add start, pre & postinit to the dependancies of
	$(others) and $(tests).

	* configure.in: elf_dirs missing "sysdeps" component.

Sun Sep  8 02:36:02 1996  Ulrich Drepper  <drepper@cygnus.com>

	* locale/SYS_libc.c (_libc_intl_domainname): Change value to "libc".
	This is consistent with all other GNU packages.  We shouldn't
	take care for a possible clash.  Nobody will name the domain
	of a package libc if it is not the libc itself.
	* MakeTAGS ($P/SYS_libc.pot): Rename to $P/libc.pot.
	* po/Makefile (domainname): Change to libc.
	(distribute): Now ship libc.pot.
	* catgets/gencat.c (usage): Use `PACKAGE' for package name in
	version information banner.
	Change bug report address to bug-glibc@prep not @gnu.
	* db/makedb.c (PACKAGE): New macro.  Set to _libc_intl_domain.
	(main): Use `PACKAGE' for package name in version information
	banner.
	Change bug report address to bug-glibc@prep not @gnu.
	* locale/programs/locale.c (main): Use `PACKAGE' for package name
 	in version information banner.
	Change bug report address to bug-glibc@prep not @gnu.
	* locale/programs/localedef.c (main): Likewise.

	* version.h (VERSION): Bump to 1.94.

	* locale/Makefile (distribute): Add locale.c and localedef.c.

Sat Sep  7 14:00:33 1996  David Mosberger-Tang  <davidm@azstarnet.com>

	* catgets/catgets.c (catopen): Allocate sizeof(*result) bytes
	instead of sizeof(nl_catd) (which is just a pointer!).

Sat Sep  7 19:39:19 1996  Ulrich Drepper  <drepper@cygnus.com>

	* Makefile ($(objpfx)version-info.h): Generate from Banner files.
	* version.c (banner): Add contents of version-info.h to string.

	* Makerules: If $($(subdir)-version) is available name versioned
	shared library according to this value instead of glibc's version.

	* libio/Banner: New file.

	* elf/eval.c (funcall): Write error message in case function is
	not found.
	(eval): Recognize `_' in names.

Sat Sep  7 05:15:45 1996  Ulrich Drepper  <drepper@cygnus.com>

	* libio/iofdopen: Initialize _lock field only if _IO_MTSAFE_IO.
	* libio/iofopen: Likewise.
	* libio/iofopncook.c: Likewise.
	* libio/iopopen.c: Likewise.
	* libio/iovsprintf.c: Likewise.
	* libio/iovsscanf.c: Likewise.
	* libio/memstream.c: Likewise.
	* libio/vasprintf.c: Likewise.
	* libio/vdprintf.c: Likewise.
	* libio/vsnprintf.c: Likewise.

Sat Sep  7 03:55:47 1996  Ulrich Drepper  <drepper@cygnus.com>

	* Makeconfig (soversions.mk): Also use shlib-versions files
	in add-on directories.
	* config.make.in (config-defines): Remove.  Not used anymore.
	(defines): New variable.  Initiliazed by @DEFINES@.
	* configure.in: Add AC_SUBST(DEFINES).

	* libio/Makefile (routines): When compiling reentrant libc add
 	clearerr_u, feof_u, ferror_u, fputc_u, getc_u, getchar_u,
 	iofflush_u, putc_u, putchar_u, ioflockfile.
	(CPPFLAGS): Add -D_IO_MTSAFE_IO for reentrant libc.

	* sysdeps/stub/libc-lock.h: Add stubs for __libc_cleanup_region_start
	and __libc_cleanup_region_end.

	* sysdeps/unix/i386/sysdep.S [_LIBC_REENTRANT]: Set errno
 	using __errno_location function.
	* sysdeps/unix/sysv/linux/i386/sysdep.S [_LIBC_REENTRANT]: Set errno
	using __errno_location function.
	(__errno_location): New function.
	* sysdeps/unix/sysv/linux/i386/sysdep.h [PIC]: Add second
 	syscall_error handler for reentrant libc.

	* sysdeps/unix/opendir.c: Remove unneeded `;'.

	* libio.h [_IO_MTSAFE_IO]: Include <pthread.h>.
	[!_IO_MTSAFE_IO]: Define _IO_flockfile and _IO_funlockfile
	as empty macros.
	* libioP.h: Include <libc-lock.h>.
	* libio/stdio.h: Add prototypes for *_locked and *_unlocked
	functions.

	* libio/clearerr.c: Use _IO_ protected versions of flockfile
	and funlockfile to be namespace clean.

	* libio/genops.c: Use __libc_lock_* macros for handling lock.

	* libio/iofdopen: Add initialization of _lock in _IO_FILE.
	* libio/iofopen: Likewise.
	* libio/iofopncook.c: Likewise.
	* libio/iopopen.c: Likewise.
	* libio/iovsprintf.c: Likewise.
	* libio/iovsscanf.c: Likewise.
	* libio/memstream.c: Likewise.
	* libio/vasprintf.c: Likewise.
	* libio/vdprintf.c: Likewise.
	* libio/vsnprintf.c: Likewise.

	* libio/fgetc.c: Use __libc_cleanup_region_* macros instead
	of flockfile etc.
	* libio/fputc.c: Likewise.
	* libio/freopen.c: Likewise.
	* libio/fseek.c: Likewise.
	* libio/getc.c: Likewise.
	* libio/getchar.c: Likewise.
	* libio/iofclose.c: Likewise.
	* libio/iofflush.c: Likewise.
	* libio/iofgetpos.c: Likewise.
	* libio/iofgets.c: Likewise.
	* libio/iofputs.c: Likewise.
	* libio/iofread.c: Likewise.
	* libio/iofsetpos.c: Likewise.
	* libio/ioftell.c: Likewise.
	* libio/iofwrite.c: Likewise.
	* libio/iogetdelim.c: Likewise.
	* libio/iogets.c: Likewise.
	* libio/ioputs.c: Likewise.
	* libio/iosetbuffer.c: Likewise.
	* libio/iosetvbuf.c: Likewise.
	* libio/ioungetc.c: Likewise.
	* libio/putc.c: Likewise.
	* libio/putchar.c: Likewise.
	* libio/rewind.c: Likewise.
	* stdio-common/vfprintf.c: Likewise.
	* stdio-common/vfscanf.c: Likewise.

	* libio/clearerr_u.c: Correct alias name.
	* libio/ferror_u.c: Likewise.
	* libio/fileno.c: Likewise.
	* libio/fputc_u.c: Likewise.
	* libio/getc.c: Likewise.
	* libio/getc_u.c: Likewise.
	* libio/getchar.c: Likewise.
	* libio/getchar_u.c: Likewise.
	* libio/putc.c: Likewise.
	* libio/putchar.c: Likewise.

	* libio/feof_u.c: Undefine macro with name of function before
 	definition of function itself.

	* libio/ioflockfile.c: New file.  Implementation of flockfile and
 	funlockfile.

	* libio/putchar_u.c: Fix typo.  Use stdout instead of fp.

	* malloc/malloc.h: Don't include <libc-lock.h> and don't declare
 	_malloc_loc.

	* malloc/free.c: Include <libc-lock.h>.
	* malloc/realloc.c: Likewise.
	* malloc/malloc-find.c: Likewise.
	* malloc/malloc-size.c: Likewise.
	* malloc/malloc-walk.c: Likewise.
	* malloc/memalign.c: Likewise.
	* malloc/malloc.c: Likewise.

	* sysdeps/i386/dl-machine.h: Correct clearing of _dl_starting_up.

Fri Sep  6 19:38:49 1996  Ulrich Drepper  <drepper@cygnus.com>

	* sysdeps/stub/libc-lock.h: Define __libc_lock_critical_start
	and __libc_lock_critical_end as empty macros.

	* malloc/malloc.h: Don't include <libc-lock.h> and don't declare
	__libc_malloc_lock.
	* malloc/free.c: Include <libc-lock.h>.
	* malloc/malloc-find.c: Likewise.
	* malloc/malloc-size.c: Likewise.
	* malloc/malloc-walk.c: Likewise.
	* malloc/malloc.c: Likewise.
	* malloc/memalign.c: Likewise.
	* malloc/realloc.c: Likewise.

	* Makefile: Undo change from Mon Sep  2 22:15:14 1996.  No more
	extra_solibs pass.
	* Rules: Likewise.
	* extra-lib.mk: Likewise.
	* manual/Makefile: Likewise.

	* db/Makefile (makedb): Choose dependecies based on build-shared.
	Patch by Andres Schwab.

	* sysdeps/posix/sysconf.c: Don't use PTHREAD_DESTRUCTOR_ITERATIONS
 	but _POSIX_THREAD_DESTRUCTOR_ITERATIONS.

	* sysdeps/unix/sysv/linux/errnos.h: New file.
	* sysdeps/unix/sysv/linux/schedbits.h: New file.
	* sysdeps/unix/sysv/linux/waitflags.h: New file.

	* sysdeps/unix/sysv/linux/gnu/types.h: Add definition of `key_t'.

Fri Sep  6 08:26:31 1996  Andreas Schwab  <schwab@issan.informatik.uni-dortmund.de>

	* rpm/template: Fix typo in %build section.

Fri Sep  6 03:31:07 1996  Ulrich Drepper  <drepper@cygnus.com>

	* sysdeps/unix/sysv/linux/errnos.h: Don't define errno macro when
	building libc without thread support.
	* resolv/netdb.h: Likewise for h_errno macro.

Thu Sep  5 23:01:48 1996  Ulrich Drepper  <drepper@cygnus.com>

	* libc-symbols.h: Add new macro weak_const_function.  It's like
	weak_function, but the function is additionally marked as const.
	* features.h: Only include <sys/cdefs.h> if !__ASSEMBLER__.

Thu Sep  5 22:55:49 1996  Richard Henderson  <rth@tamu.edu>

	* inet/herrno.c (__h_errno_location): New function.
	(h_errno): Make strong_alias __h_errno so that we can access
	the variable even if `h_errno' is a macro.
	* resolv/netdb.h: Define macro h_errno to access thread specific
	version of h_errno variable.  Declare alias __h_errno for h_errno.
	* resolv/res_query (h_errno): Remove definition.
	* sysdeps/unix/sysv/linux/errnos.h [!__ASSEMBLER__ && __USE_REENTRANT]:
 	Add macro `errno' to get thread specific variable.
	* sysdeps/unix/alpha/sysdep.S [_LIBC_REENTRANT]: Set errno using
 	__errno_location function.
	(__errno_location): New function.

Thu Sep  5 21:08:44 1996  Ulrich Drepper  <drepper@cygnus.com>

	* posix/gnu/types.h: Remove definition of key_t.
	* sysdeps/generic/gnu/types.h: Move it to here.
	* sysdeps/unix/sysv/linux/gnu/types.h: Add Linux specific
	definition of key_t.

	* sysdeps/unix/sysv/linux/waitflags.h: New file.  Linux specific
	definitions.
	* sysdeps/unix/sysv/linux/schedbits.h: New file.  Include
	clone prototypes and associated flags.

Thu Sep  5 13:18:25 1996  Thomas Bushnell, n/BSG  <thomas@gnu.ai.mit.edu>

	* sysdeps/mach/hurd/i386/init-first.c (__libc_argc, __libc_argv):
	New variables.
	(init1): Initialize them.
	* hurd/hurdinit.c (_hurd_setproc): Now that happens to be
	available, pass __libc_argv in call to __proc_set_arg_locations.

	* gmon/gmon.c (write_hist): Call __profile_frequency instead of
	hertz.
	(hertz): Delete function.
	* gmon/Makefile (routines): Add `prof-freq'.
	* sysdeps/generic/prof-freq.c: New file.
	* sysdeps/mach/hurd/prof-freq.c: New (stubby) file.
	* sysdeps/mach/hurd/profil.c (profile_tick): New variable.
	(update_waiter): Store frequency in profile_tick.
	(__profile_frequency): New function.

	* sysdeps/mach/hurd/sendto.c (sendto): Use prototype definition
	syntax.

	* Rules (generated): Restore reference to $(generated).

	* mach/Machrules (mig.uh, mig.__h): Don't include $(user-MIGFLAGS)
	here.

 	* malloc/free.c (free): __lib_malloc_lock -> __libc_malloc_lock.

	* malloc/free.c: Provide extern decl of __libc_malloc_lock.
	* malloc/realloc.c: Likewise.
	* malloc/malloc-find.c: Likewise.
	* malloc/malloc-size.c: Likewise.
	* malloc/malloc-walk.c: Likewise.
	* malloc/memalign.c: Likewise.

Thu Sep  5 08:58:47 1996  Richard Henderson  <rth@tamu.edu>

	* sysdeps/alpha/elf/start.S: Make _start global again.

Thu Sep  5 03:20:42 1996  Ulrich Drepper  <drepper@cygnus.com>

	Change configuration and Makefiles to allow add-ons to have a
	sysdeps/ directory hierachy.
	* configure.in: Test for sysdeps/ directory in add-ons.  Before
	all test and searches in these hierachies, too.
	* Makeconfig (full-config-subdirs): Define based on $(config-sysdirs).
	Extend with $(..) if not absolute path.
	Use $(full-config-subdirs) where $(config-sysdirs) was used.
	* Makefile ($(objpfx)sysd-dirs): Use config-sysdirs.
	* MakeTAGS: Use $(full-config-subdirs).
	* Makerules: Change comment to libc.so link script.
	(sysdirs): Define based on $(full-config-subdirs).
	(sysd-Makefile): Define using config-sysdirs.
	(sysd-rules): Likewise.
	* sysdeps/unix/Makefile (sysd-syscalls): Define based on +sysdep-dirs.
	* sysdeps/unix/make-syscalls.sh: Remove basedir argument.

Wed Sep  4 01:32:21 1996  Andreas Schwab  <schwab@issan.informatik.uni-dortmund.de>

	* sysdeps/m68k/fpu/k_cos.c: Rewritten for better accuracy.
	* sysdeps/m68k/fpu/k_sin.c: Likewise.
	* sysdeps/m68k/fpu/k_tan.c: Likewise.

Thu Sep  5 01:06:09 1996  Richard Henderson  <rth@tamu.edu>

	* malloc/free.c (free): Protect by using __libc_malloc_lock.
	* malloc/malloc-find.c (malloc_find_object_address): Likewise.
	* malloc/malloc-size.c (malloc_usable_size): Likewise.
	* malloc/malloc-walk.c (malloc_walk): Likewise.
	* malloc/memalign.c (memalign): Likewise.
	* malloc/realloc.c (realloc): Likewise.
	* malloc/malloc.c: Define __libc_malloc_lock.
	(_malloc_internal): Don't use `malloc'.  Instead look for
	`__malloc_hook' or call `_malloc_internal'.
	(malloc): Protect by using `__libc_malloc_lock'.
	* malloc/malloc.h: Declare `__libc_malloc_lock'.

Mon Sep  2 22:42:59 1996  Richard Henderson  <rth@tamu.edu>

	* sysdeps/alpha/elf/start.S: Use weak_alias for __start
	instead of the hard definition.

	* sysdeps/alpha/dl-machine.h (RTLD_START): Add type info for
	_start and _dl_start_user.

	* sysdeps/unix/sysv/linux/alpha/init-first.h (SYSDEP_CALL_INIT):
	Make _dl_starting_up weak.  Add type info for NAME.

Mon Sep  2 22:15:14 1996  Richard Henderson  <rth@tamu.edu>

	* Makefile (all): Add extra_solibs pass.
	(+subdir_targets): Same.
	* Rules (extra_solibs): New phony empty target for subdirs without
	extra libs.
	* extra-lib.mk: Build lib*.so* in extra_solibs not lib-noranlib.
	* manual/Makefile: Add dummy extra_solibs target.

Sun Sep  1 15:41:22 1996  Richard Henderson  <rth@tamu.edu>

	* Makeconfig (+link): Add $(link-extra-libs).
	(link-extra-libs): New variable which expands to the full paths of
	the other libraries needed by a program, as controled by LDLIBS-$(@F).
	* db/Makefile: Use LDLIBS-makedb to link libdb not a dependency, as
	the later attempts to install the library before linking it.

	* sysdeps/unix/alpha/sysdep.S: Align errno.

	* sysdeps/unix/sysv/linux/alpha/ioperm.c (struct platform): Add
	hae_shift entry.
	(io): Move bus_memory_base and sparse_bus_memory_base into struct.
	(_hae_shift): New function.
	* sysdeps/unix/sysv/linux/alpha/sys/io.h: New file.  Prototypes
	for the bus query functions.

Sat Aug 31 18:14:54 1996  Richard Henderson  <rth@tamu.edu>

	* elf/dl-close.c (_dl_close): In static executables, map->l_prev
	can be NULL when unloading a library.

	* elf/dl-open.c (_dl_open): Pass __environ instead of __libc_envp
	to the library .init function.

	* sysdeps/alpha/dl-machine.h (elf_machine_rela):  Since we omitted
	part of the COPY reloc processing earlier, omit the rest now --
	we'll get into less trouble later when some fool does use a COPY.

	* sysdeps/unix/sysv/linux/init-first.c (init): Accept argc et al as
	parameters.  Move all argc and __libc_multiple_libcs calculation out
	to init-first.h.  Use __environ not __libc_envp.
	* sysdeps/unix/sysv/linux/alpha/init-first.h: Rewrite.
	* sysdeps/unix/sysv/linux/i386/init-first.h: Rewrite.

Thu Aug 29 20:26:40 1996  Andreas Schwab  <schwab@issan.informatik.uni-dortmund.de>

	* sysdeps/posix/profil.c (profil): Don't clobber saved timer and
	signal settings when profiling was already turned on.

	* csu/gmon-start.c (__gmon_start__) [HAVE_INITFINI]: Protect from
	being called twice.

Wed Sep  4 01:31:50 1996  Ulrich Drepper  <drepper@cygnus.com>

	* sysdeps/unix/sysv/linux/i386/mmap.S: Test for
	0 < return value < -4096 and not < 0 to decide about failure.
	Reported by Andreas Jaeger.

Tue Sep  3 19:04:05 1996  Ulrich Drepper  <drepper@cygnus.com>

	* stdio-common/vfscanf.c (__vfscanf): Don't count EOF char
	in %c format.

Sat Aug 31 18:10:51 1996  Ulrich Drepper  <drepper@cygnus.com>

	* wcsmbs/wchar.h: Define prototypes for wcstoq and wcstouq only
	#ifdef __USE_GNU.

Sat Aug 31 12:34:29 1996  Ulrich Drepper  <drepper@cygnus.com>

	* version.c: Add missing newline character in banner.

	* sysdeps/unix/sysv/linux/alpha/Dist: Correct typo.
	* sysdeps/unix/sysv/linux/i386/Dist: Likewise.

Sat Aug 31 03:07:39 1996  Ulrich Drepper  <drepper@cygnus.com>

	* intl/l10nflist.c (_nl_normalize_codeset): We convert to lower
 	case, so don't prepend uppercase `ISO' for only numeric arg.

Wed Sep  4 16:16:13 1996  Ulrich Drepper  <drepper@cygnus.com>

	* sysdeps/mach/hurd/send.c (__send): De-ANSI-fy.
	* sysdeps/mach/hurd/sendto.c (sendto): Likewise.

Tue Sep  3 11:16:07 1996  Thomas Bushnell/ n/BSG  <thomas@gnu.ai.mit.edu>

	* shadow/lckpwdf.c (__ulckpwdf): Don't take address of LOCK in
 	call to __libc_lock_lock.

	* sysdeps/mach/hurd/send.c (__send): Declare BUF const.
	* sysdeps/mach/hurd/sendto.c (sendto): Likewise.

	* sysdeps/stub/ustat.c: Include <sys/ustat.h>.

	* misc/syslog.c (vsyslog): Fix typo (`mow_tm' -> `now_tm').

Fri Aug 30 19:55:27 1996  Ulrich Drepper  <drepper@cygnus.com>

	* libio/genops.c: Make _cleanup an alias of _IO_cleanup.
	Reported by Erik Troan.

Fri Aug 30 15:40:04 1996  Ulrich Drepper  <drepper@cygnus.com>

	* sysdeps/unix/sysv/linux/Dist: Add sys/procfs.h and
 	sys/sysmacros.h.  Reported by Curtiss <1CMC3466@IBM.MTSAC.EDU>.

Fri Aug 30 13:53:32 1996  Andreas Jaeger  <aj@arthur.pfalz.de>

	* sysdeps/unix/mman/syscalls.list: `mmap' has 6 arguments, not 5.

Fri Aug 30 13:01:10 1996  NIIBE Yutaka  <gniibe@mri.co.jp>

	* sysdeps/i386/fpu/__math.h (tan): Pop 1.0 in ST to get
	real result.

Fri Aug 30 03:33:33 1996  Ulrich Drepper  <drepper@cygnus.com>

	* sysdeps/libm-ieee754/s_cbrtl.c: New file.  `long double'
	implementation.

Fri Aug 30 13:39:21 1996  Thomas Bushnell, n/BSG  <thomas@gnu.ai.mit.edu>

	* Makerules (BUILD_CFLAGS): Use @(common-objpfx) for config.h, not
 	$(..).  Some rules (like sysdeps/posix/Makefile for mk-stdiolim)
 	do `cd' commands.
	(sed-remove-objpfx): Don't substitute for $(objpfx) anymore;
 	$(common-objpfx) is good enough.
	* Rules (common-generated): Provide default (empty) value.
	(dummy.o, dummy.c, empty.o, empty.c): Put these in
 	$(common-generated), not $(generated), and without $(..).
	(subdir_echo-distinfo): Treat $(common-generated) just like
 	$(generated).
	(generated): Depend on the (suitably mutated) $(common-generated)
 	files too.
	* Makerules (common-clean): Remove common-generated files too.
	* sysdeps/mach/hurd/Makefile (generated): Don't put errnos.d and
 	stamp-errnos here.
	(common-generated): Do put errnos.d and stamp-errnos here.
	(rpath-link): Don't use +=; $(rpath-link) is a colon separated list.

	* sysdeps/mach/hurd/Makefile (before-compile): Add auth; also add
 	auth to following rule to get it built.

Fri Aug 30 01:26:44 1996  Ulrich Drepper  <drepper@cygnus.com>

	* sysdeps/unix/sysv/linux/i386/Dist: Add clone.S.
	* sysdeps/unix/sysv/linux/m68k/Dist: Likewise.
	* sysdeps/unix/sysv/linux/alpha/Dist: Likewise.

	* version.c: Add comment about where to report bugs to.
	* catgets/gencat.c (usage): Likewise.
	* db/makedb.c (usage): Likewise.
	* locale/programs/locale.c (usage): Likewise.
	* locale/programs/localedef.c (usage): Likewise.

	* manual/socket.texi: A little bit better wording.

Thu Aug 29 18:03:06 1996  Ulrich Drepper  <drepper@cygnus.com>

	* Makerules: Make sure directory exists before generating stamp file.
	(BUILD_CFLAGS): Always refer to using $(..).
	* manual/Makefile: Make sure directory exists before generating
 	stamp file.
	(make-target-directory): Add macro definition.
	* sysdeps/generic/Makefile: Make sure directory exists before
 	generating stamp file.

	* Makefile (distribute): Add autolock.sh.  Reported by Fila Kolodny.

Tue Aug 27 10:06:22 1996  Andreas Schwab  <schwab@issan.informatik.uni-dortmund.de>

	When compiling in separate directory put objects into
	subdirectories matching the source layout.
	* Makeconfig (objpfx) [ifdef objdir]: Append $(subdir).
	When looking for configparms try in $(common-objpfx).
	Use $(common-objpfx)SUBDIR to find objects from other subdirectory
	builds.
	* Makerules: Add $(objpfx) to vpath list.
	(make-dummy-dep): Use $(common-objpfx) to avoid creating dummy.d
	more than once.  All uses in dependency lists changed.
	(+make-deps): Make target directory.
	(sed-remove-objpfx): Substitute $(common-objpfx).
	(do-ar, build-extra-lib, $(common-objpfx)stub-$(subdir)): Use
	$(objpfx) instead of $(objdir) for cd command.
	(O%-lib): Always find libc relative to $(..).
	(subdir-stamps): Collect stamp files from subdirs.
	(common-mostlyclean): Remove stub file in $(common-objpfx).
	* MakeTAGS ($P/siglist.pot): Find siglist.c in stdio-common.
	* Rules (dep-dummy-lib): Use $(common-objpfx) to avoid creating to
	more than once.
	($(objpfx)dummy.c, $(objpfx)empty.c): Change target name to use
	$(common-objpfx).  All uses in dependency lists changed.
	(generated): Prepend $(..) to names.
	* bare/Makefile ($(objpfx)lib$(config-vendor).a): Remove $(objpfx)
	from $@.
	* nss/Makefile ($(objpfx)libnss_dns.so, $(objpfx)libnss_db.so):
	Use $(common-objpfx) instead of $(..) in dependencies.
	* sysdeps/mach/Makefile (mach-objpfx): Unconditionally use
	$(common-objpfx) instead of $(..) and (objpfx).
	* sysdeps/mach/hurd/Makefile (hurd-objpfx): Likewise.
	(rpath-link): Likewise.
	(rpcuserlibs): Likewise.
	* sysdeps/unix/Makefile [$(subdir) = stdio-common]: Check for
	errlist.c in $(objpfx), not $(common-objpfx).
	($(common-objpfx)s-proto.d): Special rule not covered by pattern
	rule.
	* sysdeps/unix/make-syscalls.sh: Make syscall rules depending on
	s-proto.d in $(common-objpfx), not $(objpfx).

Thu Aug 29 17:45:49 1996  Ulrich Drepper  <drepper@cygnus.com>

	* nss/nsswitch.c (nss_dlerror_run): Free returned error
	string.

Thu Aug 29 15:53:33 1996  Ulrich Drepper  <drepper@cygnus.com>

	* sysdeps/libm-ieee754/e_acoshl.c: New file. `long double'
 	implementation.
	* sysdeps/libm-ieee754/e_atanhl.c: Likewise.
	* sysdeps/libm-ieee754/e_remainderl.c: Likewise.
	* sysdeps/libm-ieee754/e_scalbl.c: Likewise.
	* sysdeps/libm-ieee754/s_asinhl.c: Likewise.
	* sysdeps/libm-ieee754/s_cosl.c: Likewise.
	* sysdeps/libm-ieee754/s_sinl.c: Likewise.
	* sysdeps/libm-ieee754/s_tanhl.c: Likewise.
	* sysdeps/libm-ieee754/s_tanl.c: Likewise.

Thu Aug 29 12:00:30 1996  Thomas Bushnell, n/BSG  <thomas@gnu.ai.mit.edu>
	
	* sysdeps/mach/hurd/setitimer.c (setitimer_locked): Correct
 	spelling error of _hurd_itimerval.

	* mach/Makefile (MIGFLAGS-mach/mach4): Define variable.
  	* mach/Machrules (mig.uh, mig.__h): Include $(user-MIGFLAGS) and
 	$(MIGFLAGS-$*) here too, as well as in the code-generating MiG calls. 
	
	* hurd/hurdinline.c: Include "hurd.h" for function definitions too. 
	
	* stdio/fseek.c (fseek): Don't assume we know the file position;
 	other handles may have changed it.  So set STREAM.__offset to -1
 	before calling __stdio_check_offset to make sure we have a correct
 	value.

Thu Aug 29 00:28:08 1996  Ulrich Drepper  <drepper@cygnus.com>

	* stdio-common/printf_fp.c (__printf_fp): Use default value '.' if
 	`decimal' char is 0.

	* C-numeric.c (not_available): New constant.
	(_nl_C_LC_NUMERIC): Use `not_available' for grouping value.

	* nss/nsswitch.conf: Example configuration file.
	* nss/db-Makefile: Example Makefile for generation of databases
	for nss_db.
	* nss/Makefile (distribute): Add nsswitch.conf and db-Makefile.

1996-08-28  Paul Eggert  <eggert@twinsun.com>

	* C-messages.c (_nl_C_LC_MESSAGES): Set yesexpr to "^[yY]" and
 	noexpr to "^[nN]"; this conforms to POSIX.2.

	* C-time.c (_nl_C_LC_TIME): Change %d to %e in d_t_format, to
 	conform to POSIX.2.

1996-08-28  Paul Eggert  <eggert@twinsun.com>

	* C-monetary.c (not_available): New constant.
	(_nl_C_LC_MONETARY): Set mon_decimal_point to "", and set
 	mon_grouping, int_frac_digits, frac_digits, p_cs_precedes,
 	p_sep_by_space, n_cs_precedes, n_sep_by_space, p_sign_posn, and
 	n_sign_posn to CHAR_MAX, as required by the POSIX Standard.

Wed Aug 28 23:12:28 1996  Ulrich Drepper  <drepper@cygnus.com>

	* nss/nss_db/db-XXX.c: Correct function names.  They must be
	`_nss_db_*' instead of `_nss_files_*'.
	(lookup): `parse_line' returns 1 if succesful.
	* nss/nss_files/files-service.c (servbyname): Key for database
	must also contain protocol names.
	(servbypt): Likewise.
	Test must also check for protocol.  Add `proto' argument.

Tue Aug 27 09:56:13 1996  Andreas Schwab  <schwab@issan.informatik.uni-dortmund.de>

	* MakeTAGS ($P/subdirs.pot): Prefix all file names, not only the
	first one.

Tue Aug 27 17:45:21 1996  Ulrich Drepper  <drepper@cygnus.com>

	* Makerules: Add some test for correct version of GNU Make.

	* io/fcntl.h: Undo change from Mon Aug 26 22:22:17 1996.
	* sysdeps/unix/sysv/linux/fcntlbits.h: Place macros here instead.

	* sysdeps/generic/dl-sysdep.c: Initialize break address to
	avoid overwriting last page (OK, Roland).

Tue Aug 27 16:20:37 1996  Ulrich Drepper  <drepper@cygnus.com>

	* resolv/resolv.h: Update from BIND-4.9.5-T3A.
	* resolv/arpa/nameser.h: Likewise.
	* resolv/res_init.c: Likewise.
	* resolv/res_debug.c: Likewise.
	* resolv/res_mkquery.c: Likewise.

Tue Aug 27 15:47:04 1996  Ulrich Drepper  <drepper@cygnus.com>

	* elf/dl-error.c (catch): Define errstring element not as const.
	(_dl_catch_error): ERRSTRING argument is not const pointer.
	Initialize *ERRSTRING and *OBJNAME separately.
	* elf/link.h: Change prototype for `_dl_catch_error'.

	* elf/dl-load.c (_dl_map_object): Use separate variable for
	copied NAME to avoid `const' warning.

	* elf/dlerror.c: Make `last_errstring' variable not const pointer.

	* elf/rtld.c: Implement reading of /etc/ld.so.preload.  This
	provides preloading even for SUID binaries.
	Add some more casts to avoid signed<->unsigned warnings.

Tue Aug 27 15:40:28 1996  NIIBE Yutaka  <gniibe@mri.co.jp>

	* posix/sys/types.h: Define loff_t.
	* sysdeps/unix/sysv/linux/gnu/types.h: Define __loff_t.

Mon Aug 26 22:22:17 1996  Ulrich Drepper  <drepper@cygnus.com>

	* io/fcntl.h: Add definition for BSD F* macros.

	* misc/init-misc.c (__init_misc): Make static.
	* misc/Makefile: Pass -fkeep-inline-functions flag for init-misc.c.

	* configure.in: Add test for -fno-exception option of gcc.
	* config.make.in: Add definition of have-no-exceptions.
	* Makerules: Define no-exceptions based on have-no-exceptions.
	* csu/Makefile: When translating initfini.c pass $(no-exceptions).
	This is necessary for gcc >= ss-960816.

Mon Aug 26 17:16:48 1996  Richard Henderson  <rth@tamu.edu>

	* sysdeps/alpha/dl-machine.h: Clear startup flag.

Fri Aug 16 21:17:50 1996  Andreas Schwab  <schwab@issan.informatik.uni-dortmund.de>

	* Makerules (o-iterator-doit): Simplify reference to autolock
	script.

Sat Aug 24 15:27:41 1996  Andreas Schwab  <schwab@issan.informatik.uni-dortmund.de>

	* sysdeps/mach/hurd/getcwd.c
	(_hurd_canonicalize_directory_name_internal): After resizing the
	buffer move the current contents to the end.  Correctly relocate
	file name pointer to upper half of the buffer.

Mon Aug 26 15:49:59 1996  Ulrich Drepper  <drepper@cygnus.com>

	* rtld.c (dl_main): Remove code to call ld.so initializer.  This
	was introduced for compatibility with Linux ld.so and would not
	be used anymore.  Now we don't have any good values to use as the
	parameters to the initializer so simply remove it.

Sun Aug 25 18:25:52 1996  Andreas Schwab  <schwab@issan.informatik.uni-dortmund.de>

	* gmon/gmon.c (ERR): Don't write the terminating NUL.

	* sysdeps/posix/profil.c (profil): Disable the profiling timer at
	first.
	(profil_count): Use 64 bit arithmethic to avoid overflow.

	* sysdeps/generic/machine-gmon.h (MCOUNT): Fix argument order.

Mon Aug 26 16:31:33 1996  Thomas Bushnell, n/BSG  <thomas@gnu.ai.mit.edu>

	* sysdeps/mach/hurd/setitimer.c (setitimer_locked): Tolerate NEW
	being null; in that case don't touch the timer at all (but do
	return something in OLD if necessary).

Mon Aug 26 13:35:16 1996  Thomas Bushnell, n/BSG  <thomas@gnu.ai.mit.edu>

	* sysdeps/mach/hurd/i386/init-first.c (__libc_multiple_libcs): New
 	variable.
	* sysdeps/i386/init-first.c: Likewise.
	* sysdeps/stub/init-first.c: Likewise.

Mon Aug 26 02:01:37 1996  Ulrich Drepper  <drepper@cygnus.com>

	* elf/dl-open.c (_dl_open): Call library initializer with
	correct command line arguments and environment information.
	* elf/rtld.c (dl_main): Provide arguments to initializer of
	ld.so itself.

Sun Aug 25 19:15:46 1996  Ulrich Drepper  <drepper@cygnus.com>

	* shadow/Makefile (routines): Add lckpwdf.
	* shadow/lckpwdf.c: New file.

	* sysdeps/i386/fpu_control.h (_FPU_GETCW, _FPU_SETCW): Force
	argument `cw' to be placed in memory.  Patch by Torbjorn Granlund.

Sun Aug 25 12:53:37 1996  Ulrich Drepper  <drepper@cygnus.com>

	* configure.in: Add definition for `__eh_pc' and `__throw' in
	test for --no-whole-archive.  The compiler generates dependencies
	for this but none of the standard librares and startup files
	are used.  Necessary for gcc >= ss-960816.

Sun Aug 25 01:31:33 1996  Ulrich Drepper  <drepper@cygnus.com>

	* elf/dl-error.c (_dl_signal_error): If error is catched, malloc
	return string since string might be on stack.
	* elf/dl-lookup.c (_dl_lookup_symbol): Undo change of
	Wed Aug 21 10:14:59 1996.
	* elf/dlerror.c (dlerror): Free error string after printing.
	(_dlerror_run): If error string was not printed since last error
	free string.
	* rtld.c (dl_main): Free error string in case of error.

Sat Aug 24 03:16:47 1996  Ulrich Drepper  <drepper@cygnus.com>

	* misc/syslog.c (vsyslog): Don't use `localtime' or `gmtime' since
 	this changes the global state for `localtime' and `gmtime'.  Use
 	`__localtime_r'/`__gmtime_r' instead.
	* resolv/res_debug.c (__p_secstodate): Likewise.
	* sysdeps/generic/ftime.c: Likewise.
	* sysdeps/posix/gettimeofday.c: Likewise.
	Reported by Paul Eggert.

	* time/gmtime.c: De-ANSI-fy.
	* time/strftime.c: Don't call non-reentrant functions which change
 	state.

Wed Aug 21 10:14:59 1996  Richard Henderson  <rth@tamu.edu>

	* elf/dl-lookup.c (_dl_lookup_symbol): Malloc the error string rather
	than putting it on the stack.

Wed Aug 21 10:12:42 1996  Richard Henderson  <rth@tamu.edu>

	* elf/rtld.c (dl_main): When looking up symbols in response to --list,
	don't find .plt entries.

Mon Aug 19 23:18:12 1996  Andreas Schwab  <schwab@issan.informatik.uni-dortmund.de>

	* sysdeps/m68k/dl-machine.h (RTLD_START): Optimize clearing
	_dl_starting_up.

Tue Aug 20 17:42:10 1996  Miles Bader  <miles@gnu.ai.mit.edu>

	* stdio/linewrap.c (line_wrap_stream): Initialize D->seek.

Sat Aug 17 12:19:37 1996  David Mosberger-Tang  <davidm@azstarnet.com>

	* login/pututline_r.c (__pututline_r): Fix handling of case where
 	getutid_r() fails with ESRCH.  Reported by Miquel van Smoorenburg.

Wed Aug 14 14:10:54 1996  David Mosberger-Tang  <davidm@azstarnet.com>

	* sysdeps/unix/sysv/linux/alpha/ioperm.c (platform): Change entry
 	for "Jensen" so _bus_base() returns 0 on that platform.  Use
 	_bus_base_sparse() to determine base address of sparse memory.

	* sysdeps/unix/sysv/linux/sys/io.h: Enclose #include <asm/io.h>
	and declarations in __BEGIN_DECLS/__END_DECLS.

Sun Aug 18 13:37:09 1996  Ulrich Drepper  <drepper@cygnus.com>

	* err.h: New file.  Wrapper around misc/err.h.

	Correct solution of multiple initialization problem by
	Roland McGrath.
	* csu/initfini.c: Remove global variable __libc_is_static.
	* elf/rtld.c: Introduce new global variable _dl_starting_up.
	It's nonzero during the startup.
	* elf/dl-open.c (_dl_open): When _dl_start function is not
	available (i.e., if in static libc) set `__libc_multiple_libcs'
	to nonzero value.
	* sysdeps/unix/sysv/linux/init-first.c (__libc_multiple_libc):
	New global variable.
	(init): Undo change of Fri Aug  2 03:12:40 1996.
	Initialize `__libc_multiple_libcs' to nonzero only if this is
	a shared lib called from a statically linked program and don't
	call `personality' and `setfpucw' in this case either.
	* sysdeps/generic/sbrk.c: Undo change of Fri Aug  2 03:12:40 1996.
	Don't call brk(0) until `__libc_multiple_libcs' is nonzero.
	* sysdeps/i386/dl-machine.h (RTLD_START): Clear _dl_starting_up
	before jumping to user code.
	* sysdeps/m68k/dl-machine.h (RTLD_START): Likewise.

Fri Aug 16 04:59:01 1996  Ulrich Drepper  <drepper@cygnus.com>

	* sysdeps/unix/sysv/linux/init-first.c: Remove hack from
	Thu Aug  8 12:40:20 1996.
	* sysdeps/unix/sysv/linux/Makefile [$(subdir) = csu]: Use
	-fkeep-inline-functions flag instead.

Fri Aug 16 16:11:25 1996  Thomas Bushnell, n/BSG  <thomas@gnu.ai.mit.edu>

	* nss/nss_dns/dns-host.c (_nss_dns_gethostbyname2_r): Treat
 	EPFNOSUPPORT and EAFNOSUPPORT as implying NSS_STATUS_UNAVAIL just
 	like ECONNREFUSED already does.
	(_nss_dns_gethostbyaddr_r): Likewise.
	* nss/nss_dns/dns-network.c (_nss_dns_getnetbyname_r): Likewise.
	(_nss_dns_getnetbyaddr_r): Likewise.

	* sysdeps/mach/hurd/socket.c (socket): For message transmission
 	and RPC errors that indicate that the socket server is not really
 	present and able to do its job, turn the error into EPFNOSUPPORT.

Fri Aug 16 01:24:33 1996  Ulrich Drepper  <drepper@cygnus.com>

	* inet/ruserpass.c (userpass): Allocate buffer for .netrc file
	name dynamically.  Reported by Alan Cox.
	Uncomment warnings and mark as translatable.

	* time/strftime (strftime): Add implementation for %s and %z
	format.  Change behaviour for unknown format character: now
	simply print it.  This matches the behaviour of printf.
	Reported by Jim Meyering.
	* manual/time.texi: Document all formats and flags of strftime.

Thu Aug 15 18:02:51 1996  Ulrich Drepper  <drepper@cygnus.com>

	* elf/rtld.c (dl_main): Loaded object has type lt_executable,
	not lt_library.

	* misc/sys/select.h: Define fd_set using typedef, not #define.
	Proposed by David Mosberger-Tang.

Thu Aug 15 12:48:21 1996  Ulrich Drepper  <drepper@cygnus.com>

	* po/header.pot: Use real description line.

Thu Aug 15 04:42:44 1996  Ulrich Drepper  <drepper@cygnus.com>

	* elf/rtld.c (dl_main): When started with --verify prevent
	any warning.  Just exit with an error.
	* elf/ldd.sh.in: Don't run given object directly.  This fails for
	libraries.  Instead use $RTLD again.

Thu Aug 15 02:08:59 1996  Ulrich Drepper  <drepper@cygnus.com>

	* manual/nss.texi: New file.  Document NSS.
	* manual/nsswitch.texi: New file.  Example configuration.

	* manual/string.texi: Document stpncpy, strdupa, and strndupa.
	* manual/example/strdupa.c: New file.  Example for strdupa.

Wed Aug 14 21:36:16 1996  Ulrich Drepper  <drepper@cygnus.com>

	* stdlib/strtod.c (STRTOD): Correct assertion about size of
	wint_t and wchar_t.  Reported by David Mosberger-Tang.

Mon Aug 12 22:40:16 1996  Andreas Schwab  <schwab@issan.informatik.uni-dortmund.de>

	* elf/dl-lookup.c (_dl_lookup_symbol): Remove fifth parameter
	RELOC_ADDR and make NOPLT a set of flags.  All callers
	changed.  Delete condition that checks for resolving to the
	location being filled in.  Add condition to skip the
	executable's symbols if requested.
	* elf/link.h: Change declaration of _dl_lookup_symbol
	accordingly.
	(DL_LOOKUP_NOEXEC, DL_LOOKUP_NOPLT): New definitions.
	* elf/dl-reloc.c (RESOLVE): Remove second parameter and rename
	NOPLT to FLAGS.
	* elf/dl-runtime.c (RESOLVE): Likewise.
	* elf/rtld.c (RESOLVE): Likewise.
	* sysdeps/m68k/dl-machine.h (elf_machine_rela): Pass
	DL_LOOKUP_NOEXEC as second argument to the RESOLVE macro if
	processing a copy reloc, DL_LOOKUP_NOPLT for a jump slot
	reloc, zero otherwise.
	* sysdeps/alpha/dl-machine.h (elf_machine_rela): Likewise.
	* sysdeps/i386/dl-machine.h (elf_machine_rel): Likewise.
	* sysdeps/mips/dl-machine.h (elf_machine_rel): Likewise.

Wed Aug 14 17:57:08 1996  Ulrich Drepper  <drepper@cygnus.com>

	* MakeTAGS: Clean up use of --omit-header and -n for xgettext.
	* po/header.pot: Add empty line at end.

Sun Aug 11 13:45:33 1996  Andreas Schwab  <schwab@issan.informatik.uni-dortmund.de>

	* MakeTAGS (all-pot): Remove $P/errlist.pot, all error messages
 	are now in $P/stdio-common.pot.
	(XGETTEXTFLAGS-errlist.pot): Variable removed.

Mon Aug 12 19:25:03 1996  Andreas Schwab  <schwab@issan.informatik.uni-dortmund.de>

	* Makerules (do-ar, o-iterator-doit): Compute path to autolock
 	script at run time, not configure time.
	* config.make.in, configure.in: Undo previous change.

Wed Aug 14 13:20:02 1996  Ulrich Drepper  <drepper@cygnus.com>

	* sysdeps/unix/sysv/linux/i386/close.S: Push return value of thread
	on stack as argument for `_exit'.  Reported by Andreas Schwab.

Mon Aug 12 19:36:25 1996  Andreas Schwab  <schwab@issan.informatik.uni-dortmund.de>

	* sysdeps/unix/sysv/linux/m68k/clone.S: New file.

Wed Aug 14 04:22:35 1996  Richard Henderson  <rth@tamu.edu>

	* elf/dl-load.c (_dl_map_object): Save name in malloced memory.
	(_dl_map_object_from_fd): Free name on error.

Wed Aug 14 13:00:09 1996  Ulrich Drepper  <drepper@cygnus.com>

	* string/strdup.c: Use result of memcpy to avoid reloading.

Tue Aug 13 00:55:03 1996  Andreas Schwab  <schwab@issan.informatik.uni-dortmund.de>

	* shadow/sgetspent_r.c (__sgetspent_r): Copy string to buffer, not
	the other way round.

Tue Aug 13 20:51:21 1996  Ulrich Drepper  <drepper@cygnus.com>

	* stdlib/canonicalize.c (canonicalize): Add cast to prevent
 	warning.

	* Makerules (o-iterator-doit): Use autolock.sh when running ranlib.

Tue Aug 13 18:26:45 1996  Ulrich Drepper  <drepper@cygnus.com>

	* nss/nsswitch.c (__nss_configure_lookup): Use fact that list is
 	sorted.

	Update from bind-4.9.5-T1A.
	* resolv/Makefile (libresolv-routines): Add base64, inet_net_ntop,
 	inet_net_pton, inet_net.

	* resolv/gethnamaddr.c: Include <sys/types.h>.
	* resolv/getnetnamadr.c: Likewise.
	* resolv/herror.c: Likewise.
	* resolv/inet_addr.c: Likewise.
	* resolv/nsap_addr.c: Likewise.
	* resolv/res_comp.c: Likewise.
	* resolv/res_data.c: Likewise.
	* resolv/res_init.c: Likewise.
	* resolv/res_mkquery.c: Likewise.
	* resolv/res_query.c: Likewise.
	* resolv/res_send.c: Likewise.

	* resolv/gethnamaddr.c [! SPRINTF_CHAR] (SPRINTF): Cast return
 	value of sprintf.
	* resolv/inet_ntop.c: Likewise.

	* resolv/gethnamaddr.c [BSD]: Include <stdlib.h>.
	Remove prototype of gethostbyname_ipv4.

	* resolv/inet_ntop.c, resolv/inet_pton.c: Use ISO C `mem*'
 	functions instead of BSD `b*' functions.

	* resolv/nsap_addr.c: Add copyright message.

	* resolv/res_comp.c: Remove comment explaining label format.
	(res_mailok): Correct check.

	* resolv/res_debug: Include missing headers.
	(__fp_nquery): Handle `unused', `ad', and `cd' bits.
	(__p_fqnname): New function to print FQDN from compressed name.
	(__p_rr): Use __p_fqnname.  Correct printing of ".  Handle T_TXT
	correctly.  Add handling of T_KEY and T_SIG.
	Handle class and type names by using name arrays instead of
	explicit `switch'es.
	(__sym_ston, __sym_ntos, __sym_ntop): New functions to use arrays.
	(__dn_count_labels, __p_secstodate): New functions.

	* resolv/resolv.h (__RES): Update version number.
	(res_sym): New type.
	Add #defines for new functions.
	Declare sym_ntos, sym_ntop, b64_ntop, b64_pton, __p_fqnname,
	__p_secstodate, dn_count_labels.

	* resolv/arpa/nameser.h (__BIND): Update version number.
	Add KEYFLAG_* and ALGORITHM_* symbols.
	(HEADER): Add `ad' and `cd' flags.

	* inet/ient.h: Add prototypes for inet_neta, inet_net_ntop,
	and inet_net_pton.

	* manual/maint.texi: Document that we use bind-4.9.5.
	* INSTALL: Ditto.

Mon Aug 12 19:03:22 1996  Thomas Bushnell n/BSG  <thomas@psilocin.gnu.ai.mit.edu>

	* sysdeps/generic/gnu/types.h: Declare __fd_mask as `unsigned long'.

	* mach/Makefile (mach/mach_host.uh): Depend on
 	$(objpfx)/mach-syscalls.mk.
	($(objpfx)mach-shortcuts.h): Depend on $(objpfx)mach/mach_host.h.
	(This fixes a make loop; thanks to Marcus Daniels
 	<marcus@sysc.pdx.edu> for the patch.)

Mon Aug 12 16:41:52 1996  Thomas Bushnell n/BSG  <thomas@gnu.ai.mit.edu>

        * io/getwd.c (getwd) [! PATH_MAX]: Don't assume that the user's
        buffer is any longer than the amount necessary to hold the
        filename; the Hurd getcwd uses the *entire* contents of the
        buffer, however long it is specified to be.

Mon Aug 12 04:33:09 1996  Ulrich Drepper  <drepper@cygnus.com>

	* nss/nsswitch.c (__nss_database_lookup): Always release locks
 	before returning.  Reported by Miles Bader.

Mon Aug 12 03:31:58 1996  Ulrich Drepper  <drepper@cygnus.com>

	* nss/nsswitch.c (__nss_configure_lookup):  New function.
	Allows to specify services.
	* nss/XXX-lookup.h: Rename database variable and make global.
	* nss/databases.def: New file.  Real names of all databases.

	* nss/nss.h: New file.  Contains declaration useful for users
	and service developers.
	* nss/nsswitch.h: Move some declarations to nss/nss.h.
	* nss.h: New file.  Wrapper around nss/nss.h.

	* nss/Makefile (headers): Add nss.h.
	(distributes): Add databases.def.

Sun Aug 11 16:19:42 1996  Ulrich Drepper  <drepper@cygnus.com>

	Help the poor people with fast machines by making sure only
	one `ar' commands works on the library.
	* autolock.sh: New file.  Written by Tom Tromey.
	* Makerules (do-ar): Call autolock.sh shell script instead of
	directly using `ar'.
	* config.make.in: Make configuration variable AUTOLOCK which
	gets initialized by configure.
	* configure.in: Define variable AUTOLOCK to point to autolock.sh
	script and mark it to substitute.

	* string/Makefile: Add -fno-builtin for tst-strlen.c, too.

	* sysdeps/generic/sbrk.c (__sbrk):  Get kernel brk address
	always only if in static libc or if statically linked program
	uses libc.so.

	* sysdeps/generic/sbrk.c (__sbrk):  Get kernel brk address
	always only if in static libc or if statically linked program
	uses libc.so.

Sun Aug 11 01:12:38 1996  Richard Henderson  <rth@tamu.edu>

	* sysdeps/alpha/dl-machine.h (elf_alpha_fix_plt): Optimize LD_BIND_NOW
	startup by moving Icache flush from here ...
	(ELF_MACHINE_RUNTIME_TRAMPOLINE): ... to here.
	(ELF_MACHINE_USER_ADDRESS_MASK): Delete; it is unused.

	* sysdeps/alpha/divrem.h: Update comment to reflect the actual
	calling conventions.  The code is already correct.

Sun Aug 11 01:06:42 1996  Richard Henderson  <rth@tamu.edu>

	* string/Makefile: Compile tester with -fno-builtin as we want to
	test our implementations, not gcc's.

Sat Aug 10 13:17:27 1996  David Mosberger-Tang  <davidm@azstarnet.com>

	* shadow.h: New file.

	* sysdeps/unix/sysv/linux/netinet/in.h: Move
 	__BEGIN_DECLS/__END_DECLS up so ntohl() et al are bracketed as
 	well.

	* socket/sys/socket.h [__cplusplus]: Use old-style __SOCKADDR_ARG.
	g++ 2.7.2 (and earlier) has no transparent unions support.

Fri Aug  9 18:50:06 1996  David Mosberger-Tang  <davidm@azstarnet.com>

	* sysdeps/unix/sysv/linux/alpha/ioperm.c (_bus_base_sparse): New
	function to determine the base address of sparse bus memory.
	(APECS_*): Rename to CIA_*.
	(APECS_SPARSE_MEM, CIA_SPARSE_MEM): New macros.
	(platform): Add sparse_bus_memory_base member and initialize.
	(sparse_bus_memory_base): New variable.

Tue Aug  6 10:23:18 1996  David Mosberger-Tang  <davidm@azstarnet.com>

	* sysdeps/posix/ttyname_r.c (ttyname_r),
	sysdeps/posix/ttyname.c (ttyname): Return -1/NULL if
	!__isatty(fd) (POSIX.1 says so.)

	* sysdeps/unix/getlogin.c (getlogin): Fix to check fd 0 only.
  	This is not a gross hack, after all---for compatibility,
 	getlogin() really should check fd 0 only and not try to base its
 	operation on the controlling tty.

Wed Jul 17 10:54:20 1996  David Mosberger-Tang  <davidm@azstarnet.com>

	* sysdeps/unix/getlogin.c (getlogin): Add static variable NAME,
 	change utmp_data from static to auto.

Sun Aug 11 02:56:08 1996  Ulrich Drepper  <drepper@cygnus.com>

	* posix/unistd.h [__USE_MISC]: Add prototype for `nice'.
	Reported by David Mosberger-Tang.

Sat Aug 10 02:05:28 1996  Richard Henderson  <richard@twiddle.tamu.edu>

	* sysdeps/libm-ieee754/s_isnan.c [NO_LONG_DOUBLE]: Add strong
	alias to `__isnanl'.

Fri Aug  9 17:38:58 1996  Ulrich Drepper  <drepper@cygnus.com>

	* sysdeps/unix/sysv/linux/sys/timex.h: Include <sys/time.h> to
	get `struct timeval'.
	* sysdeps/unix/sysv/linux/sys/acct.h: Get time_t from <time.h>.
	* sysdeps/unix/sysv/linux/sys/module.h: Get size_t from <stddef.h>.
	* sysdeps/unix/sysv/linux/sys/io.h: Get definition of __P.
	* sysdeps/unix/sysv/linux/sys/klog.h: Likewise.
	* gmon/sys/gmon.h: Include <sys/types.h> to get u_long.
	* sysdeps/unix/sysv/linux/direntry.h: Complete types in
	<linux/dirent.h>.
	* io/fts.h: Include <sys/types.h> to get dev_t.
	Reported by Matthias Urlichs.

	* sysdeps/posix/tempname.c [USE_IN_LIBIO]: Don't clear
 	_IO_file_flags.  It's the same as _flags.
	Reported by Miquel van Smoorenburg <miquels@Q.cistron.nl>.

Wed Aug  7 19:38:47 1996  Andreas Schwab  <schwab@issan.informatik.uni-dortmund.de>

	* sysdeps/unix/sysv/linux/m68k/resourcebits.h: Add RLIMIT_AS.

Thu Aug  8 16:17:38 1996  Ulrich Drepper  <drepper@cygnus.com>

	* pwd/getpwent.c: Define BUFLEN from NSS_BUFLEN_PASSWD.
	* pwd/getpwent_r.c: Likewise.
	* pwd/getpwnam.c: Likewise.
	* pwd/getpwnam_r.c: Likewise.
	* pwd/getpwuid.c: Likewise.
	* pwd/getpwuid_r.c: Likewise.

	* grp/getgrent.c: Define BUFLEN from NSS_BUFLEN_GROUP.
	* grp/getgrent_r.c: Likewise.
	* grp/getgrgid.c: Likewise.
	* grp/getgrgid_r.c: Likewise.
	* grp/getgrnam.c: Likewise.

	* pwd/fgetpwent_r.c: New file.  Reentrant version of fgetpwent.
	* pwd/fgetpwent.c: Rewrite to use fgetpwent_r.
	* pwd/Makefile (routines): Add fgetpwent_r.
	* pwd/pwd.h: Add prototypes for __fgetpwent_r and fgetpwent_r.

	* grp/fgetgrent_r.c: New file.  Reentrant version of fgetgrent.
	* grp/fgetgrent.c: Rewrite to use fgetgrent_r.
	* grp/Makefile (routines): Add fgetgrent_r.
	* grp/grp.h: Add prototypes for __fgetgrent_r and fgetgrent_r.

	Implement shadow password lookup functions.  This is no complete
	shadow password suite.
	* shadow/Makefile: New file.
	* shadow/fgetspent.c: New file.
	* shadow/fgetspent_r.c: New file.
	* shadow/getspent.c: New file.
	* shadow/getspent_r.c: New file.
	* shadow/getspnam.c: New file.
	* shadow/getspnam_r.c: New file.
	* shadow/putspent.c: New file.
	* shadow/sgetspent.c: New file.
	* shadow/sgetspent_r.c: New file.
	* shadow/shadow.h: New file.
	* shadow/spwd-lookup.c: New file.
	* shadow/nss_files/files-spwd.c: New file.

Thu Aug  8 13:33:45 1996  Ulrich Drepper  <drepper@cygnus.com>

	* sysdeps/unix/sysv/linux/ftime.c: New file.  Available system
 	call is only a stub.
	Reported by Matthias Urlichs.

	* Makeconfig [!default_cflags]: Change default value from `-g'
	to `-g -O'.

	* configure.in: Recognize i686.
	* sysdeps/i386/i686/Implies: Default on i586 optimized code.

Thu Aug  8 12:40:20 1996  Matthias Urlichs  <smurf@smurf.noris.de>

	* Makeconfig [$(build-omitfp) == yes]: Add to CFLAGS-.so
	value of CFLAGS-.o, not CFLAGS-o.

	* sysdeps/unix/sysv/linux/init-first.c (init): Add volatile
	pointer to ourself.  Otherwise `gcc -O3' optimized init away.

Thu Aug  8 01:41:43 1996  Ulrich Drepper  <drepper@cygnus.com>

	* elf/Makefile: Undo change of Tue Aug  6 14:27:11 1996.
	* elf/dl-support: Add definition of `_dl_sysdep_read_whole_file'.

Thu Aug  8 01:15:59 1996  Ulrich Drepper  <drepper@cygnus.com>

	* sysdeps/i386/fpu_control.h (_FPU_DEFAULT, _FPU_IEEE): Set
	to 0x137f to allow long double operations.

Sun Aug  4 13:12:05 1996  Richard Henderson  <rth@tamu.edu>

	Bug Fixes:

	* nss/nsswitch.c (_res): Remove redundant variable definition.
	The real one is in resolve/res_init.c, and having both prevents
	using -fno-common when building the shared library.
	* sunrpc/rpc_prot.c (_null_auth): Same.  Original is in rpc_common.c.

	* sysdeps/unix/sysv/linux/alpha/brk.S: When PIC, define __curbrk as
	a .bss object not a COMMON symbol.

	* sysdeps/alpha/bsd-_setjmp.S, sysdeps/alpha/bsd-setjmp.S: Must load
	$gp before referencing __sigsetjmp symbol.  Retain LITUSE for same.

	Optimizations:

	* sysdeps/alpha/strlen.S: Rearrange first-word setup and thense the
	main loop for better dual-issue on EV5.  Rearrange binary search to
	pipeline better and trim one instruction.

	Cosmetic Changes:

	* time/localtime.c (localtime_r): Move lock declaration back next to
	the comment where it was before the 960724 change.

	* INSTALL, manual/maint.texi: alpha-gnu-linux -> alpha-ANYTHING-linux.
	The second word is supposed to be the hardware manufacturer.

	* sysdeps/alpha/_mcount.S: Retain LITUSE for __mcount.
	* sysdeps/alpha/setjmp.S: Retain LITUSE for __sigsetjmp_aux.

	* sysdeps/alpha/divrem.h: More local labels, retain LITUSE for _mcount.

	* sysdeps/alpha/alphaev5/add_n.S, sysdeps/alpha/alphaev5/lshift.S,
	sysdeps/alpha/alphaev5/rshift.S, sysdeps/alpha/alphaev5/sub_n.S:
	Same cleanups as with EV4 GMP stuff.

Tue Jul 25 03:30:56 1996  Richard Henderson  <rth@tamu.edu>

	* sysdeps/unix/sysv/linux/Makefile [misc] (sysdep_routines): Add clone.
	* sysdeps/unix/sysv/linux/alpha/clone.S: New file.
	* sysdeps/unix/sysv/linux/i386/clone.S: New file.

Sun Aug  4 00:12:41 1996  David Mosberger-Tang  <davidm@azstarnet.com>

	* sysdeps/unix/sysv/linux/gnu/types.h: Declare __fd_mask as
	`unsigned long'.

	* misc/sys/select.h: Declare fd_mask as alias of __fd_mask.

Sat Aug  3 16:20:02 1996  David Mosberger-Tang  <davidm@azstarnet.com>

	* sysdeps/unix/sysv/linux/alpha/ioperm.c (platform): Add entry for
 	Mikasa.

	* socket/sys/socket.h (send, __send, sendto): Declare buffer
 	pointer as __const.

	* string/tester.c (main): Test stpncpy.

	* sysdeps/generic/stpncpy.c (__stpncpy): Fix so it works without
 	segfault when called with an N that is not a multiple of four and
 	src[N-1]=='\0'.

	* misc/syslog.c (LogType): New variable.
	(openlog): If connect() with SOCK_DGRAM fails with EPROTOTYPE,
 	try again with SOCK_STREAM (the Linux syslogd uses a socket of the
 	latter type).
	(vsyslog): When LogType==SOCK_STREAM, also send ASCII NUL
 	terminator as a record-delimiter.  If __send(LogFile) fails,
	call closelog() so logfile gets re-opened next time.

Wed Aug  7 15:15:14 1996  Ulrich Drepper  <drepper@cygnus.com>

	* elf/dl-open (_dl_open): Add cast to avoid warning.

	* manual/memory.texi: Improve some examples to give readers better
	advice: Use `stpcpy' instead of `strcat' if possible.
	* manual/string.texi: Document `strtok_r' and `strtok'.

	* sunrpc/Makefile: Move `+gccwarn' definition before inclusion
	of Makeconfig.
	[$(cross-compiling)=no]: Change test before making librpcsvc
	to this from $(cross-compile).
	Reported by Andreas Schwab.

Tue Aug  6 14:27:11 1996  Ulrich Drepper  <drepper@cygnus.com>

	* elf/Makefile (routines): Move dl-sysdep to here...
	(rtld-routines): ...from here.  This should make static linking
	work again.

	* locale/setlocale.c: Add local variable `lock' and add code to
	`setlocale' to avoid simultaneous changing of global data.

	* catgets/catgets.c (catopen): Use `__strdup' instead of `strdup'.
	* catgets/open_catalog (__open_catalog): Use `__stpcpy', `__open',
	`__fstat', `__read', `__mmap', `__munmap' and `__close' instead
	of unprotected names.

Tue Aug  6 01:13:56 1996  Ulrich Drepper  <drepper@cygnus.com>

	Clean name space according to ISO C, ISO C/Amd 1, and POSIX.1.
	This requires to rename several functions to use __ protected
	names.
	* dirent/dirent.h: Add prototypes of __opendir, __closedir,
	and __readdir.
	* sysdeps/mach/hurd/closedir.c: Prepend function name with __
	and make old name a weak alias.
	* sysdeps/mach/hurd/getrlimit.c: Likewise.
	* sysdeps/mach/hurd/opendir.c: Likewise.
	* sysdeps/mach/hurd/readdir.c: Likewise.
	* sysdeps/stub/closedir.c: Likewise.
	* sysdeps/stub/opendir.c: Likewise.
	* sysdeps/stub/readdir.c: Likewise.
	* sysdeps/unix/closedir.c: Likewise.
	* sysdeps/unix/opendir.c: Likewise.
	* sysdeps/unix/readdir.c: Likewise.

	* sysdeps/unix/opendir.c: Call `__fcntl' instead `fcntl'.

	* sysdeps/posix/getcwd.c: Call `__opendir', `__readdir',
	`__closedir' instead of unprotected names.

	* libio/filedoalloc.c (_IO_file_doallocate): Call `__isatty'
	instead of `isatty' since later is not part of ISO C.
	* libio/fileops.c (_IO_file_fopen): Call `__open' instead of
	`open' since later is not part of ISO C.

	* login/endutent.c (endutent): Call `__endutent_r', not
	`endutent_r'.
	* login/endutent_r.c: Rename defined function to `__endutent_r',
	make `endutent_r' weak alias.
	* login/getutent.c (getutent): Call `__getutent_r', not
	`getutent_r'.
	* login/getutid.c (getutid): Call `__getutid_r', not `getutid_r'.
	* login/getutid_r.c: Rename defined function to `__getutent_r',
	make `getutent_r' weak alias.
	* login/getutline.c (getutline): Call `__getutline_r', not
 	`getutline_r'.
	* login/getutline_r.c: Rename defined function to `__getutline_r',
	make `getutline_r' weak alias.
	* login/pututline_r.c: Rename defined function to `__pututline_r',
	make `pututline_r' weak alias.
	* login/setutent.c (setutent): Call `__setutline_r', not
 	`setutline_r'.
	* login/setutent_r.c: Rename defined function to `__setutline_r',
	make `setutline_r' weak alias.
	Rename `utmpname' to `__utmpname' and make former weak alias.
	(__utmpname): Call `__strdup', not `strdup'.
	* login/utmp.h: Add prototypes for name space clean reentrant
	versions.
	* sysdeps/unix/getlogin.c: Call `__ttyname_r', `__setutent_r',
	and `__endutent_r' instead of unprotected names.

	* math/math.h: Add prototype for `__matherr'.
	* sysdeps/libm-ieee754/k_standard.c: Call `__matherr' instead
	of `matherr'.

	* nss/getXXbyYY.c: Call __ protected reentrant function.
	* nss/getXXent.c: Likewise.
	* nss/getXXbyYY_r.c: Define `get*' function with __ protected
	name.  Make usual name a weak alias.
	* nss/getXXent_r.c: Likewise.

	* posix/unistd.h: Add prototype for `__ttyname_r'.
	* sysdeps/posix/ttyname_r.c: Rename function to `__ttyname_r'
	and make `ttyname_r' a weak alias.

	* resource/sys/resource.h: Add prototype for `__getrlimit'.
	* sysdeps/stub/getrlimit.c: Prepend function name with __
	and make old name a weak alias.
	* sysdeps/unix/syscalls.list: Rename system call to `__getrlimit'
	and make `getrlimit' weak alias.

	* libc/stdio/stdio.h: Add prototype for `__vscanf'.
	* libc/stdio/vscanf.c: De-ANSI-fy.
	Rename function to `__vscanf' and make `vscanf' a weak alias.
	* stdio-common/scanf.c (scanf): Use _IO_vscanf/__vscanf instead
 	of `vscanf'.

	* stdio-common/reg-printf.c: De-ANSI-fy.
	Rename function to `__register_printf_function' and make
	`register_printf_function' weak alias.

	* stdio-common/vfprintf.c: Call `__wcsrtombs' instead of
	`wcsrtombs'.

	* stdlib/mbstowcs.c: Call `__mbsrtowcs' instead of `mbsrtowcs'.
	* stdlib/mbtowc.c: Call `__mbrtowc' instead of `mbrtowc'.
	* stdlib/wcstombs.c: Call `__wcsrtombs' instead of `wcsrtombs'.
	* stdlib/wctomb.c: Call `__wcrtomb' instead of `wcrtomb'.
	* wcsmbs/mbrtowc.c: Prepend function name with __ and make old
 	name a weak alias.
	* wcsmbs/mbsrtowcs.c: Likewise.
	* wcsmbs/wcrtomb.c: Likewise.
	* wcsmbs/wcsrtombs.c: Likewise.
	* wcsmbs/wchar.h: Add prototypes for __ protected versions.

	* sysdeps/posix/sigsetmask.c (__sigsetmask): Call `__sigprocmask'
	instead of `sigprocmask'.


	* grp/grp.h [__USE_REENTRANT]: Add prototypes for reentrant
	version getgrent_r, getgrgid_r, and getgrnam_r.
	* pwd/pwd.h [__USE_REENTRANT]: Add prototypes for reentrant
	version getpwent_r, getpwuid_r, getpwnam_r and __ protected
	names.
	* resolv/netdb.h: Complete rewrite.  No more BSD ugliness.


	* misc/error.c (private_strerror): Translate messages from table,
	too.

	* io/fcntl.h: Pretty printing.
	* misc/fstab.h: Likewise.
	* misc/ttyent.h: Likewise.
	* resource/sys/resource.h: Likewise.
	* string/argz.h: Likewise.
	* string/envz.h: Likewise.

	Add support for symbols from POSIX.1c (POSIX threads).
	* posix/getconf.c: Handle new sysconf symbols.
	* posix/posix1_lim.h: Define _POSIX_TTY_NAME_MAX and
	_POSIX_LOGIN_NAME_MAX with minimal maximal values.
	* sysdeps/generic/confname.h: Define new symbols.
	* sysdeps/posix/sysconf.c: Handle new symbols.
	* sysdeps/stub/sysconf.c: Ditto.
	* sysdeps/unix/sysv/linux/sysconf.c: Removed.  Generic version
	is ok now.

	* sunrpc/rpc/xdr.h: Move definition of type `xdrproc_t' to
	have real prototype.

	* sysdeps/generic/resourcebits.h: Add macro definition for
	RLIMIT_* values.  Some sources test using #ifdef whether specific
	limit is available.
	* sysdeps/unix/bsd/sun/sunos4/resourcebits.h: Ditto.
	* sysdeps/unix/sysv/linux/resourcebits.h: Removed.  We need
	separate files for the architectures.
	* sysdeps/unix/sysv/linux/alpha/resourcebits.h: New file.
	* sysdeps/unix/sysv/linux/i386/resourcebits.h: New file.
	* sysdeps/unix/sysv/linux/m68k/resourcebits.h: New file.
	* sysdeps/unix/sysv/linux/mips/resourcebits.h: New file.

	* sysdeps/posix/getdtsz.c: Rewrite to use `__getrlimit' function
	and only default on `OPEN_MAX'.
	* sysdeps/unix/sysv/sysv4/getdtsz.c: Removed.  Default is already
	the POSIX version.

	* time/Makefile (routines): Add ctime_r.
	* time/asctime.c: Add implementation of `asctime_r'.  Make
	`asctime' implementation based on reentrant version.
	* time/ctime_r.c: New file.
	* time/time.h [__USE_REENTRANT]: Add definition of `asctime_r'
	and `ctime_r'.

Sat Aug  3 18:41:36 1996  Andreas Schwab  <schwab@issan.informatik.uni-dortmund.de>

	* locale/C-ctype.c (_nl_C_LC_CTYPE_toupper): Fix EOF entry.
	(_nl_C_LC_CTYPE): Fix ordering.
	* locale/categories.def (LC_CTYPE): Add missing ctype-class32; fix
 	typo.

Sat Aug  3 12:31:06 1996  Richard Henderson  <rth@tamu.edu>

	* csu/initfini.c: Discover the maximum alignment generated by the
	compiler when emitting a function.
	(_init): Make sure the end of the crti fragment is aligned.
	(_fini): Likewise.

Fri Aug  2 03:12:40 1996  Ulrich Drepper  <drepper@cygnus.com>

	* initfini.c: (__libc_is_static): New variable.  Will be
 	initialized in init-first.c.  Some actions in the libc work
 	different when libc is static or dynamic.

	* sysdeps/unix/sysv/linux/init-first.c (init): Use
 	`__libc_is_static' variable to determine whether call to
 	`personality' and `setfpucw' is necessary.  When done set variable
 	to +-1 depending on library type.

	* locale/setlocale.c (setlocale): Use global variable
 	`__libc_enable_secure' instead of calling `get{,e}{g,u}id()' to
 	determine whether it's a SET[UG]ID program.

Fri Aug  2 14:40:22 1996  Roland McGrath  <roland@fast.cs.utah.edu>

	* Version 1.93 test release.

	* manual/Makefile: Use -include for chapters-incl too.

	* Makeconfig (+link): Add back start.o, mistakenly removed in last
	change.

Fri Aug  2 01:04:02 1996  Roland McGrath  <roland@delasyd.gnu.ai.mit.edu>

	* nss/Makefile (generated): Add db-*.c.

	* sysdeps/i386/sysdep.h: Get generic/sysdep.h explicitly instead of
	using #include_next.

	* configure.in (--enable-add-ons): Quote m4 macro args.

	* elf/rtld.c (dl_main): For --verify, fail if no dynamic section.

Thu Aug  1 14:40:03 1996  Roland McGrath  <roland@fast.cs.utah.edu>

	* sunrpc/Makefile [$(cross-compile)=no]: Test before making librpcsvc.

	* Makerules (build-shlib): Add -B$(csu-objpfx) to find crt[in].o there.

	* Makeconfig (+preinit, +postinit): Prepend $(csu-objpfx) here.
	(+link): Not here.

	* stdio-common/_itoa.h (_itoa_word): Declare unused to suppress
	warning when inline function is elided.
	* sysdeps/i386/dl-machine.h (elf_machine_matches_host): Likewise.
	(elf_machine_runtime_setup): Likewise.
	* elf/dynamic-link.h (elf_get_dynamic_info): Likewise.
	* sysdeps/i386/dl-machine.h (elf_machine_got): Likewise.
	(elf_machine_load_address): Likewise.

	* catgets/gencat.c: Include <locale.h>.

	* sysdeps/unix/mk-local_lim.c (param): Add SYMLOOP_MAX/MAXSYMLINKS.

	* login/logwtmp.c (logwtmp): Call time, not __time.

	* sysdeps/gnu/utmpbits.h (_HAVE_UT_PID): New macro.
	* login/login.c (login): Test [_HAVE_UT_PID] to use ut_pid member.
	* login/logwtmp.c (logwtmp): Likewise.

	* sysdeps/generic/ioctl-types.h (sizeof): Define to 0 around #if
	comparing ioctl macro values.

	* sysdeps/i386/sysdep.h: Do `#include_next <sysdep.h>'.

	* manual/Makefile: Use -include for chapters to suppress warning.

	* sysdeps/stub/socket.c: Fix type of TYPE arg.
	* sysdeps/stub/socketpair.c: Likewise.

	* sysdeps/stub/_exit.c (_exit): Remove obsolete __NORETURN keyword.

	* sysdeps/generic/sysdep.h: New file, broken out of ...
	* sysdeps/unix/sysdep.h: ... here.
	(C_LABEL): Moved out.

	* Makeconfig (soversions.mk): Don't use newfangled ${x%%y} syntax;
	stick to sed.  Do `exit 0' at end because while returns nonzero.

	* sysdeps/i386/sysdep.h: New file, broken out of ...
	* sysdeps/unix/i386/sysdep.h: ... here.  Generic asm macros moved out.

	* sysdeps/stub/stdio_lim.h (L_ctermid, L_cuserid): Macros removed.
	They are defined unconditionally in libio/stdio.h.

	* elf/dl-runtime.c: Include <stddef.h> for `NULL' defn.
	* elf/dl-cache.c: Likewise.

Mon Jul 29 19:20:05 1996  Ulrich Drepper  <drepper@cygnus.com>

	* sysdeps/unix/sysv/linux/Makefile [$(subdir == misc]
	(sysdep_headers): Add sys/sysmacros.h.
	* sysdeps/unix/sysv/linux/sys/sysmacros.h: New file.

Wed Jul 31 14:21:36 1996  Ulrich Drepper  <drepper@cygnus.com>

	* termios/termios.h [__OPTIMIZE__]: Remove "optimization" for
	tcgetattr.  We have weak aliases now.
	* stdlib/stdlib.h [__OPTIMIZE__ && __GNUC__ >= 2]: Remove
	"optimizations" for random functions.

Mon Jul 29 20:33:42 1996  Andreas Schwab  <schwab@issan.informatik.uni-dortmund.de>

	* sysdeps/unix/sysv/linux/netinet/in.h (ntohl, ntohs, htonl,
	htons) [__BIG_ENDIAN]: #undef them before defining to avoid
	redefinition warning.

Mon Jul 29 20:28:27 1996  Andreas Schwab  <schwab@issan.informatik.uni-dortmund.de>

	* time/time.h: Don't optimize tzset() to __tzset() which bypasses
	the __tzset_lock.

Tue Jul 30 15:14:50 1996  Roland McGrath  <roland@delasyd.gnu.ai.mit.edu>

	* sunrpc/rpc/pmap_clnt.h: Fix botched patch for multiple inclusion
	protection.

Tue Jul 30 02:48:28 1996  Ulrich Drepper  <drepper@cygnus.com>

	* locale/loadlocale.c (_nl_load_locale): Change cast to `size_t'
	to be 64-bit clean.
	Reported by Richard Henderson <rth@tamu.edu>.

Tue Jul 30 15:04:50 1996  Roland McGrath  <roland@delasyd.gnu.ai.mit.edu>

	* locale/programs/ld-collate.c (collate_output): Fix typo reported by
	David Miller.

Tue Jul 30 13:23:13 1996  Ulrich Drepper  <drepper@cygnus.com>

	* locale/setlocale.c (setlocale): Don't try to free C locale
	data.
	Reported by Matthias Urlichs.

Tue Jul 30 14:35:17 1996  Miles Bader  <miles@gnu.ai.mit.edu>

	* sysdeps/mach/hurd/dl-sysdep.c	(__open): Use open_file.
 	(open_file): New function, contents mostly from __open.
	(_dl_sysdep_read_whole_file): New function.

Sat Jul 27 11:23:59 1996  Miles Bader  <miles@gnu.ai.mit.edu>

	* sysdeps/mach/hurd/Makefile ($(common-objpfx)errnos.d): Quote
	`..' dots in sed search string.

Mon Jul 29 01:27:07 1996  Roland McGrath  <roland@delasyd.gnu.ai.mit.edu>

	* sunrpc/rpc/rpc_msg.h: Fix botched patch for multiple inclusion
	protection.

Sun Jul 28 23:46:14 1996  Roland McGrath  <roland@delasyd.gnu.ai.mit.edu>

	* configure.in: Grok `--enable-add-ons=DIR1,DIR2,...', and configure
	in those directories.
	* config.make.in (add-ons): New varaible, set from @subdirs@.
	* Makefile (subdirs): Added $(add-ons) at the end.

	* time/strftime.c (strftime: do_number): Initialize PRINTED to
	MAXDIGITS in case P is null and so sprintf is never actually called.

Mon Jul 29 02:46:23 1996  Ulrich Drepper  <drepper@cygnus.com>

	Add support for the to-be-written internationalized regexp.
	This code must be able to use collation symbols and collation
	equivalent classes.
	* locale/C-collate.c (_nl_C_LC_COLLATE_symbol_hash,
	_nl_C_LC_COLLATE_symbol_strings, _nl_C_LC_COLLATE_symbol_classes):
	New global variables for collation classes.
	* locale/categories.def: Add new descriptions for collation symbols
	and collation classes.
	* locale/langinfo.h: Add constants for collation symbols and
	collation classes.
	* locale/lc-collate.c: Add new global variables for collation symbols
	and collation classes.
	(_nl_postload_collate): Initialize new variables.
	* locale/programs/ld-collate.c: Add code to emit tables for
	collation symbols and collation classes.
	* locale/programs/locales.h: Change prototype for `collate_output'.
	* locale/programs/locfile.c (write_all_categories): Call
	`collate_output' with new argument.
	* locale/localeinfo.h: Add declaration for new global vars.
	(union locale_data_value): New member wstr for `wchar_t' strings.
	* locale/programs/locale-spec.c: Handle `collate-classes'
	keyword and print information about available collation classes.
	* locale/strlen-hash.h: New file.  Simple hashing function which
	takes a string with known length.
	* locale/Makefile (distribute): Add strlen-hash.h.
	(locale-modules): New var.  Additional files for `locale' program.

	* locale/C-ctype.c: Rewrite to avoid using string for giving values
	which are of type `u_int32_t'.
	Correct entry for EOF in toupper and tolower tables.

	* locale/loadlocale.c (_nl_load_locale):  Add cast to prevent
	warning.

	* locale/programs/ld-ctype.c (ctype_output): Add code to make
	sure that all tables in binary file are word-aligned.

	* locale/programs/locfile.c (write_locale_data): Correct handling
	of LC_MESSAGES locale.  Create directory if necessary.

	* locale/setlocale.c (setlocale): Add cast to avoid warning.

	* string/string.h: Add prototype for `__strndup'.

Wed Jul 24 19:10:00 1996  Andreas Schwab  <schwab@issan.informatik.uni-dortmund.de>

	* wcsmbs/mbrtowc.c: Remove unused variable.

Sun Jul 28 22:40:25 1996  Roland McGrath  <roland@delasyd.gnu.ai.mit.edu>

	* sysdeps/unix/sysv/linux/configure.in (LIBC_LINUX_VERSION): Update to
	2.0.10; some problems were reported with an earlier version, and this
	one is known to work.

	* sysdeps/generic/dl-sysdep.c (__libc_enable_secure): New variable.
	* sysdeps/mach/hurd/dl-sysdep.c: Likewise.

Sat Jul 27 13:02:09 1996  Ulrich Drepper  <drepper@cygnus.com>

	* elf/rtld.c (dl_main): Ignore arguments when environment variable
 	LD_TRACE_LOADED_OBJECTS is set.

Sun Jul 28 19:42:51 1996  Roland McGrath  <roland@delasyd.gnu.ai.mit.edu>

	* sysdeps/generic/dl-sysdep.c (_dl_sysdep_start): Initialize
	__libc_enable_secure instead of _dl_secure.
	* sysdeps/mach/hurd/dl-sysdep.c (_dl_sysdep_start): Likewise.
	* elf/dl-load.c (_dl_map_object): Check __libc_enable_secure instead
	of _dl_secure.
	* elf/Makefile (routines): Add enbl-secure.
	(elide-routines.so): Here too.
	* sysdeps/generic/enbl-secure.c: New file.
	* posix/unistd.h [__USE_GNU]: Declare `__libc_enable_secure' flag.
	* elf/dl-support.c (_dl_secure): Variable removed.
	* elf/rtld.c: Likewise.  Replace all uses with __libc_enable_secure.

Sun Jul 28 19:26:40 1996  David S. Miller  <dm@neteng.engr.sgi.com>

	* sysdeps/mips/dl-machine.h (ELF_MACHINE_RUNTIME_TRAMPOLINE):
	Declare _dl_runtime_resolve with __attribute__ ((unused)) so the
	compiler doesn't elide it.
	(elf_machine_rel): Follow Jul 14 change in sysdeps/i386/dl-machine.h.

Sat Jul 27 02:58:49 1996  Roland McGrath  <roland@delasyd.gnu.ai.mit.edu>

	* elf/rtld.c (dl_main): Take new option --verify when run directly.
	In verify mode, exit with status zero iff the argument object's
	PT_INTERP matches argv[0].
	* elf/ldd.sh.in: Use ${RTLD} --verify and only run the program if it
	exits with zero status.  This makes `ldd' secure again.

Fri Jul 26 22:49:58 1996  Ulrich Drepper  <drepper@cygnus.com>

	* elf/rtld.c (dl_main): Implement LD_TRACE_LOADED_OBJECTS
	environment variable handling.  This makes the dynamic linker
	only print loaded libraries and quit.

	* elf/ldd.sh.in: Don't use `rtld --list' but instead
	LD_TRACE_LOADED_OBJECTS environment variable to print needed
	objects.

Sat Jul 27 02:03:26 1996  Roland McGrath  <roland@delasyd.gnu.ai.mit.edu>

	* db/makedb.c (main): Print version on stdout, not stderr.  Don't exit
	after printing version until after doing usage for --help.
	(long_options, main, usage): Rename -l/--lowercase option to
	-f/--fold-case (-f matches sort).

Sat Jul 27 04:32:31 1996  Ulrich Drepper  <drepper@cygnus.com>

	* db/makedb.c: New file.  Implement program to create simple <db.h>
	database from textual input.  This will be used for nss_db.

Sat Jul 27 01:24:05 1996  Roland McGrath  <roland@delasyd.gnu.ai.mit.edu>

	* sunrpc/rpc/auth_unix.h: Fix misapplied patches in last changes.
	* sunrpc/rpc/pmap_clnt.h: Likewise.
	* sunrpc/rpc/auth.h: Likewise.
	* sunrpc/rpc/pmap_rmt.h: Likewise.
	* sunrpc/rpc/rpc_msg.h: Likewise.

Sat Jul 27 04:37:34 1996  Ulrich Drepper  <drepper@cygnus.com>

	* string/string.h (strndupa): Change to use return value of
	`memcpy' for more performance.
	* string/strndup.c: Likewise.

	* string/string.h (strdupa): Don't call __builtin_alloca in argument.
	This might lead to problems.
	(strndupa): Likewise.

Fri Jul 26 15:24:25 1996  Ulrich Drepper  <drepper@cygnus.com>

	* sunrpc/rpc/auth.h: Add protection against multiple inclusion
	and change K&R prototypes to ANSI prototypes.
	* sunrpc/rpc/auth_unix.h: Ditto.
	* sunrpc/rpc/clnt.h: Ditto.
	* sunrpc/rpc/pmap_clnt.h: Ditto.
	* sunrpc/rpc/pmap_prot.h: Ditto.
	* sunrpc/rpc/pmap_rmt.h: Ditto.
	* sunrpc/rpc/rpc_msg.h: Ditto.
	* sunrpc/rpc/svc.h: Ditto.
	* sunrpc/rpc/svc_auth.h: Ditto.
	* sunrpc/rpc/xdr.h: Ditto.

Fri Jul 26 20:39:42 1996  Roland McGrath  <roland@delasyd.gnu.ai.mit.edu>

	* ctype/test_ctype.c: Test EOF too.

Fri Jul 26 18:06:58 1996  Ulrich Drepper  <drepper@cygnus.com>

	* sunrpc/rpc/auth.h: Add __BEGIN_DECLS and __END_DECLS.
	* sunrpc/rpc/auth_unix.h: Likewise.
	* sunrpc/rpc/clnt.h: Likewise.
	* sunrpc/rpc/netdb.h: Likewise.
	* sunrpc/rpc/pmap_clnt.h: Likewise.
	* sunrpc/rpc/pmap_prot.h: Likewise.
	* sunrpc/rpc/rpc_msg.h: Likewise.
	* sunrpc/rpc/svc.h: Likewise.
	* sunrpc/rpc/svc_auth.h: Likewise.
	* sunrpc/rpc/xdr.h: Likewise.

	* sunrpc/rpc/pmap_clnt.h: Move definition of type `resultproc_t'
	to here from...
	* sunrpc/pmap_rmt.c: ...here.

Fri Jul 26 16:10:43 1996  Miles Bader  <miles@gnu.ai.mit.edu>

	* login/pututline_r.c (pututline_r): Only call getutid_r if ID has a
	valid ut_id field.
	* login/getutid_r.c (getutid_r): Mark UTMP_DATA->loc_utmp invalid
	if a search fails.

Fri Jul 26 00:36:50 1996  Roland McGrath  <roland@delasyd.gnu.ai.mit.edu>

	* sysdeps/mips/dl-machine.h: New file, contributed by Kazumoto Kojima
	<kkojima@info.kanagawa-u.ac.jp>.

Fri Jul 26 04:41:28 1996  Ulrich Drepper  <drepper@cygnus.com>

	* intl/libintl.h: Define optimizing macros if __OPTIMIZE__ is
	defined, not __OPTIMIZED.
	(_nl_msg_cat_cntr): Move declaration outside macro definition
	to prevent "nested extern" warning.
	(dcgettext): Rename local variable `result' to `__result'.

Thu Jul 25 22:46:30 1996  Roland McGrath  <roland@delasyd.gnu.ai.mit.edu>

	* locale/programs/localedef.c (__progname): Remove decl.
	(main): Use program_invocation_short_name instead of __progname.
	(usage): Use program_invocation_name instead of __progname.

Fri Jul 26 03:46:08 1996  Ulrich Drepper  <drepper@cygnus.com>

	* catgets/gencat.c: Use "libc" instead of PACKAGE.
	* locale/localedef.c: Ditto.
	* locale/locale.c: Ditto.

	* locale/findlocale.c (_nl_find_locale): Little optimization.
	Use new function `strndup'.

	* locale/loadlocale.c: Little optimization.  Use constant value
	from `_nl_category_num_items' instead of byte-order dependend
	value from file.

	* locale/programs/ld-time.c (time_add): Correct string constant.

	* locale/programs/locale-spec.c: New file.
	* locale/programs/locale.c: Call `locale_special' function if
	no other field matches.

	* locale/programs/localedef.c: No need to define `program_name'.
	Use global variable `__progname'.

	* locale/programs/locfile.c (write_locale_data): Always write
	LC_MESSAGES data in LC_MESSAGES/SYS_LC_MESSAGES file.  This is
	necessary since message catalogs are also installed in the
	LC_MESSAGES/ directory.

	* locale/programs/stringtrans.c (ADDC): Correctly use `encode_char'
	function instead of writing single bytes.
	(encode_char): Also handle little endian.

	* locale/setlocale.c (new_composite_name): Little optimization.
	Use return value of `memcpy'.

	* misc/ttyent.h: Pretty print prototypes, add missing parameter
	names, prepend parameter names with __  and use `__const' instead
	of `const'.
	* posix/unistd.h: Ditto.
	* stdlib/stdlib.h: Ditto.
	* string/string.h: Ditto.

	* posix/getconf.c: De-ASNI-fy.  Recognize POSIX.2 constant names.
	Use `error' function instead of doing it by hand.
	* sysdeps/posix/sysconf.c: De-ANSI-fy.
	Handle _SC_COLL_WEIGHTS_MAX.
	* sysdeps/stub/sysconf.c: Handle _SC_CHARCLASS_NAME_MAX,
	_SC_COLL_WEIGHTS_MAX, _SC_EQUIV_CLASS_MAX, _SC_2_LOCALEDEF
	since these do depend on the platform.
	Add POSIX.4 symbols.

	* posix/posix2_lim.h: Add missing definition of
	_POSIX2_COLL_WEIGHTS_MAX.
	Change _POSIX2_EQUIV_CLASS_MAX and _POSIX2_CHARCLASS_NAME_MAX
	to high values since we have no fixed limit.

	* sysdeps/generic/confname.h: Add _SC_PAGE_SIZE as alias for
	_SC_PAGESIZE for buggy systems (= HP UX) out there.

	* wcsmbs/Makefile (routines): Add mbsnrtowcs and wcsnrtombs.
	* wcsmbs/mbsnrtowcs.c: New file.  Non-standard implementation.
	* wcsmbs/wcsnrtombs.c: Ditto.
	* wcsmbs/wchar.h [__USE_GNU]: Add prototypes for mbsnrtowcs and
	wcsnrtombs.

Thu Jul 25 00:25:54  Richard Henderson  <rth@tamu.edu>

	* nss/nss_db/db-XXX.c: Kill trailing ; from lock defn as a matter of
	course.
	* nss/getXXent_r.c: Likewise.
	* nss/nsswitch.c: Likewise.
	* nss/nss_files/files-XXX.c: Likewise.
	* sysdeps/mach/hurd/dirstream.h (struct __dirstream): Likewise.
	* sysdeps/unix/bsd/telldir.c (struct record): Likewise.
	* sysdeps/unix/dirstream.h (struct __dirstream): Likewise.

Thu Jul 25 00:53:06 1996  Roland McGrath  <roland@delasyd.gnu.ai.mit.edu>

	* sysdeps/unix/sysv/linux/configure.in (LIBC_LINUX_VERSION): New
	macro, now put the needed Linux version just once, here; update to
	needing linux-2.0.3 headers.
	(libc_cv_linuxVER): New macro derived from that.
	(kernel header check): Use those macros and some m4 magic to replace
	hard-coded `201' and `2.0.1' in several places.

	* Makerules ($(libdir)/libc.so): Fix typos in generated comment.

Wed Jul 24 17:02:30 1996  Ulrich Drepper  <drepper@cygnus.com>

	* time/localtime.c: Move lock variable declaration to end of
	variable declarations since if is a dummy macro the ; at the
	end terminates the variable section of the function.

	* time/tzset.c: Undefine `tzset' before function declaration.
	Use `weak_function' macro instead of `weak_symbol'.

Wed Jul 24 18:57:33 1996  Ulrich Drepper  <drepper@cygnus.com>

	* stdlib/strtouq.c: Additional weak alias is `strtoull', not
	`strotull'.

Wed Jul 24 18:26:23 1996  Ulrich Drepper  <drepper@cygnus.com>

	* locale/C-ctype.c: Increment number of fields after change
	from Wed Jun 19 03:24:58 1996.

Tue Jul 23 18:13:37 1996  Roland McGrath  <roland@delasyd.gnu.ai.mit.edu>

	* sysdeps/mach/hurd/Makefile (rpcuserlibs): New variable.
	($(common-objpfx)libc.so): Move deps into that, use it.
	[$(subdir) = elf] ($(objpfx)librtld.so): Depend on
	$(rpcuserlibs:.so=_pic.a).
	* elf/Makefile ($(objpfx)librtld.so): Just depend on libc_pic.a; don't
	use $(LDLIBS-c.so).

Thu Jul 18 21:41:25 1996  Andreas Schwab  <schwab@issan.informatik.uni-dortmund.de>

	* sysdeps/generic/stpncpy.c: Fix semantics to make `stpncpy (d, s,
 	n)' equivalent to `strncpy (d, s, n), d += strnlen (d, n)'.

Tue Jul 23 02:49:58 1996  Ulrich Drepper  <drepper@cygnus.com>

	* locale/iso-4217.def: Add India to comment for symbol "INR ".
	Reported by Raja R Harinath  <harinath@cs.umn.edu>.

Sat Jul 20 14:03:45 1996  Andreas Schwab  <schwab@issan.informatik.uni-dortmund.de>

	* sysdeps/m68k/dl-machine.h (elf_machine_rela): Remove bogus
	#undef RESOLVE.

Sun Jul 21 06:48:38 1996  Roland McGrath  <roland@delasyd.gnu.ai.mit.edu>

	* time/tzset.c: Include <libc-lock.h>.
	(__tzset_lock): New lock variable.
	(tzset): New function (weak defn), no longer weak alias for __tzset.
	Call __tzset while holding __tzset_lock.
	* time/localtime.c: Include <libc-lock.h>.
	(__localtime_r): Hold __tzset_lock while doing the work.

	* sysdeps/generic/setenv.c (__environ): Change conditional for #define
	from [!HAVE_GNU_LD] to [!_LIBC].
	[_LIBC]: Include <libc-lock.h> and define a lock.
	(LOCK, UNLOCK): New macros, no-ops for [! _LIBC].
	(setenv, unsetenv): Use them.

Sun Jul 21 01:44:39 1996  Miles Bader  <miles@gnu.ai.mit.edu>

	* locale/programs/locfile.c (write_locale_data): Deal with missing
	UIO_MAXIOV.

	* sysdeps/mach/hurd/socket.c (socket): Make TYPE an int.
	* sysdeps/mach/hurd/socketpair.c (socketpair): Likewise.

Sat Jul 20 21:55:31 1996  Roland McGrath  <roland@delasyd.gnu.ai.mit.edu>

	Win32 hacks from <Rob_Tulloh@tivoli.com>.
	* posix/glob.c [WIN32]: Don't include <pwd.h>; don't use d_ino;
	use void * for my_realloc; include <malloc.h> for alloca.
	(glob) [WIN32]: Use "c:/users/default" for ~ if no HOME variable.
	* posix/fnmatch.h [WIN32]: Use prototypes even if [!__STDC__].
	* posix/glob.h: Likewise.

Sat Jul 20 13:28:52 1996  Miles Bader  <miles@gnu.ai.mit.edu>

	* sysdeps/mach/hurd/select.c (__select): Don't poll on the last
	call __io_select unless there's only a single descriptor, as each
	descriptor now has its own reply port.
	If there is only a single descriptor, just use its reply port for
	everything and don't bother creating the port set.

	* sysdeps/mach/hurd/uname.c (uname): Deref UNAME to get nodename.
	<unistd.h>: New include.

	* sysdeps/mach/libc-lock.h (__libc_lock_define): Backslashify
	continuation line.

Sat Jul 20 07:15:33 1996  Roland McGrath  <roland@delasyd.gnu.ai.mit.edu>

	* crypt/Makefile, crypt/nocrypt.c: Removed.  It is illegal to export
 	from the USA any software that even makes it easy to drop in an
 	encryption module of foreign origin.
	* Makerules (cryptobjdir): Variable removed.
	($(libdir)/libc.so): Remove dep on libcrypt.so$(libcrypt.so-version).
	* Makefile (subdirs): Remove crypt.

Fri Jul 19 15:45:20 1996  Ulrich Drepper  <drepper@cygnus.com>

	* locale/C-messages.c (_nl_C_LC_MESSAGES): Add missing Kleene
	operator to yesexpr and noexpr string.

Fri Jul 19 15:10:37 1996  David Mosberger-Tang  <davidm@azstarnet.com>

	* sunrpc/xdr_mem.c (xdrmem_putlong): Don't cast LP to int32 (the
 	old code would have failed on a big-endian 64-bit architecture).
	* sunrpc/xdr_stdio.c (xdrstdio_putlong): Ditto.

	* sunrpc/xdr.c (xdr_int): Handle XDR_FREE case.
	(xdr_u_long): Use switch instead of chain of if-statements.
  	Remove gratitous parentheses around return expressions.
	(xdr_enum): Open code case where INT_MAX<LONG_MAX.

	* sunrpc/svc.c (svc_getreqset): Increment SOCK by 32, not NFDBITS.

	* sunrpc/portmap.c (reg_service): Declare ANS and PORT as long,
 	not int.

Fri Jul 19 16:56:41 1996  Roland McGrath  <roland@delasyd.gnu.ai.mit.edu>

	* dlfcn.h, db.h: New wrapper headers.

	* posix/glob.h [!_AMIGA && !VMS]: Check this instead of just [!_AMIGA]
	for `struct stat;' forward decl.

Fri Jul 19 22:25:19 1996  Ulrich Drepper  <drepper@cygnus.com>

	* locale/iso-4217.def: Add some more standardized currency
	symbols.

Fri Jul 19 13:18:02 1996  Roland McGrath  <roland@delasyd.gnu.ai.mit.edu>

	* hurd/report-wait.c (describe_number): Use unsigned long int for J.

Thu Jul 18 12:33:57 1996  Roland McGrath  <roland@baalperazim.frob.com>

	* Rules (dummy.o, empty.o): Targets removed.
	(dummy.c, empty.c): New targets replace them.

Thu Jul 18 11:42:39 1996  Roland McGrath  <roland@delasyd.gnu.ai.mit.edu>

	* crypt/Makefile (lib-noranlib): Depend on
	$(objpfx)libcrypt.so$(libcrypt.so-version).
	(subdir): Fix name.

Thu Jul 18 04:33:21 1996  Roland McGrath  <roland@baalperazim.frob.com>

	* sysdeps/mach/hurd/errnos.awk: Move EWOULDBLOCK check before errno==0
	check.  mib's clueless hacking broke it.

Thu Jul 18 04:27:21 1996  Roland McGrath  <roland@delasyd.gnu.ai.mit.edu>

	* Makerules ($(libdir)/libc.so): Add missing / after $(cryptobjdir).

Wed Jul 17 10:54:20 1996  David Mosberger-Tang  <davidm@azstarnet.com>

	* misc/sys/ustat.h: New file.
	* misc/ustat.h: Ditto.
	* sysdeps/generic/ustatbits.h: Ditto.
	* sysdeps/stub/ustat.c: Ditto.
	* sysdeps/unix/sysv/linux/ustatbits.h: Ditto.
	* misc/Makefile (headers): Mention ustat.h, sys/ustat.h, and
 	ustatbits.h.
	(routines): Mention ustat.

	* sysdeps/unix/sysv/linux/alpha/start.S: Move to ...
	* sysdeps/alpha/elf/start.S: here.

	* sysdeps/unix/sysv/linux/syscalls.list: Mention klogctl in
 	alphabetically correct place.  Mention ustat.

	* sysdeps/unix/alpha/sysdep.S: Make errno a bss symbol, not a
	common symbol (makes errno accessible from gdb).

	* login/pututline_r.c (pututline_r): Test ut_id in repositioning
	test, not ut_type.

	* login/logwtmp.c (logwtmp): Reimplemented.  Must ensure that a
 	record always gets appended at end of file (wtmp is a log file,
 	after all).  Set ut_type to DEAD_PROCESS if name is empty.

	* login/getutid_r.c (getutid_r): Handle search for UT_TYPE in
	separate loop from search for UT_ID.  Fix code so it is in
	sync with Unix man page.

	* login/getutline_r.c (getutline_r): Stop searching only if
 	ut_line matches and type is either USER_PROCESS or LOGIN_PROCESS.

Tue Jul 16 15:06:18 1996  David Mosberger-Tang  <davidm@azstarnet.com>

	* sysdeps/unix/sysv/linux/netinet/in.h: Base on <linux/in.h> to
 	avoid duplicate declarations.

Sun Jul 14 19:08:55 1996  David Mosberger-Tang  <davidm@azstarnet.com>

	* manual/maint.texi (Supported Configurations): Add alpha-gnu-linux
	and alpha-gnu-linuxecoff targets.

Fri Jul 12 16:58:44 1996  David Mosberger-Tang  <davidm@azstarnet.com>

	* sysdeps/unix/sysv/linux/netinet/in.h: Declare bindresvport().

Sat Jun 22 23:30:07 1996  David Mosberger-Tang  <davidm@azstarnet.com>

	* resolv/res_send.c (res_send): Declare FROMLEN as size_t instead
	of int.

	* resolv/res_comp.c (res_hnok): Use empty statement in place
	of NULL (which generates a "useless expression" warning in
	gcc).

Wed Jul 17 23:56:35 1996  Roland McGrath  <roland@baalperazim.frob.com>

	* sysdeps/mach/hurd/Makefile ($(common-objpfx)errnos.d): Replace ../
	with $(..) in output.

Wed Jul 17 21:53:45 1996  Roland McGrath  <roland@delasyd.gnu.ai.mit.edu>

	* elf/Makefile (dl-routines): Add dl-cache.
	* elf/dl-cache.c: New file.
	* elf/dl-load.c (_dl_map_object): Check cache before default path.

Wed Jul 17 20:41:30 1996  Ulrich Drepper  <drepper@cygnus.com>

	* stdio-common/vfscanf.c: Major change.  Now read character
	from stream only if needed.  Before it was read after the
	previous character was used.
	Bug reported by Martin Goik <goma0002@FH-Karlsruhe.DE>

	* stdio-common/tstscanf.c: Change test program so that return
	value is != 0 if one test failed.

Wed Jul 17 17:08:48 1996  Roland McGrath  <roland@delasyd.gnu.ai.mit.edu>

	* sysdeps/m68k/Makefile (crypt): Variable removed.
	* sysdeps/sparc/Makefile: Likewise.

	* version.h (VERSION): Update to 1.93.

	* Makerules ($(libdir)/libc.so): Depend on
	$(common-objpfx)libcrypt.so$(libcrypt.so-version).

	* crypt/nocrypt.c: New file.
	* Makefile (subdirs): Add crypt.
	* crypt/Makefile: New file.

	* Makerules (soversions.mk): Move this target, include of it, and
	include of version.mk to ...
	* Makeconfig: ... here.
	(soversions.mk): Depend on Makeconfig instead of Makerules.

	* shlib-versions (*-*-*): Set libcrypt=0.

Wed Jul 17 11:29:26 1996  Miles Bader  <miles@gnu.ai.mit.edu>

	* stdio/linewrap.c (lwupdate): Fix boundary condition where a
 	word extends right up to rmargin.

	* stdio/linewrap.c (lwupdate): When we've done a word wrap and
	output the wrap margin, set point_col to wmargin.
	Use negative point_col to deal with a wmargin of 0.
	(line_wrap_point): Return 0 for a negative point_col.
	(line_wrap_stream): Make wmargin ssize_t.
	* stdio/linewrap.h (struct line_wrap_data): Make wmargin &
 	point_col ssize_t.
	(line_wrap_stream): Make wmargin ssize_t.
	(line_wrap_point): Return 0 for a negative point_col.

Wed Jul 17 02:43:28 1996  Roland McGrath  <roland@delasyd.gnu.ai.mit.edu>

	* shlib-versions (*-*-gnu*): Set libc=0.0

Tue Jul 16 01:52:42 1996  Andreas Schwab  <schwab@issan.informatik.uni-dortmund.de>

	* sysdeps/m68k/dl-machine.h: Follow Jul 14 change in
	sysdeps/i386/dl-machine.h.

Tue Jul 16 00:18:19 1996  Miles Bader  <miles@gnu.ai.mit.edu>

	* stdio/linewrap.c (__line_wrap_update): Add hackery from flshfp
 	to fiddle __put_limit in conjunction with __linebuf_active.

Tue Jul 16 00:14:07 1996  Andreas Schwab  <schwab@issan.informatik.uni-dortmund.de>

	* sysdeps/unix/inet/syscalls.list (connect, send): Add underscores
	to the strong name, not the file name.

Tue Jul 16 16:43:58 1996  Roland McGrath  <roland@delasyd.gnu.ai.mit.edu>

	* csu/initfini.c: More magic.  Detect if .end is produced and put it
	in the output iff the compiler does.

	* elf/dl-lookup.c (_dl_lookup_symbol): Avoid sizeof dynamic auto array
	because that is broken on alpha.

	* sysdeps/mach/hurd/mmap.c: Use same inheritance arg in second vm_map
	call as in first.

	* Makerules (make-link): Install the new link with atomic mv -f in
	case ln itself requires the library being installed.

Tue Jul 16 00:31:31 1996  Richard Henderson  <rth@tamu.edu>

	* sysdeps/alpha/dl-machine.h: Mirror Roland's changes to
	i386/dl-machine.h of 960713.

	* sysdeps/generic/dl-sysdep.c:  Include <sys/mman.h>.
	(_dl_sysdep_read_whole_file): Fix result variable declaration.

Tue Jul 16 00:53:57 1996  Roland McGrath  <roland@delasyd.gnu.ai.mit.edu>

	* sysdeps/mach/hurd/uname.c: Call __gethostname to fill in the
	`nodename' member.

Mon Jul 15 17:23:53 1996  Ulrich Drepper  <drepper@cygnus.com>

	* stdio-common/vfprintf.c (vfprintf): Call parse_one_spec
	with pointer to local variable instead of NULL.

1996-07-15  Paul Eggert  <eggert@twinsun.com>

	* time/strftime.c (strftime): Don't pass empty macro argument to `add'.

Sat Jul 13 09:53:39 1996  Andreas Schwab  <schwab@issan.informatik.uni-dortmund.de>

	* sysdeps/unix/sysv/linux/Makefile (sysdep_routines): Remove names
	that are already added by other means.

	* sysdeps/unix/sysv/linux/syscalls.list: Add more EXTRA's in the
	caller column to get those syscalls added automagically.

Mon Jul 15 12:24:54 1996  Miles Bader  <miles@gnu.ai.mit.edu>

	* login/logout.c (logout): Initialize DATA to a state that will
	make setutent_r happy.

Sun Jul 14 01:51:39 1996  Roland McGrath  <roland@delasyd.gnu.ai.mit.edu>

	* elf/rtld.c (dl_main) [ELF_MACHINE_DEBUG_SETUP]: Use this macro
	instead of setting the DT_DEBUG pointer.

	* csu/initfini.c (_init, _fini): Generate .end directives after
	standalone prologues and filter them out from epilogues.

	* Makeconfig (rtld-installed-name): Set to ld.so.1.
	* sysdeps/unix/sysv/linux/Makefile (rtld-installed-name): Variable
	removed.

	* manual/Makefile (glibc-targets): Remove subdir_ from elts.

	* sysdeps/generic/dl-sysdep.c (_dl_sysdep_read_whole_file): New fn.

	* MakeTAGS (extract): Pass --add-comments=TRANS.
	* sysdeps/gnu/errlist.awk: Write comments into the output with the
	descriptive paragraphs from the manual preceded by TRANS.

	* elf/rtld.c (RESOLVE): Use the dl's load address, not a constant zero!
	(_dl_start): Move RESOLVE defn inside this function and #include
	"dynamic-link.h" a second time there.
	[RTLD_START]: Move use of this after _dl_start function.

	* elf/dl-reloc.c: Include "dynamic-link.h" at file scope.

	* elf/rtld.c: Include <string.h>.

	* elf/dynamic-link.h (ELF_DYNAMIC_DO_REL, ELF_DYNAMIC_DO_RELA,
	ELF_DYNAMIC_RELOCATE): No longer take RESOLVE argument.
	Conditionalize defns on [RESOLVE].
	* elf/do-rel.h (elf_dynamic_do_rel): Likewise.
	* sysdeps/i386/dl-machine.h (elf_machine_rel): Likewise.
	Instead use RESOLVE macro with same args.
	(elf_machine_rel): Conditionalize defn on [RESOLVE].
	* elf/dl-reloc.c (RESOLVE): New macro, define before including
	"dynamic-link.h".  It replaces `resolve' local function.
	* elf/dl-runtime.c: Likewise.
	* elf/rtld.c: Likewise.

	* elf/dl-deps.c (_dl_map_object_deps): Start TAILP at last preload.

	* elf/dl-open.c (_dl_open): Force an indirect call for
	_dl_relocate_object so there is no chance a PLT fixup will be done
	and clobber _dl_global_scope before our call happens.

	* sysdeps/i386/fpu/__math.h (tan): Correct output constraint from =u
	to =t; must operate on top of fp reg stack, not second from top.
	Correct input constraint to 0 from t; must be explicit when input and
	output are the same register.
	(floor): Use __volatile instead of volatile.
	(ceil): Likewise.

	* manual/Makefile ($(objpfx)stamp%-$(subdir)): Separate rule from
	other targets.

Sat Jul 13 23:50:17 1996  Roland McGrath  <roland@delasyd.gnu.ai.mit.edu>

	* manual/Makefile (lib): New phony target.  Depend on stamp files.
	($(objpfx)stamp%-$(subdir)): New rule to create them when necessary.

1996-07-13  Paul Eggert  <eggert@twinsun.com>

	* time/strftime.c (strftime): Use space padding for %e, %k, %l,
	to match Emacs format-time-string specification.
	(DO_NUMBER_SPACEPAD): Renamed from DO_NUMBER_NOPAD.

Sat Jul 13 20:17:38 1996  Roland McGrath  <roland@delasyd.gnu.ai.mit.edu>

	* elf/dl-deps.c (_dl_map_object_deps): Take new args PRELOADS and
	NPRELOADS, vector of `struct link_map *'s; add them to the searchlist
	between MAP and its deps.
	* elf/link.h: Fix decl.
	* elf/rtld.c (dl_main): If not secure, parse LD_PRELOAD for
	colon-separated list of names, map those and pass vector of ptrs as
	PRELOADS list to _dl_map_object_deps.
	* elf/dl-runtime.c (_dl_object_relocation_scope): Pass new args to
	_dl_map_object_deps with empty preload list.
	* elf/dl-open.c (_dl_open): Likewise.

	* sysdeps/mach/hurd/dl-sysdep.c (_dl_sysdep_open_zero_fill): Function
	removed.
	(__mmap): Pass MACH_PORT_NULL for memobj port when (flags & MAP_ANON).
	* sysdeps/generic/dl-sysdep.c (_dl_sysdep_open_zero_fill):
	Conditionalize defn on [! MAP_ANON].
	* elf/dl-minimal.c (malloc): Conditionalize use of _dl_zerofd
	on [! MAP_ANON].
	* elf/rtld.c (dl_main): Likewise.
	* elf/dl-load.c (_dl_zerofd): Conditionalize defn on [! MAP_ANON].
	(_dl_map_object_from_fd): Conditionalize initialization of _dl_zerofd.

	* elf/dl-fini.c (_dl_fini): Skip finalizer for executable itself.

Sat Jul 13 02:47:53 1996  David Mosberger-Tang  <davidm@azstarnet.com>

	* stdlib/random.c (__random): Declare as int32_t to be in sync
	with declaration.

	* socket/Makefile (headers): Add socketbits.h.

	* misc/mntent.c (endmntent): Allow for NULL stream.  SunOS does
	it that way.

	* grp/initgroups.c (initgroups): Add groups that user is a member
 	of, not the ones he is _not_ a member of.

	* nss/nsswitch.c (known_compare): Make known_compare() a static
 	instead of a local function.  The latter are difficult to debug
 	and slow to execute on certain platforms.

	* sysdeps/posix/ttyname_r.c (ttyname_r): Use sizeof (dev) - 1 in
 	place of sizeof (dev).  The size of a literal string includes the
 	NUL byte.

	* sysdeps/unix/getlogin.c (getlogin): Initialize ut_fd with -1.

Thu Jul 11 16:59:10 1996  David Mosberger-Tang  <davidm@azstarnet.com>

	* misc/mntent.c (addmntent): Seek to end of file before writing
 	entry.  Return 1 on error, not -1.

Tue Jul  9 19:08:05 1996  David Mosberger-Tang  <davidm@azstarnet.com>

	* sysdeps/unix/sysv/linux/syscalls.list: Mark bdflush as EXTRA
	syscall.

Fri Jul  5 18:44:55 1996  David Mosberger-Tang  <davidm@azstarnet.com>

	* sysdeps/unix/sysv/linux/alpha/ioperm.c (port_to_cpu_addr): Size
 	shift amount for Jensen must be 5 not 4.

Sat Jul 13 20:04:28 1996  Roland McGrath  <roland@delasyd.gnu.ai.mit.edu>

	* socket/sys/socket.h (struct osockaddr): New type.

Sat Jul 13 03:50:53 1996  Ulrich Drepper  <drepper@cygnus.com>

	* misc/Makefile (routines): Add qefgcvt and qefgcvt_r.
	* misc/efgcvt.c, misc/efgcvt_r.c: Change code so that the `double'
	and `long double' versions can be generated.
	* misc/qefgcvt.c, misc/qefgcvt_r.c: New files.  Define macros
	so that included efgcvt{,_r}.c file generate `long double'
	versions.
	* stdlib/stdlib.h: Add prototypes for q[efg]cvt() and q[ef]cvt_r()
	functions.

	* manual/startup.texi: Document new getsubopt function.
	* manual/examples/subopt.c: New example program for documenting
	getsubopt function.

Fri Jul 12 23:58:37 1996  Ulrich Drepper  <drepper@cygnus.com>

	* stdlib/Makefile (routines): Add getsubopt.
	* stdlib/stdlib.h: Add prototype for getsubopt.
	* stdlib/getsubopt.c: New file.  Implement getsubopt function
	to handle suboption parsing.

Thu Jul 11 20:09:55 1996  Roland McGrath  <roland@delasyd.gnu.ai.mit.edu>

	* inet/getnetent_r.c: Define NEED_H_ERRNO.
	* inet/getnetbynm_r.c: Likewise.
	* inet/getnetent.c: Likewise.
	* inet/getnetbyad_r.c: Likewise.
	* inet/getnetbyad.c: Likewise.
	* inet/getnetbynm.c: Likewise.

	* sysdeps/generic/pselect.c: Include <sys/time.h>.

	* misc/sys/select.h: Include <time.h> instead of <sys/time.h> for
	`struct timespec'.

	* math/Makefile (calls): Add s_frexp, s_ldexp.
	(routines): Remove them and &f from here.

	* sys/socket.h: New file, wrapper for socket/sys/socket.h.

	* nss/nss_files/files-service.c (getservbyname): Take second arg PROTO
	and check it.

	* nss/nss_files/files-XXX.c: Comment fix.

Fri Jul 12 01:28:35 1996  Ulrich Drepper  <drepper@cygnus.com>

	* nss/getXXent_r.c (GETFUNC_NAME_STRING): Define with name
	of reentrant function.
	(setup): Pass additional argument with function name we are
	looking for.
	(SETFUNC_NAME, ENDFUNC_NAME, GETFUNC_NAME): Call setup with
	new argument {SET,END,GET}FUNC_NAME_STRING.

	* nss/getXXent.c (GETFUNC_NAME): RESULT must be static because
	we return a pointer.

Thu Jul 11 18:20:44 1996  Roland McGrath  <roland@delasyd.gnu.ai.mit.edu>

	* nss/nss_files/files-parse.c: Add comment about things to #define.

	* nss/nss_files/files-hosts.c (NEED_H_ERRNO): Define it.

	* nss/nss_files/files-parse.c (STRING_FIELD): Don't flag NUL before
	terminator char as an error.

	* nss/getXXbyYY_r.c (REENTRANT_NAME): Set *H_ERRNOP, not h_errno.

Thu Jul 11 03:21:10 1996  Ulrich Drepper  <drepper@cygnus.com>

	* catgets/gencat.c (write_out): Move code to determine new
	best size out of inner loop.

Thu Jul 11 00:22:40 1996  Ulrich Drepper  <drepper@cygnus.com>

	* sysdeps/libm-ieee754/s_frexpl.c: New file.  `long double'
	implementation of frexp() function.
	* sysdeps/libm-ieee754/s_ldexpl.c: New file.  `long double'
	implementation of ldexp() function.

	* sysdeps/libm-i387/s_isnanl.c (isnanl): Mask explicit one
	out before or'ing.

Wed Jul 10 05:24:40 1996  David Mosberger-Tang  <davidm@azstarnet.com>

	* misc/mntent.c: Include <sys/types.h>.
	(endmntent): Return 1 one success, 0 on failure.
	(getmntent): Chop newline and ignore empty lines.

Mon Jul  8 21:18:40 1996  Andreas Schwab  <schwab@issan.informatik.uni-dortmund.de>

	* sysdeps/m68k/dl-machine.h (RESOLVE): New macro, defined
	differently based on [RTLD_BOOTSTRAP].
	(elf_machine_rela): Use it instead of the fn ptr arg directly.

Tue Jul  9 09:37:55 1996  Roland McGrath  <roland@delasyd.gnu.ai.mit.edu>

	* posix/glob.h (__glob_opendir_hook, __glob_readdir_hook,
	__glob_closedir_hook): Remove decls.

	* sysdeps/generic/machine-gmon.h: Declare mcount_internal.

	* sysdeps/unix/inet/syscalls.list: Define __ names with weak aliases
 	for send and connect syscalls.

	* socket/sys/socket.h: New file, taken from non-sysdep parts of
	linux/sys/socket.h; break sysdeps parts out into socketbits.h.
	Declare __ names for send and connect.
	* sysdeps/generic/socketbits.h: New file.
	* sysdeps/unix/sysv/linux/socketbits.h: New file.
	* sysdeps/unix/sysv/linux/sys/socket.h: File removed.
	* sysdeps/generic/sys/socket.h: File removed.

	* sysdeps/mach/hurd/connect.c: Define __ name and weak alias.
	* sysdeps/mach/hurd/send.c: Likewise.

	* sysdeps/mach/libc-lock.h: New file.
	* sysdeps/unix/readdir.c: Do locking.
	* sysdeps/unix/seekdir.c: Likewise.
	* sysdeps/unix/rewinddir.c:  Likewise.
	* sysdeps/unix/closedir.c: Likewise.
	* sysdeps/unix/bsd/telldir.c: Likewise.
	* sysdeps/mach/hurd/seekdir.c: Likewise.
	* sysdeps/mach/hurd/readdir.c: Likewise.
	* sysdeps/mach/hurd/closedir.c: Likewise.
	* sysdeps/mach/hurd/opendir.c: Initialize the lock.
	* sysdeps/unix/opendir.c: Likewise.
	* sysdeps/mach/hurd/dirstream.h: Include <libc-lock.h>.
	(struct __dirstream): Add lock member using __libc_lock_define.
	* sysdeps/unix/dirstream.h: Likewise.

	* sysdeps/stub/libc-lock.h (__libc_lock_fini): New macro.

	* stdlib/mbstowcs.c: Pass address of pointer to mbsrtowcs.

	* stdlib/wcstombs.c: Use wcsrtombs instead of mbsrtowcs.

Thu Jul  4 01:34:04 1996  Ulrich Drepper  <drepper@cygnus.com>

	* locale/programs/stringtrans.c: Fix typo in copyright.

	* stdio-common/printf-prs.c: Add casts to prevent
        signed<->unsigned warnings.

	* stdio-common/printf-parse.h: Initialize state variable before
	calling mbrlen.
	* stdio-common/printf-prs.c: Don't initialize state variable here.
	* stdio-common/vfprintf.c: Don't initialize state variable.
	(vfprintf): While determining length of multibyte string don't
	try to be clever in determining characters to use for first
	call.

	Add real implementation of multibyte<->wide char conversion
	functions.  The functions always convert between the fixed wide
	char format (ISO 10646 in UCS4) and the UTF8 representation of
	this character set.  Conversion between the currently used
	8bit character set and ISO 10646 will not take place.  This is
	what iconv() is for.
	* wcsmbs/wchar.h (mbstate_t): Define as structure to replace
	dummy definition.
	Add optimized version of `mbrlen' function.
	* wcsmbs/btowc.c (btowc): Restrict range of legal characters
	to 0...0x7f.
	* wcsmbs/wctob.c (wctob): Restrict range of legal characters
	to 0..0x7f.
	* wcsmbs/mbrlen.c: Make mbrlen a weak alias of __mbrlen.
	This is needed in the wchar.h header.
	* wcsmbs/mbrtowc.c: Replace dummy implementation.  Convert UTF8
	encoded character to UCS4.
	* wcsmbs/mbsinit.c: Replace dummy implementation.  Test COUNT
	element of `mbstate_t' for initial state.
	* wcsmbs/mbsrtowcs.c: Replace dummy implementation.  Convert UTF8
	encoded string to UCS4 string.
	* wcsmbs/wcrtomb.c: Replace dummy implementation.  Convert UCS4
	character to UTF8 encoded form.
	* wcsmbs/wcsrtombs.c: Replace dummy implementation.  Convert UCS4
	encoded string to UTF8 encoded form.

Tue Jul  9 06:19:29 1996  Roland McGrath  <roland@delasyd.gnu.ai.mit.edu>

	* sysdeps/unix/sysv/linux/configure.in: Use version number in cache
 	variable name, so new a libc with new requirements won't fail to
 	notice an insufficient Linux version.

	* sysdeps/unix/sysv/linux/direntry.h: New file from David Mosberger.

	* sysdeps/unix/sysv/linux/configure.in: Check for Linux 2.0.1 headers,
	instead of 2.0 headers.

	* sysdeps/mach/hurd/Makefile (stamp-errnos): Uncomment CVS commit cmds.

	* sysdeps/gnu/errlist.awk: Undo mib's bogus changes.  The
	sysdeps/mach/hurd/errnos.awk bug fix was the only correct change.

	* sysdeps/generic/machine-gmon.h [NO_UNDERSCORES]: Declare _mcount
	before using it in lhs of weak_alias.

	* nss/getXXent_r.c (setup): New function, broken out of SETFUNC_NAME.
	Call __nss_lookup when not setting STARTP.
	(SETFUNC_NAME, ENDFUNC_NAME, REENTRANT_GETNAME): Call it to set up for
	function-calling loop.

Tue Jul  9 00:14:52 1996  Michael I. Bushnell p/BSG  <mib@gnu.ai.mit.edu>

	* sysdeps/mach/hurd/ioctls.h (MDMBUF, ECHO, TOSTOP, FLUSHO,
 	PENDIN, NOFLSH): Undefine these at start if they are already
 	defined to avoid collision with termbits.h.
	* sysdeps/generic/termbits.h (ECHO, TOSTOP, NOFLSH): Likewise.
	(MDMBUF, FLUSHO, PENDIN) [__USE_BSD]: Likewise.

Mon Jul  8 13:37:40 1996  Roland McGrath  <roland@delasyd.gnu.ai.mit.edu>

	* math/math.h (_Mfloat_, _Mlong_double_): New macros, defined iff not
	already defined to float, long double.  Use those macros for _Mdouble_
	defns when including mathcalls.h.
	* math/Makefile [$(long-double-fcts) != yes] (CPPFLAGS): Append
	-D_Mlong_double_=double.

	Add more -lm functions to -lc because ldexp uses them.
	* math/Makefile (calls): Add s_finite, s_copysign, s_scalbn, s_modf.
	(routines): Remove s_modf, add s_frexpf, s_ldexpf; all but frexp and
	ldexp have both f and l code, and those have f though not l code.

Mon Jul  8 13:10:50 1996  Michael I. Bushnell p/BSG  <mib@gnu.ai.mit.edu>

	* sysdeps/mach/hurd/errnos.awk: Skip entries where the
 	error is 0.  The "placeholder" entries recently added to
	errno.texi convert to zero since `???/' is at the front of them.
	* sysdeps/gnu/errlist.awk (errnoh): Likewise.

	* sysdeps/stub/setdomain.c (setdomainname): Declare NAME parm
	__const to conform with unistd.h.

	* stdlib/stdlib.h (random): Declare return type to be int32_t.

	* string/argz-delete.c (argz_delete): Use memmove instead of
 	memcpy for possibly overlapping strings.

Mon Jul  8 02:14:25 1996  Roland McGrath  <roland@delasyd.gnu.ai.mit.edu>

	* libc-symbols.h [GCC >= 2.7] (strong_alias, weak_alias): Use extern
	storage class.  GCC gives an error for non-extern data defns with the
	alias attribute.

Mon Jul  8 01:37:34 1996  Michael I. Bushnell, p/BSG  <mib@gnu.ai.mit.edu>

	* string/argz-insert.c (__argz_insert): (__argz_insert): Use
	memmove instead of memcpy for possible overlapping strings.

Mon Jul  8 00:11:15 1996  Roland McGrath  <roland@delasyd.gnu.ai.mit.edu>

	* libc-symbols.h (weak_function): New macro.
	For GCC 2.7+ define as __attribute__ ((weak)).
	* elf/dl-minimal.c: Use weak_function as keyword in function defns
 	instead of weak_symbol (NAME) after the defn.
	* stdlib/strtol.c: Likewise.
	* stdlib/strtod.c: Likewise.
	* sysdeps/mach/hurd/dl-sysdep.c: Likewise.

	* sysdeps/alpha/dl-machine.h (elf_machine_rela) [RTLD_BOOTSTRAP]:
	If this is defined, don't declare _dl_rtld_map as weak, and
	don't check for MAP pointing to it.  RESOLVE is always null in this
	case, so test with #ifdef instead of if.

	* libc-symbols.h (symbol_set_declare): Use weak_extern instead of
	weak_symbol.
	* csu/initfini.c (_init): Likewise.
	* locale/setlocale.c (DEFINE_CATEGORY): Likewise.
	* misc/efgcvt_r.c: Likewise.
	* sysdeps/alpha/dl-machine.h (elf_machine_rela): Likewise.
	* sysdeps/i386/dl-machine.h (elf_machine_rel): Likewise.

	* libc-symbols.h [ASSEMBLER] (weak_symbol): Macro removed.
	It was not used in any assembler code.
	(weak_symbol_asm): Renamed to weak_extern_asm.
	(weak_extern): New macro replaces weak_symbol for weak extern refs;
	define to weak_extern_asm for [!ASSEMBLER].

Sun Jul  7 18:42:06 1996  Roland McGrath  <roland@delasyd.gnu.ai.mit.edu>

	* libc-symbols.h [! ASSEMBLER] [HAVE_WEAK_SYMBOLS] (weak_symbol_asm,
	weak_alias_asm): New macros, renamed from weak_symbol/weak_alias;
	define those now as aliases.
	Change conditional to use __attribute__ syntax for GCC 2.7+, not 2.8+
	[GCC >= 2.7] [HAVE_WEAK_SYMBOLS] (weak_symbol): Do weak_symbol_asm
	after GCC weak attribute decl.

	* sysdeps/gnu/errlist.awk (BEGIN): Initialize associative array ALIAS,
	map EWOULDBLOCK->EAGAIN, EDEADLOCK->EDEADLK.
	(element printer): Check for elt in ALIAS, instead of special case
	for EWOULDBLOCK.

	* io/Makefile (headers): Add sys/vfs.h.
	* io/sys/vfs.h: New file.

	* sysdeps/mach/hurd/jmp-unwind.c (_longjmp_unwind): Don't unlock the
	critical section lock before unlinking dying active resources.
	The unlock just before return is right (i.e. old code unlocked twice).

Sun Jun  2 22:28:43 1996  Miles Bader  <miles@gnu.ai.mit.edu>

	* stdio/linewrap.c (lwupdate): Update D->point_offs when done.
	Use memmove instead of memcpy where overlap is possible (not
 	necessary using current implementation of memcpy, but...).
	(__line_wrap_update): Don't update D->point_offs (lwupdate does it).

Fri May 31 11:48:46 1996  Miles Bader  <miles@gnu.ai.mit.edu>

	* stdio/linewrap.c (lwupdate): New function, mostly was
	__line_wrap_update.  Use POINT_COL field instead of POINT.
	(__line_wrap_output): Use lwupdate.
	(__line_wrap_update): New function.
	(ensure_unwrapped, ensure_wrapped): New functions.
	(line_wrap_set_lmargin, line_wrap_set_rmargin,
	line_wrap_set_wmargin, line_wrap_point): Use __line_wrap_update.

	* stdio/linewrap.h (struct line_wrap_data): Rename POINT field to
	POINT_COL. Add POINT_OFFS field.
	(__line_wrap_update): New decl.
	(line_wrap_set_lmargin, line_wrap_set_rmargin,
	line_wrap_set_wmargin, line_wrap_point): Use __line_wrap_update.

Fri Jul  5 17:34:47 1996  Miles Bader  <miles@gnu.ai.mit.edu>

	* login/logout.c (logout): Do nothing if getutline_r returns ESRCH.

	* login/pututline_r.c (pututline_r): Since we assign RESULT from
	lseek now, check that it's >= 0, not == 0.

Wed Jul  3 13:28:04 1996  Miles Bader  <miles@gnu.ai.mit.edu>

	* login/login.c (login): Make a copy of *UT, fill in various
	fields that we supply (ut_line, ut_type, ut_pid), and use the copy
	in place of UT.

	* login/getutline_r.c (getutline_r): When we return ESRCH, mark
	UTMP_DATA->ubuf invalid (by setting UTMP_DATA->loc_utmp to 0).

Fri Jul  5 12:22:51 1996  Roland McGrath  <roland@delasyd.gnu.ai.mit.edu>

	* hurd/hurdsig.c (_hurd_internal_post_signal): In case of handled
	signal during critical section doing interruptible RPC, if
	_hurdsig_abort_rpcs wants to change thread state, do thread_set_state
	before thread_resume.  If in critical section, pass 0 for SIGNO to
	_hurdsig_abort_rpcs so rpc is interrupted regardless of SA_RESTART.

	* extra-lib.mk: Fix typo in $(extra-libs-others) conditional.

	* sysdeps/unix/sysv/linux/sys/user.h: New file.
	* sysdeps/unix/sysv/linux/Dist: Add it.
	* sysdeps/unix/sysv/linux/Makefile (sysdep_headers): Add sys/user.h.

	* nss/nss_files/files-parse.c (parse_list): Set EOL from LINE if it
	points within DATA->linebuffer; otherwise use all of DATA->linebuffer
	itself, no need to skip past a NUL.

	* nss/nsswitch.h (known_function): Comment fix.
	* nss/nsswitch.c (nss_lookup_function): Rewritten using __tsearch
	directly.  Do the lookup and insertion with a single call, and fill in
	the tree node afterwards if new.
	(known_compare, nss_find_entry, nss_insert_entry): Functions removed.

	* misc/sys/select.h: #define __need_timespec before <sys/time.h> incl.
	(struct timeval): Add bodiless decl for scope.

	* time/time.h (struct timespec): Rename members from `ts_*' to `tv_*'.
  	Move struct timespec defn outside [_TIME_H] so it can be got with
 	#define __need_timespec.

	* time/sys/time.h (TIMEVAL_TO_TIMESPEC): Use `tv_*' instead of `ts_*'
	for `struct timespec' member names.
	(TIMESPEC_TO_TIMEVAL): Likewise.

	* nss/Makefile (extra-libs-others): New variable.

	* extra-lib.mk: Don't test for $($(lib)-no-lib-dep).  Instead match
	$(lib) in $(extra-libs-others).
	* sunrpc/Makefile (extra-libs-others): New variable.
	(librpcsvc-no-lib-dep): Variable removed.

	* elf/rtld.c: Define RTLD_BOOTSTRAP before #include "dynamic-link.h".
	* sysdeps/i386/dl-machine.h (elf_machine_rel): Remove weak decl for
	_dl_rtld_map.
	(RESOLVE): New macro, defined differently based on [RTLD_BOOTSTRAP].
	(elf_machine_rel): Use it instead of testing fn ptr arg at runtime.
	(elf_machine_rel: case R_386_32) [! RTLD_BOOTSTRAP]: Declare
	_dl_rtld_map weak only here.

	* posix/unistd.h [__USE_BSD]: Declare getdomainname, setdomainname.

Thu Jul  4 05:21:59 1996  David Mosberger-Tang  <davidm@azstarnet.com>

	* login/utmp.h: Fix typos.

	* misc/syslog.c (vsyslog): Use __send instead of send and
 	__connect instead of connect to avoid name-space collisions (e.g.,
 	with psgetty).

Wed Jul  3 16:29:41 1996  Roland McGrath  <roland@delasyd.gnu.ai.mit.edu>

	* nss/getXXbyYY_r.c (REENTRANT_NAME): Cast FCT in __nss_next call.

	* sysdeps/generic/sbrk.c: Always call __brk (0) to update __curbrk.

	* malloc/malloc-size.c (malloc_usable_size): Renamed from
	malloc_object_allocation_size.
	* malloc/malloc.h: Fix decl.

	* sys/select.h: New file, wrapper header.

	* posix/sys/types.h [__USE_BSD]: Include <sys/select.h>; remove
	fd_set, associated macros, and select decl.

	* sysdeps/posix/isfdtype.c: New file.

Tue Jul  2 23:45:14 1996  Ulrich Drepper  <drepper@cygnus.com>

	The latest Japanese proposal for POSIX locales renames the
	CHARMAP keyword in locale definition files to CHARCONV.
	* locale/programs/ld-ctype.c, locale/programs/locales.h: Rename
        function ctype_is_charmap to ctype_is_charconv.
	* locale/programs/locfile-kw.gperf: Replace charmap keyword with
        charconv.
	* locale/programs/locfile-token.h: Add definition of token
        charconv.
	* locale/programs/locfile.c: Recognize charconv keyword.  Rename
        lables according to this.

	* locale/weight.h (get_weight): Cast constants to prevent
        warnings.

	* stdlib/strtod.c, stdlib/strtol.c, string/strcoll.c,
	string/strxfrm.c: Add some more casts to prevent signed<->unsigned
	warnings.

	New stuff described in P1003.1g.
	* misc/Makefile (headers): Add sys/select.h.
	(routines): Add pselect.
	* misc/sys/select.h: New file.  Declare select functions and
	needed data types and macros.
	* sysdeps/generic/pselect.c: New file.  Add generic implementation
	of pselect() function which uses select().

	* posix/getconf.c: Recognize new variables from P1003.1g.
	* posix/posix1_lim.h: Define _POSIX_FD_SETSIZE, _POSIX_QLIMIT,
	_POSIX_HIWAT, and _POSIX_UIO_MAXIOV.
	* posix/unistd.h: Add description of the P1003.1g variables.
	* sysdeps/generic/confname.h: Define _SC_* values for new
	variables.
	* sysdeps/posix/fpathconf.c (fpathconf): Add handling of
	_PC_SOCK_MAXBUF.
	* sysdeps/stub/fpathconf.c (fpathconf): Ditto.
	* sysdeps/posix/sysconf.c (sysconf): Add handling of new
	P1003.1g variables.
	* sysdeps/stub/sysconf.c (sysconf): Ditto.
	* sysdeps/unix/sysv/linux/posix_opt.h: Define _POSIX_POLL and
	_POSIX_SELECT since Linux has this.

	* socket/Makefile (routines): Add isfdtype.
	* sysdeps/generic/sys/socket.h: Add prototype for isfdtype.
	* sysdeps/stub/isfdtype.c: New file.  Stub implementation of
	isfdtype.

	* wcsmbs/wcrtomb.c (wcrtomb): Fix typo.

Wed Jul  3 11:26:28 1996  Roland McGrath  <roland@delasyd.gnu.ai.mit.edu>

	* elf/Makefile (LDFLAGS-dl.so): New variable.
	(libdl.so): Depend on eval.so.
	(distribute): Add eval.c.
	* elf/eval.c: New file.

	* time/strftime.c (strftime: do_number): Adjust P and I after sprintf
	in case it wrote fewer than MAXDIGITS chars.

	* stdio/fwrite.c (fwrite: fill_buffer): Separate flushing for last
	newline from flushing full buffer in loop, fix test so no fflush is
	done when last byte written exactly fills the buffer.

	* nss/Makefile ($(services:%=$(objpfx)libnss_%.so)): Depend on libc.so.

	* sysdeps/mach/hurd/Makefile (LDLIBS-c.so): Variable removed.
	(libc.so): Instead, give this deps on lib{mach,hurd}user.so.

	* elf/dl-debug.c (_dl_debug_initialize): Use LDBASE arg instead of
	extracting _dl_rtld_map.l_addr.

	* sysdeps/i386/dl-machine.h (elf_machine_rel): Declare _dl_rtld_map as
	weak.
	* sysdeps/alpha/dl-machine.h (elf_machine_rela): Likewise.

	* shlib-versions (*-*-*): Set libnss_db=1.

Tue Jul  2 10:44:37 1996  Roland McGrath  <roland@delasyd.gnu.ai.mit.edu>

	* elf/rtld.c (dl_main): Set _dl_rtld_map's DT_DEBUG location too.

	* rpm/template (%build): Use @prefix@ instead of always /usr.
	Set up configparms only if @prefix@ is in fact /usr.
	* rpm/Makefile ($(config)): Substitute $(prefix) for @prefix@.

	* elf/Makefile: Add missing endif.

	* nss/nss_files/files-ethers.c (ntohost): Fix db key.

	* nss/nss_files/files-network.c: Pass empty for new DB_LOOKUP args.
	(DATABASE): Define this instead of DATAFILE.
	* nss/nss_files/files-hosts.c: Likewise.
	(hostbyname): Use LOOKUP_NAME macro.

	* nss/nss_db/db-XXX.c: New file.
	* nss/Makefile (services): Add db.
	(libnss_db-inhibit-o): New variable.
	(libnss_db-routines): New variable.
	(distribute): Append db-XXX.c.
	(libnss_db.so): Depend on libdb.so and libnss_files.so.
	($(libnss_db-routines:%=$(objpfx)%.c)): New static pattern rule.

	* nss/nss_files/files-XXX.c (DB_LOOKUP): Add KEYSIZE and KEYPATTERN
	args, ignored.
	(DATAFILE): New macro.
	* nss/nss_files/files-parse.c (GENERIC): If undefined, define to
	"files-XXX.c".
	* nss/nss_files/files-rpc.c: Include GENERIC instead of "files-XXX.c".
	Pass db key args to DB_LOOKUP.
	(DATAFILE): Macro removed.
	(DATABASE): New macro replaces it, lacks "/etc/" prefix.
	* nss/nss_files/files-service.c: Likewise.
	* nss/nss_files/files-pwd.c: Likewise.
	* nss/nss_files/files-proto.c: Likewise.
	* nss/nss_files/files-grp.c: Likewise.
	* nss/nss_files/files-ethers.c: Likewise.

	* elf/linux-compat.c: File removed.
	* elf/Makefile (distribute): Remove linux-compat.c.
	(ld-linux.so.1): Remove target and associated variables.

	* sunrpc/xdr.c: Remove malloc decl.
	* sunrpc/portmap.c: Likewise.

	* sunrpc/svc_tcp.c (abort): Don't declare.  Instead define as macro
	casting abort to fn returning bool_t.

	* nss/nss_files/files-parse.c [EXTERN_PARSER]: Do an extern decl of
	the parser function.
	[EXTERN_PARSER] (LINE_PARSER): Define to empty.
	* nss/nss_files/files-pwd.c (EXTERN_PARSER): Define it.
	* nss/nss_files/files-grp.c: Likewise.

	* Makeconfig (BUILD_CC): If undefined, define to $(CC).

	* sunrpc/rpc/types.h: Include stdlib.h instead of declaring malloc.

	* Makeconfig (built-program-cmd): Use $(rtld-installed-name) in place
	of ld.so so lookups for that soname find it.

	* nss/Makefile (libnss_dns.so): Depend on libresolv.so.
	(resobjdir, LDLIBS-nss_dns.so): Variables removed.

	* pwd/fgetpwent.c: Don't include ../nss/nss_files/files-parse.c to
	define parse_line function.
	(parse_line): #define to _nss_files_parse_pwent and
	add extern decl for that.

	* nss/nss_files/files-XXX.c (internal_getent): Return
	NSS_STATUS_TRYAGAIN for ERANGE error.

	* sysdeps/i386/strtok.S (LreturnNULL): Save current state ptr instead
	of null, so next round returns null again instead of bombing.  Fix
	from drepper.

	* nss/nss_files/files-parse.c (LINE_PARSER): Take new first arg EOLSET.
	Remove ; after `ENTDATA_DECL (data)'.
	Truncate line at strpbrk (line, EOLSET "\n").
	(ENTDATA_DECL): Put ; at end.
	(MIDLINE_COMMENTS): Macro removed.
	* nss/nss_files/files-ethers.c: Pass new argument.
	* nss/nss_files/files-hosts.c: Likewise.
	* nss/nss_files/files-network.c: Likewise.
	* nss/nss_files/files-parse.c: Likewise.
	* nss/nss_files/files-proto.c: Likewise.
	* nss/nss_files/files-rpc.c: Likewise.
	* nss/nss_files/files-service.c: Likewise.
	* grp/fgetgrent.c: Likewise.
	* pwd/fgetpwent.c: Likewise.
	* nss/nss_files/files-pwd.c: Get parse_line with extern decl, since
	fgetpwent.c already defines it.
	* nss/nss_files/files-grp.c: Likewise.

	* elf/dl-load.c (_dl_map_object): Use any object with matching l_name
	as well as any matching with l_libname.  Fix DT_SONAME lookup to use
	string table properly.

	* elf/rtld.c (dl_main): Set _dl_rtld_map.l_name from _dl_argv[0] when
	invoked directly, and l_libname from that if PT_INTERP missing.
	Set l_name from l_libname only if not set from argv.

	* time/europe, time/northamerica: Updated from ADO 96i.

Mon Jul  1 15:44:34 1996  Roland McGrath  <roland@delasyd.gnu.ai.mit.edu>

	* stdio-common/tst-ungetc.c: Include unistd.h.

	* inet/Makefile (routines): Change getnetbypt to getnetbyad.

Mon Jul  1 13:32:42 1996  Miles Bader  <miles@gnu.ai.mit.edu>

	* hurd/report-wait.c (describe_number): Make I unsigned long.

	* login/login.c (login): Only Frob OLD->ut_type if getutline_r
	actually found any entry.

	* login/pututline_r.c (pututline_r): If not located after any
	entry don't use UTMP_DATA->ubuf, and seek to the end before adding.
	Lock the file before stating.

Mon Jul  1 12:29:50 1996  Roland McGrath  <roland@delasyd.gnu.ai.mit.edu>

	* nss/Makefile (databases): Change host to hosts.
	* nss/host-lookup.c: Renamed to nss/hosts-lookup.c.

	* nss/nsswitch.c (nss_parse_service_list): Use const for NAME.

	* nss/nss_files/files-parse.c (parse_list): Correct alignment fixup.

	* string/string.h (strndupa): Pass missing arg to strnlen.

	* inet/getnetbypt_r.c: Renamed to ...
	* inet/getnetbyad_r.c: this; fixed function name.
	* inet/getnetbypt.c: Renamed to ...
	* inet/getnetbyad.c: this; fixed function name.

Sat Jun 29 01:08:35 1996  Andreas Schwab  <schwab@issan.informatik.uni-dortmund.de>

	* grp/getgrgid_r.c (LOOKUP_TYPE): Define to struct group, not
	struct passwd.

Fri Jun 28 23:25:35 1996  Miles Bader  <miles@gnu.ai.mit.edu>

	* login/login.c (login): Initialize DATA so that setutent_r will
 	actually do something.

Fri Jun 28 16:53:01 1996  David Mosberger-Tang  <davidm@azstarnet.com>

	* resolv/res_hconf.c (strndup): Remove function.

	* nss/nsswitch.c (nss_lookup_function): Declare loadbase and ref
	using ElfW() instead of Elf32_*.

	* sysdeps/unix/sysv/linux/alpha/init-first.h,
 	sysdeps/unix/sysv/linux/m68k/init-first.h,
 	sysdeps/unix/sysv/linux/i386/init-first.h: New files.
	* sysdeps/unix/sysv/linux/init-first.c: Use platform-dependent
 	init-first.h to make abstract machine dependent parts of
	initialization.

	* sysdeps/unix/alpha/sysdep.h: Undo PIC-optimization of syscall
	error handling.  It's safer that way.

	* sysdeps/unix/alpha/sysdep.S: Make ldgp part of the prologue.
	Fix by Richard Henderson.

	* sysdeps/alpha/dl-machine.h (elf_alpha_fix_plt): Fix
 	typo/extraneous whitespace.

	* sunrpc/xdr.c (xdr_int, xdr_u_int): Use <limits.h> to test
	determine what integer sizes we're dealing with.

Fri Jun 28 15:46:02 1996  Michael I. Bushnell, p/BSG  <mib@gnu.ai.mit.edu>

	* hurd/hurdsig.c (_hurd_internal_post_signal): In pending signal
	check for signal zero, repair logical sense of test by
	parenthesizing correctly.

	* hurd/hurdsig.c (_hurd_internal_post_signal): In
 	check-for-pending signals code, release _hurd_siglock before
 	jumping to deliver_pending.

Thu Jun 27 04:04:27 1996  David Mosberger-Tang  <davidm@azstarnet.com>

	* configure.in (config_machine): Make ELF the default even for
	Linux/Alpha unless a configuration of the form *-*-linux*ecoff
	is specified.

Fri Jun 28 07:27:10 1996  Roland McGrath  <roland@delasyd.gnu.ai.mit.edu>

	* nss/nss_files/files-hosts.c (ENTDATA): Define it.
	* nss/nss_files/files-parse.c (struct parser_data): Define entdata
	member only #ifdef ENTDATA.
	(ENTDATA_DECL): New macro.
	(LINE_PARSER): Use it for entdata decl.
	(parse_list): Find the space for LIST from DATA->linebuffer instead of
	from the input LINE, which might not be writable buffer space.
	(LINE_PARSER): Use `parser_stclass' in place of `static inline'.
	[ENTDATA] (parser_stclass): #define to `static inline'.
	[!ENDATA] (parser_stclass): #define to empty.
	[!ENTDATA] (parse_line): #define to _nss_files_parse_ENTNAME; the
	function is exported to -lnss_files users.

	* string/strndup.c: Add missing arg.

	* string/string.h (strndupa): Likewise.
	* string/strndup.c (strndup): Always terminate the string.

Thu Jun 27 14:22:31 1996  Andreas Schwab  <schwab@issan.informatik.uni-dortmund.de>

	* stdio/Makefile (routines): Add vscanf.
	* stdio-common/Makefile (routines): Remove vscanf.
	* stdio-common/vscanf.c: Move to ...
	* stdio/vscanf.c: here.

	* rpm/Makefile (headers, install-lib, install-lib.so,
	versioned, install-bin, install-sbin, install-data,
	install-others): Add $(-VARIABLE).

Fri Jun 28 02:41:08 1996  Roland McGrath  <roland@delasyd.gnu.ai.mit.edu>

	* nss/Makefile (databases): New variable.
	(routines, libnss_files-routines): Use it.
	(subdir-dirs): Compute from $(services).

	* sysdeps/unix/sysv/linux/syscalls.list (create_module, delete_module,
	init_module, klogctl): Use EXTRA in the "caller" column so these get
	added to unix-extra-syscalls and thus compiled in misc.

	* string/Makefile (routines): Add strndup.
	* string/strndup.c: New file.
	* string/string.h: Declare strndup.
	(strndupa): New macro.

	* string/string.h: Declare __strdup.
	* string/strdup.c: Deansideclized.  Define __ name and weak alias.

	* string/string.h: Don't define memccpy as macro for [__OPTIMIZE__].

Thu Jun 27 02:49:28 1996  Ulrich Drepper  <drepper@cygnus.com>

	* catgets/gencat.c: Add casts to avoid signed<->unsigned warnings.

	* grp/initgroups.c (initgroups): De-ansi-fy.
	Move declaration of NGROUPS and GROUPS outside #if so that
	the code compiles for NGROUPS_MAX != 0.

	* inet/Makefile (headers): Add netinet/ether.h and netinet/if_ether.h.
	(routines): Add ether_aton, ether_aton_r, ether_hton, ether_line,
	ether_ntoa, ether_ntoa_r, and ether_ntoh.
	* inet/ether_aton.c, inet/ether_aton_r.c, inet/ether_hton.c,
	inet/ether_line.c, inet/ether_ntoa.c, inet/ether_ntoa_r.c,
	inet/ether_ntoh.c: New files.  Implementation of functions to
	handle Ethernet address to host mapping.
	* inet/netinet/ether.h: New file.  Declare ether_* functions.
	* netinet/ether.h: Wrapper around inet/netinet/ether.h for glibc
	compilation.
	* nss/ethers-lookup.c: New file.  Lookup function for ethers database.
	* nss/Makefile (routines): Add ethers-lookup.
	(libnss_files-routines): Add files-ethers.

	* nss/getXXent_r.c: Don't define set*ent and end*ent function
	with _r suffix.

	* nss/nss_files/files-XXX.c (internal_endent): Don't reset
	KEEP_STREAM every time called.
	(_nss_files_end): Reset KEEP_STREAM here instead.
	(internal_getent): If STREAM == NULL try to open instead of
	signalling error.
	Use cast to prevent warning.
	Terminate read line in case the buffer is too small.

	* nss/nss_files/files-ethers.c: New file.  Implementation of
	Ethernet adress<->hostname lookup through files interface.

	* stdlib/mbstowcs.c: Define based on mbsrtowcs().
	* stdlib/mbtowc.c: Define based on mbrtowc().
	* stdlib/wcstombs.c: Define based on wcsrtombs().
	* stdlib/wctomb.c: Define based on wcrtomb().

	* sunrpc/xdr.c (xdr_u_int): Avoid bogus call to
	unexpected_sizes_in_xdr_u_int.

	* sysdeps/generic/netinet/if_ether.h: New file.  Generic declaration
	of `struct ether_addr'.
	* sysdeps/unix/sysv/linux/netinet/if_ether.h: New file.  Linux specific
	declaration of `struct ether_addr'.

	* wcsmbs/mbrtowc.c: Handle case where argument PS is NULL.
	* wcsmbs/mbsrtowcs.c: Ditto.
	* wcsmbs/wcrtomb.c: Ditto.
	* wcsmbs/wcsrtombs.c: Ditto.

	* wcsmbs/mbsinit.c: Prepare for PS being NULL.

Wed Jun 26 13:19:35 1996  Miles Bader  <miles@gnu.ai.mit.edu>

	* hurd/get-host.c <fcntl.h>: New include.
	* hurd/set-host.c <fcntl.h>: New include.
	(_hurd_set_host_config): Include NEW in args to dir_link.
	Return NWROTE, not NREAD.

	* sysdeps/mach/hurd/getcwd.c
	(_hurd_canonicalize_directory_name_internal): Don't deallocate
	DOTID & DOTDEVID until we're finished with them (we need to keep
	them at least until we've fetched the next level of id ports, so
	that mach will be able to use the same name if they're the same).
	Add inner_errlose: label, which deallocates DOTID & DOTDEVID and
	jumps to errlose, for those places where such cleanup is needed.

Wed Jun 26 01:58:49 1996  Roland McGrath  <roland@delasyd.gnu.ai.mit.edu>

	* nss/nss_files/files-parse.c (parse_list): Count null in EOL calc.

	Move DB code into separate -ldb library.
	* db/Makefile (extra-libs): New variable, list libdb.
	(routines): Renamed to libdb-routines.
	* shlib-versions: Add libdb=2.

	* nss/network-lookup.c (DEFAULT_CONFIG): New macro.
	* nss/host-lookup.c (DEFAULT_CONFIG): New macro.

	* nss/nsswitch.c (nss_parse_service_list): Use __strncasecmp instead
	of strncasecmp.  Extend syntax to grok [!foo=bar].

	* sysdeps/generic/strncase.c: Define __strncasecmp with strncasecmp as
	weak alias.
	* string/string.h: Declare __strncasecmp.

	* nss/nsswitch.c (nss_parse_file): Call __getline, not getline.
	(service_alias): Variable removed.
	(nss_parse_service_list): New function, broken out of nss_getline.
	Remove alias conversion; we will just use symlinks.
	(__nss_database_lookup): Take new string arg DEFCONFIG.
	If no entry exists, make one with service list parsed from that.
	* nss/nsswitch.h: Update protocol for __nss_database_lookup.
	* nss/XXX-lookup.c (DEFAULT_CONFIG): New macro, set to 0 if undefined.
	(DB_LOOKUP_FCT): Pass it to _nss_database_lookup.

	* grp/initgroups.c: Rewritten using getgrent.  Handle unlimited group
	list size.

	* sunrpc/xdr.c (xdr_int): #if 0 out unresolved references in dead code.

Wed Jun 26 01:56:50 1996  Ulrich Drepper  <drepper@cygnus.com>

	* locale/programs/locale.c (long_options): Short form of
	--version option is `-V'.
	(main): Recognize `-V' as option, not `-v'.
	Call `usage' instead of printing error message for illegal
	option.
	(usage): Document `-V'.

Tue Jun 25 17:22:55 1996  Miles Bader  <miles@gnu.ai.mit.edu>

	* sysdeps/mach/hurd/getcwd.c
	(_hurd_canonicalize_directory_name_internal): Initialize PARENT to
	THISDIR, and don't ever deallocate PARENT unless it's != THISDIR.

Tue Jun 25 10:58:23 1996  Roland McGrath  <roland@delasyd.gnu.ai.mit.edu>

	* inet/getrpcent.c: Fix macros.
	* inet/getrpcent_r.c: Fix macros.

	* elf/dlsym.c (dlsym): Search the global scope if HANDLE is null.

	* elf/dl-load.c (_dl_map_object_from_fd): Initialize L.

Tue Jun 25 09:55:47 1996  David Mosberger-Tang  <davidm@AZStarNet.com>

	* catgets/gencat.c (write_out): Use %Zu to print variables of type
 	size_t.
	* resolv/res_debug.c (__p_rr): Print size_t variable as %lu and
	cast it to (unsigned long) to make it work both on 32 and 64
	bit architectures.

Sat Jun 22 13:05:25 1996  Andreas Schwab  <schwab@issan.informatik.uni-dortmund.de>

	* locale/Makefile (distribute): Add `programs/' prefix to all
	files in that directory.

	* Makerules (distinfo-vars): Assign subdir directly so that `ifdef
	subdir' works.

	* MakeTAGS (sources, headers): Make them simply expanded variables
	so that all-dist is expanded before it is changed.

Tue Jun 25 02:59:11 1996  Roland McGrath  <roland@delasyd.gnu.ai.mit.edu>

	* Make-dist (dist): Don't depend on crypt tar file.  Remove that rule.
	* Makefile (subdirs): Remove crypt.
	* crypt: Directory removed.  It will be made an independent library
	distribution.

	* Makefile (distribute): Add rpm/{Makefile,teplate,rpmrc}.

	* inet/getrpcent_r.c (DATABASE_NAME): New macro.

	* inet/getrpcbynumber.c (BUFLEN): New macro.

	* configure.in (--no-whole-archive check): Remove backslashes in cmd.

	* Makefile (headers): Add libc-lock.h.
	* sysdeps/stub/libc-lock.h: New file.

	* inet/getrpcbynumber.c: Remove _r typo.

	* elf/dl-load.c (_dl_map_object): Fix typo in last change.

	* nss/nss_files/files-parse.c (parse_list): Reset ELT for elements
	after the first!

	* nss/nsswitch.c (__nss_database_lookup): If nsswitch.conf is missing
	or doesn't mention DATABASE, use an internal default equivalent to
	"DATABASE: compat [NOTFOUND=return] dns [NOTFOUND=return] files".
	(nss_lookup_function): Call nss_new_service as needed.
	(nss_parse_file): Don't bother calling nss_new_service here.

	* grp/fgetgrent.c (LINE_PARSER): Pass zero SWALLOW arg for fields.
	* pwd/fgetpwent.c: Likewise.

	* malloc/malloc.h: Declare malloc_object_allocated_size, malloc_walk.
	* malloc/Makefile (dist-routines): Add malloc-size, malloc-walk.
	* malloc/malloc-size.c: New file.
	* malloc/malloc-walk.c: New file.

	* malloc/malloc-find.c (malloc_find_object_address): Return null if
	PTR is outside the heap.

	* elf/dl-load.c (_dl_map_object): If the requested name matches the
 	soname of a loaded object, use that object.

Mon Jun 24 19:57:01 1996  Roland McGrath  <roland@delasyd.gnu.ai.mit.edu>

	* Makefile (subdirs): Add nss.

	* inet/Makefile (routines): Add getrpcent, getrpcbyname,
	getrpcbynumber, getrpcent_r, getrpcbyname_r, getrpcbynumber_r.
	* inet/getrpcbynumber_r.c: New file.
	* inet/getrpcbynumber.c: New file.
	* inet/getrpcbyname.c: New file.
	* inet/getrpcbyname_r.c: New file.
	* inet/getrpcent_r.c: New file.
	* inet/getrpcent.c: New file.
	* nss/rpc-lookup.c: New file.
	* nss/nss_files/files-rpc.c: New file.
	* nss/Makefile (routines): Add rpc-lookup.
	(libnss_files-routines): Add files-rpc.
	* sunrpc/Makefile (routines): Remove getrpcent.
	* sunrpc/getrpcent.c: File removed.

	* nss/getXXent_r.c (REENTRANT_GETNAME): Clear NO_MORE when NIP is
	non-null on entry.

	* Makeconfig (rpath-link): Add $(nssobjdir).
	(nssobjdir): New variable.

	* Makerules: Move shared library building before objects rules, so
	versions are known before extra-lib.mk gets included.
	* extra-lib.mk (lib-noranlib): Depend on the shared object too.

	* pwd/getpwuid.c: Rewritten using nss.
	* pwd/getpwnam.c: Likewise.
	* pwd/getpwent.c: Likewise.
	* grp/getgrnam.c: Likewise.
	* grp/getgrgid.c: Likewise.
	* grp/getgrent.c: Likewise.
	* pwd/Makefile (routines): Add getpwent_r, getpwnam_r, getpwuid_r.
	* pwd/getpwent_r.c: New file.
	* pwd/getpwnam_r.c: New file.
	* pwd/getpwuid_r.c: New file.
	* grp/Makefile (routines): Add getgrent_r, getgrgid_r, getgrnam_r.
	* grp/getgrnam_r.c: New file.
	* grp/getgrgid_r.c: New file.
	* grp/getgrent_r.c: New file.
	* grp/Makefile (routines): Remove grpopen, grpread.
	* pwd/Makefile (routines): Remove pwdopen, pwdread.
	* grp/grpopen.c, grp/grpread.c, pwd/pwdopen.c, pwd/pwdread.c: Removed.

	* pwd/fgetpwent.c: Rewritten using files-parse.c.
	* grp/fgetgrent.c: Likewise.

	* nss/Makefile (routines): Add grp-lookup and pwd-lookup.
	* nss/pwd-lookup.c, nss/grp-lookup.c: New files.
	* nss/nss_files/files-grp.c: New file.
	* nss/nss_files/files-pwd.c: New file.

	* nss/Makefile (subdir-dirs): New variable; use it in vpath.

	* nss/nss_files/files-parse.c: New file.
	* nss/nss_files/files-XXX.c: New file.
	* nss/nss_files/files-hosts.c, nss/nss_files/files-proto.c,
	nss/nss_files/files-service.c, nss/nss_files/files-network.c:
	Rewritten using them.

	* nss/Makefile (libnss_files-routines): Remove files-host.
	Add files-hosts, files-grp, files-pwd.

	* nss/nss_dns/dns-network.c: Don't include <pthread.h>.

Mon Jun 24 22:39:12 1996  Richard Henderson  <rth@tamu.edu>

	* sysdeps/alpha/dl-machine.h (ELF_MACHINE_RUNTIME_TRAMPOLINE):
	A .plt entry now loads the .rela.plt offset directly rather
	than making us calculate it.

Sun Jun 23 15:24:05 1996  Roland McGrath  <roland@delasyd.gnu.ai.mit.edu>

	* time/Makefile ($(installed-localtime-file) rule): Do
	$(make-target-directory) first.

	* resolv.h: Fix wrapper for resolv/resolv.h.

	* configure.in (ld --no-whole-archive check): Use AC_TRY_COMMAND.
	Compile dummy file and pass -nostdlib -nostartfiles so as not to
	require installed libraries.

	* shlib-versions (*-*-*): Set libresolv=2, libnss_files=1,
	libnss_dns=1.

Sun Jun 23 19:42:05 1996  Ulrich Drepper  <drepper@cygnus.com>

	* resolv/Makefile (distribute): Remove res_hconf.h; add mapv4v6addr.h
	and mapv4v6hostent.h.
	(routines): Move res* and gethnamaddr into libresolv-routines.
	(libresolv-routines): New variable, put them there.
	(extra-libs): New variable, list libresolv.
	(CPPFLAGS): Add -D for get*by* to res_get*by*.

	* resolv/netdb.h (_PATH_NSSWITCH_CONF): New macro.

	* inet/herrno.c: New file.

	* resolv/res_init.c: Remove res_hconf calls.

	* nss/Makefile, nss/XXX-lookup.c, nss/file-lookup.c,
	nss/getXXbyYY.c, nss/getXXbyYY_r.c, nss/getXXent.c,
	nss/getXXent_r.c, nss/host-lookup.c, nss/network-lookup.c,
	nss/nsswitch.c, nss/nsswitch.h, nss/proto-lookup.c,
	nss/service-lookup.c: New files.  Implementation of name
	service switch, following the approach in Solaris.
	Interface specification and general structure inspired by Peter
	Eriksson <pen@lysator.liu.se>.
	* nss/nss_files/files-host.c, nss/nss_files/files-network.c,
	nss/nss_files/files-proto.c, nss/nss_files/files-service.c:
	Implementation of libnss_files.so module for file based databases
	in NSS service.
	* nss/nss_dns/dns-host.c, nss/nss_dns/dns-network.c: Implementation
        if libnss_dns.so module for DNS name lookup in NSS service.

	* inet/getproto.c, inet/getprtent.c, inet/getprtname.c,
	inet/getservent.c, inet/getsrvbynm.c, inet/getsrvbypt.c:
	Changed to serve as interface to NSS.
	* inet/gethstbyad.c, inet/gethstbyad_r.c, inet/gethstbynm.c,
	inet/gethstbynm2.c, inet/gethstbynm2_r.c, inet/gethstbynm_r.c,
	inet/gethstent.c, inet/gethstent_r.c, inet/getnetbynm.c,
	inet/getnetbynm_r.c, inet/getnetbypt.c, inet/getnetbypt_r.c,
	inet/getnetent.c, inet/getnetent_r.c, inet/getproto_r.c,
	inet/getprtent_r.c, inet/getprtname_r.c, inet/getservent_r.c,
	inet/getsrvbynm_r.c, inet/getsrvbypt_r.c: New files.  Implement
	interfaces to NSS, including reentrant functions.

	* resolv/getnetbyaddr.c, resolv/getnetbyname.c, resolv/getnetent.c,
	resolv/sethostent.c: Removed:  Obsoleted by NSS.

	* resolv/mapv4v6addr.h, resolv/mapv4v6hostent.h: Extracted from
	gethnamaddr.c.  These private functions are now used in more
	than one file.

	* resolv/inet_pton.c, resolv/gethnamaddr.c: Updated to bind-4.9.4-T5B.

Sat Jun 22 16:49:47 1996  Andreas Schwab  <schwab@issan.informatik.uni-dortmund.de>

	* rpm/Makefile ($(config)): Make sure the word list in the for
	loop is syntactically non-empty.

Sat Jun 22 21:29:52 1996  Roland McGrath  <roland@delasyd.gnu.ai.mit.edu>

	* Version 1.92 test release.

Sat Jun 22 23:30:07 1996  David Mosberger-Tang  <davidm@azstarnet.com>

	* sysdeps/unix/sysv/linux/syscalls.list (ksyslog_ctl): Rename
	to klogctl to match prototype in sys/klog.h.

	* sysdeps/posix/libc_fatal.c: Add include of <string.h>.
	* sysdeps/unix/sysv/linux/gethostid.c: Ditto.

	* sysdeps/posix/getcwd.c (__canonicalize_directory_name_internal):
	Remove.  Code is now part of __getcwd again.  The old function
	never really worked for anything but THISDIR==".".

	* sysdeps/alpha/Makefile (CFLAGS-rtld.c): Add -mbuild-constants
	only when building ELF version of library.

	* libio/libioP.h (_IO_vscanf): Add prototype.

	* posix/unistd.h (syscall): Change sysno arg and return value
	to int long.

Sat Jun 22 10:44:09 1996  Roland McGrath  <roland@delasyd.gnu.ai.mit.edu>

	* version.h (VERSION): Updated to 1.92.

	* misc/Makefile (headers): Add ar.h.
	* misc/ar.h: New file.

	* config.make.in (BUILD_CC): New variable.
	* configure.in: Check for BUILD_CC if $host != $build.

	* posix/glob.c: Include <alloca.h> only [HAVE_ALLOCA_H], not [sparc].

	* Makerules [! objects] (subdir_lib): Depend on the stamp$o files.
	(stamp$o files): New targets, create them empty, no deps.

	* rpm/template (Source): New field.
	(%prep, %build, %install): New sections.
	(%files): Add %doc FAQ NEWS NOTES README.
	* rpm/rpmrc (builddir): Removed.

Fri Jun 21 00:27:51 1996  Roland McGrath  <roland@delasyd.gnu.ai.mit.edu>

	* elf/dl-load.c (_dl_map_object_from_fd): Fix mapping and l_phdr
 	guessing to not assume p_vaddr of first load cmd is zero.

	* sysdeps/sparc/elf/start.S: New file.
	* sysdeps/sparc/dl-machine.h: New file.

	* posix/fnmatch.c (fnmatch): Fix \*[*?]+ case to increment name ptr
 	only for ?s, not for *s.  Fix from Chet Ramey.

	Fixes thanks to Raja R Harinath <harinath@cs.umn.edu>:
	* sysdeps/unix/sysv/utmpbits.h: Define _HAVE_UT_{TYPE,ID,TV,HOST}.
	Use __{BEGIN,END}_DECLS.
	(_PATH_WTMP, _PATH_UTMP, _PATH_LASTLOG): New macros.
	* login/utmp.h (UTMP_FILE, UTMP_FILENAME, WTMP_FILE, WTMP_FILENAME):
	New macros, moved here from sysdeps/gnu/utmpbits.h.
	* sysdeps/generic/utmpbits.h (_HAVE_UT_HOST): Define it.
	* sysdeps/gnu/utmpbits.h (_HAVE_UT_HOST): Likewise.
	* login/logout.c: Use ut_host only #if _HAVE_UT_HOST.
	Use sizeof instead of UT_*SIZE.
	* login/logwtmp.c: Likewise.

	* misc/tsearch.c (tdelete): Define as weak alias to __tdelete.

	* version.c (banner): Add trailing newline.

	* login/utmp.h: Declare login_tty.

Thu Jun 20 21:19:07 1996  Richard Henderson  <rth@tamu.edu>

	* sysdeps/alpha/dl-machine.h (elf_alpha_fix_plt):
	Changed to a 12-byte PLT entry to remove dependency on $gp.
	Take a new got_addr parameter.
	(elf_machine_rela): Pass the new parameter.
	(ELF_MACHINE_RUNTIME_TRAMPOLINE): Do arithmetic for 12-byte PLT.
	(RTLD_START): Do normal linkage with program entry.

Thu Jun 20 12:18:21 1996  Miles Bader  <miles@gnu.ai.mit.edu>

	* sysdeps/mach/hurd/brk.c (_hurd_brk): Initialize to 0.

	* hurd/getuids.c (getuids): New weak link to __getuids.

Wed Jun 19 10:21:24 1996  Miles Bader  <miles@gnu.ai.mit.edu>

	* hurd/hurdlookup.c (__hurd_file_name_lookup_retry,
	__hurd_file_name_lookup, __hurd_file_name_split): Add & use LOOKUP
	argument.
	Rename nested function lookup to lookup_op.
	(__file_name_lookup, __file_name_lookup_under):
	Pass 0 for lookup arg to __hurd_file_name_lookup.
	(__file_name_split): Likewise for __hurd_file_name_split.
	* hurd/path-lookup.c (hurd_file_name_path_lookup): Add LOOKUP argument.
	Rename nested function lookup to scan_lookup.
	(file_name_path_lookup): Pass 0 for lookup arg to
	hurd_file_name_path_lookup.
	* hurd/hurd/lookup.h (__hurd_file_name_lookup, hurd_file_name_lookup,
	__hurd_file_name_lookup_retry, hurd_file_name_lookup_retry:
	__hurd_file_name_split, hurd_file_name_split, hurd_file_name_lookup):
	Add LOOKUP argument.
	* sysdeps/mach/hurd/access.c (__access): Pass 0 lookup arg to
	__hurd_file_name_lookup.

Mon Jun 17 19:09:49 1996  Andreas Schwab  <schwab@issan.informatik.uni-dortmund.de>

	* Make-dist (+sysdeps): Move wildcard inside loop to avoid consing
	up a huge list just to discard most of it.

	* configure.in (sysnames): Avoid fgrep by using the case shell
	builtin.

	* Makeconfig (config.status): Fix dependency on Implies files.

Wed Jun 19 01:27:57 1996  Roland McGrath  <roland@delasyd.gnu.ai.mit.edu>

	* math/Makefile (distribute): Add ieee-math.c.

Wed Jun 19 03:24:58 1996  Ulrich Drepper  <drepper@cygnus.com>

	* locale/codeset_name.c: New file.  Provide function for information
 	about currently used character set.
	* locale/Makefile (routines): Add codeset_name.
	* locale/langinfo.h (_NL_CTYPE_CODESET_NAME): Add new constant.
	* locale/localeinfo.h: Change magic number because of incompatible
	change.
	* locale/C-ctype.c: Add initializer for new field `codeset_name'.
	* locale/programs/ld-ctype.c: Implement handling of `codeset_name'.

	* locale/programs/locfile.c: Don't depend in pre-2.0 Linux specific
 	name `MAX_IOVEC'.  Instead use standard name `UIO_MAXIOV'.

	* locale/setlocale.c (setlocale): Initialize local variables to
	prevent warnings.

Thu Jun 13 17:25:11 1996  David Mosberger-Tang  <davidm@azstarnet.com>

	* sysdeps/generic/memcmp.c: Add prototype decls for internal fns.

	* locale/programs/locale.c: Include string.h.

	* sunrpc/xdr_stdio.c (xdrstdio_getlong), sunrpc/xdr_rec.c
 	(xdrrec_getlong), sunrpc/xdr_mem.c (xdrmem_getlong): Make sure
 	appropriate sign-extension is performed on machines with
 	sizeof(long) > 4.

	* sunrpc/xdr.c (xdr_int, xdr_u_int): If sizeof(long)==8 and
 	sizeof(int)<sizeof(long), we need to go through a temporary
 	variable.

	* locale/programs/ld-numeric.c: Include <alloca.h>

	* libio/stdio.h (__libc_fatal): Add prototype.

	* libio/cleanup.c: Use __P() to declare prototype when __STDC__ is
 	in efect.

	* libio/iopopen.c (read_or_write, parent_end, child_end): Declare
 	volatile to avoid "might get clobbered by longjmp" warning.

	* features.h (__KERNEL_STRICT_NAMES): Define __KERNEL_STRICT_NAMES
 	unless _LOOSE_KERNEL_NAMES is in effect (which, with high
 	probability is a sure loser).
	* sysdeps/unix/sysv/linux/gnu/types.h (__KERNEL_STRICT_NAMES): Remove.

	* sysdeps/unix/bsd/osf/alpha/start.S (errno): Removed.
	* sysdeps/unix/sysv/linux/alpha/start.S: Ditto.

	* misc/paths.h (_PATH_MAN): Change from /usr/share/man to /usr/man
	to be Linux FSSTND compliant.

Mon Jun 10 17:50:31 1996  David Mosberger-Tang  <davidm@azstarnet.com>

	* sysdeps/unix/sysv/linux/alpha/pipe.S: Use PSEUDO.

	* sysdeps/unix/sysv/linux/alpha/sysdep.S,
 	sysdeps/unix/sysv/linux/alpha/brk.S,
 	sysdeps/unix/sysv/linux/alpha/ieee_get_fp_control.S,
 	sysdeps/unix/sysv/linux/alpha/ieee_set_fp_control.S,
 	sysdeps/unix/sysv/linux/alpha/llseek.S,
 	sysdeps/unix/sysv/linux/alpha/sigsuspend.S,
 	sysdeps/unix/sysv/linux/alpha/syscall.S: Rename syscall_error to
 	__syscall_error to avoid intruding application name space.

	* sysdeps/unix/sysv/linux/alpha/sysdep.h: Rename __NR_get?id
	to SYS_get?id so that syscall stubs in sysdeps/unix define
	these syscalls in terms of getxpid/getxuid/getxgid.

	* sysdeps/unix/_exit.S, sysdeps/unix/getegid.S,
 	sysdeps/unix/geteuid.S, sysdeps/unix/getppid.S,
 	sysdeps/unix/execve.S, sysdeps/unix/fork.S,
 	sysdeps/unix/syscall.S: Terminate syscall with PSEUDO_END.

	* sysdeps/unix/make-syscalls.sh, sysdeps/unix/sysdep.h
 	(PSEUDO_END): Rename END() to PSEUDO_END().

	* sysdeps/unix/alpha/sysdep.h: Move error-handling code in PSEUDO
 	to PSEUDO_END to improve branch-prediction.  Include .frame
 	directive to make syscalls debugabble.
	(PSEUDO_END): New macro.

	* sysdeps/unix/alpha/sysdep.h, sysdeps/alpha/bb_init_func.S,
 	sysdeps/unix/sysv/linux/alpha/brk.S: Use ldiq instead of ldi since
 	latter is illegal under DEC Unix.

	* sysdeps/unix/alpha/sysdep.S: Renamed from
	sysdeps/unix/sysv/linux/alpha/sysdep.S.  This file works for OSF/1
 	as well.
	* sysdeps/unix/bsd/osf/alpha/sysdep.S: Remove (note that the
 	EWOULDBLOCK -> EAGAIN mapping was unnecessary since
 	EWOULDBLOCK==EAGAIN under DEC Unix and Linux/Alpha).

	* sysdeps/alpha/divrem.h: Use retaddr instead of ra as the return
 	address register in the .frame directive.

	* sysdeps/alpha/copysign.c: Remove.

	* sunrpc/rpc/types.h: Include <sys/param.h> and <netinet/in.h> to
 	avoid RPC definitions of INADDR_LOOPBACK and/or MAXHOSTNAMELEN.

	* errno.h: Move __END_DECLS to correct place to make file
 	compilable under c++.

	* dirent/dirent.h: Document _DIRENT_HAVE_D_OFF macro.  Define
	d_ino only if <direntry.h> hasn't defined d_fileno.

	* configure.in (HAVE_ASM_WEAKEXT_DIRECTIVE): Reverse order of
	arguments to weakext to make .weakext detection work on ECOFF systems.

	* FAQ: Add Linux/Alpha to list of supported platforms.  Mention
	that _validuser() has been replaced by __ivaliduser().

Thu Jun  6 21:39:38 1996  David Mosberger-Tang  <davidm@azstarnet.com>

	* sysdeps/unix/bsd/sun/sunos4/tcsetattr.c (tcsetattr): Declare cmd
 	as unsigned long, not as int (to avoid incorrect int->long
 	promotion).



See ChangeLog.5 for earlier changes.
